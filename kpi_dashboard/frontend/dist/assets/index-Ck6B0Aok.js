const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/webVitals-CCkPJBQ5.js","assets/vendor-C-HZcing.js","assets/utils-vendor-DrCDvq1f.js","assets/ui-vendor-CtEEaYRX.js","assets/icon-vendor-BXbr4vD6.js","assets/chart-vendor-CSmpywC9.js"])))=>i.map(i=>d[i]);
var sa=Object.defineProperty;var ta=(s,t,a)=>t in s?sa(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a;var Cs=(s,t,a)=>ta(s,typeof t!="symbol"?t+"":t,a);import{a1 as aa,M as e,r,a2 as ra,a3 as Q,R as na,a4 as la,a5 as ia,a6 as xt}from"./vendor-C-HZcing.js";import{S as gt,R as ca,C as oa,a as da,T as ma,P as ua,O as ha,b as xa,c as ga,I as fa,V as pa,d as ja,e as va,f as ba,g as ya,h as Na,i as wa,j as Sa,k as Ca,l as ka,m as Da,n as _a,o as Ea,L as Pa,p as $a,q as Aa,r as Ia,s as La,t as Ta,u as Oa,v as Ra,w as Ma,x as za,y as Fa,z as Ga,A as Ba,B as Va,D as Ua,E as Ka,F as Ha,G as qa,H as Wa,J as Ya,K as Ja,M as Za,N as Qa,Q as Xa,U as er}from"./ui-vendor-CtEEaYRX.js";import{f as sr,D as Rs}from"./utils-vendor-DrCDvq1f.js";import{C as Oe,D as We,T as gs,B as ft,S as ls,X as Le,a as Be,R as os,b as Xe,c as Fe,d as ys,e as ds,f as Ce,g as Ms,M as pt,h as jt,A as Us,i as tr,P as zs,j as Is,E as vt,k as cs,l as ar,m as rr,n as Ls,o as nr,F as lr,U as ir,p as cr,q as or,r as Qe,s as dr,t as js,u as Ks,v as Ts,w as mr,x as ur,y as hr,L as ms,z as Fs,G as xr,H as gr,I as fr,J as pr,K as Hs,N as jr}from"./icon-vendor-BXbr4vD6.js";import{R as Ie,L as Gs,a as Ge,B as vs,b as Te,A as bt,c as as,C as He,X as qe,Y as ze,T as Re,d as Me,e as vr,f as ks,g as br,h as yr,P as Nr,i as wr,j as Sr,k as qs,l as Cr,m as kr}from"./chart-vendor-CSmpywC9.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const g of i)if(g.type==="childList")for(const h of g.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function a(i){const g={};return i.integrity&&(g.integrity=i.integrity),i.referrerPolicy&&(g.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?g.credentials="include":i.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function n(i){if(i.ep)return;i.ep=!0;const g=a(i);fetch(i.href,g)}})();const Dr="modulepreload",_r=function(s){return"/"+s},Ws={},Se=function(t,a,n){let i=Promise.resolve();if(a&&a.length>0){let h=function(d){return Promise.all(d.map(f=>Promise.resolve(f).then(P=>({status:"fulfilled",value:P}),P=>({status:"rejected",reason:P}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),u=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=h(a.map(d=>{if(d=_r(d),d in Ws)return;Ws[d]=!0;const f=d.endsWith(".css"),P=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${P}`))return;const l=document.createElement("link");if(l.rel=f?"stylesheet":Dr,f||(l.as="script"),l.crossOrigin="",l.href=d,u&&l.setAttribute("nonce",u),document.head.appendChild(l),f)return new Promise((p,y)=>{l.addEventListener("load",p),l.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${d}`)))})}))}function g(h){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=h,window.dispatchEvent(o),!o.defaultPrevented)throw h}return i.then(h=>{for(const o of h||[])o.status==="rejected"&&g(o.reason);return t().catch(g)})};function te(...s){return aa(sr(s))}const Bs=Rs("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function J({className:s,variant:t,size:a,asChild:n=!1,...i}){const g=n?gt:"button";return e.jsx(g,{"data-slot":"button",className:te(Bs({variant:t,size:a,className:s})),...i})}r.lazy(()=>Se(()=>Promise.resolve().then(()=>Lt),void 0));r.lazy(()=>Se(()=>Promise.resolve().then(()=>Gt),void 0));r.lazy(()=>Se(()=>Promise.resolve().then(()=>Wt),void 0));r.lazy(()=>Se(()=>Promise.resolve().then(()=>Zt),void 0));r.lazy(()=>Se(()=>Promise.resolve().then(()=>Xt),void 0));r.lazy(()=>Se(()=>Promise.resolve().then(()=>Rt),void 0));r.lazy(()=>Se(()=>Promise.resolve().then(()=>Mt),void 0));r.lazy(()=>Se(()=>Promise.resolve().then(()=>cn),void 0));r.lazy(()=>Se(()=>Promise.resolve().then(()=>kn),void 0));const Os=()=>Se(()=>Promise.resolve().then(()=>Lt),void 0),yt=()=>Se(()=>Promise.resolve().then(()=>Gt),void 0),Nt=()=>Se(()=>Promise.resolve().then(()=>Wt),void 0),wt=()=>Se(()=>Promise.resolve().then(()=>Zt),void 0),Er=()=>Se(()=>Promise.resolve().then(()=>Xt),void 0),Pr=()=>Se(()=>Promise.resolve().then(()=>Rt),void 0),$r=()=>Se(()=>Promise.resolve().then(()=>Mt),void 0),Ar=()=>{if("connection"in navigator){const t=navigator.connection.effectiveType;console.log(`ğŸŒ ë„¤íŠ¸ì›Œí¬ ì†ë„: ${t}`),t==="4g"||t==="3g"?(console.log("ğŸš€ ë¹ ë¥¸ ë„¤íŠ¸ì›Œí¬ ê°ì§€ - ì»´í¬ë„ŒíŠ¸ í”„ë¦¬ë¡œë”© ì‹œì‘"),setTimeout(()=>{Os().catch(console.warn),yt().catch(console.warn)},1e3),setTimeout(()=>{Nt().catch(console.warn),wt().catch(console.warn)},2e3),setTimeout(()=>{Pr().catch(console.warn),$r().catch(console.warn)},3e3)):console.log("ğŸ“¶ ëŠë¦° ë„¤íŠ¸ì›Œí¬ - í•„ìš”ì‹œì—ë§Œ ë¡œë“œ")}else console.log("ğŸ“¶ ë„¤íŠ¸ì›Œí¬ ì •ë³´ ë¶ˆê°€ - ê¸°ë³¸ í”„ë¦¬ë¡œë”©"),setTimeout(()=>{Os().catch(console.warn)},2e3)},Ir=({children:s,activeMenu:t,setActiveMenu:a})=>{const n=[{id:"dashboard",label:"Dashboard",icon:Oe,preload:Os},{id:"results",label:"ë¶„ì„ ê²°ê³¼",icon:We,preload:wt},{id:"statistics",label:"Statistics",icon:gs,preload:yt},{id:"llm-analysis",label:"LLM ë¶„ì„",icon:ft,preload:Er},{id:"preference",label:"Preference",icon:ls,preload:Nt}];r.useEffect(()=>{Ar()},[]);const i=g=>{g.preload&&t!==g.id&&(console.log(`ğŸ¯ ë©”ë‰´ í˜¸ë²„ ê°ì§€ - ${g.label} í”„ë¦¬ë¡œë”© ì‹œì‘`),g.preload().catch(h=>{console.warn(`âš ï¸ ${g.label} í”„ë¦¬ë¡œë”© ì‹¤íŒ¨:`,h)}))};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"px-6 py-4",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"PVT  KPI Dashboard"})})}),e.jsxs("div",{className:"flex",children:[e.jsxs("aside",{className:"w-64 bg-white shadow-sm min-h-screen flex flex-col",children:[e.jsx("nav",{className:"p-4",children:e.jsx("div",{className:"space-y-2",children:n.map(g=>{const h=g.icon;return e.jsxs(J,{variant:t===g.id?"default":"ghost",className:"w-full justify-start",onClick:()=>a(g.id),onMouseEnter:()=>i(g),children:[e.jsx(h,{className:"mr-2 h-4 w-4"}),g.label]},g.id)})})}),e.jsx("div",{className:"mt-auto p-4 text-xs text-gray-400",children:"Powered by PVT AI Crew"})]}),e.jsx("main",{className:"flex-1 p-6",children:s})]})]})};function re({className:s,...t}){return e.jsx("div",{"data-slot":"card",className:te("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",s),...t})}function he({className:s,...t}){return e.jsx("div",{"data-slot":"card-header",className:te("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",s),...t})}function xe({className:s,...t}){return e.jsx("div",{"data-slot":"card-title",className:te("leading-none font-semibold",s),...t})}function Ns({className:s,...t}){return e.jsx("div",{"data-slot":"card-description",className:te("text-muted-foreground text-sm",s),...t})}function ne({className:s,...t}){return e.jsx("div",{"data-slot":"card-content",className:te("px-6",s),...t})}const Lr=Rs("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function Z({className:s,variant:t,asChild:a=!1,...n}){const i=a?gt:"span";return e.jsx(i,{"data-slot":"badge",className:te(Lr({variant:t}),s),...n})}function St({...s}){return e.jsx(ca,{"data-slot":"dialog",...s})}function Tr({...s}){return e.jsx(ua,{"data-slot":"dialog-portal",...s})}function Or({className:s,...t}){return e.jsx(ha,{"data-slot":"dialog-overlay",className:te("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...t})}function Ct({className:s,children:t,...a}){return e.jsxs(Tr,{"data-slot":"dialog-portal",children:[e.jsx(Or,{}),e.jsxs(oa,{"data-slot":"dialog-content",className:te("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...a,children:[t,e.jsxs(da,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[e.jsx(Le,{}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function kt({className:s,...t}){return e.jsx("div",{"data-slot":"dialog-header",className:te("flex flex-col gap-2 text-center sm:text-left",s),...t})}function Dt({className:s,...t}){return e.jsx(ma,{"data-slot":"dialog-title",className:te("text-lg leading-none font-semibold",s),...t})}const oe=(s,t,a=null)=>{const i=`[ApiClient:${new Date().toISOString()}]`;switch(s){case"info":console.log(`${i} ${t}`,a);break;case"error":console.error(`${i} ${t}`,a);break;case"warn":console.warn(`${i} ${t}`,a);break;case"debug":console.debug(`${i} ${t}`,a);break;default:console.log(`${i} ${t}`,a)}},Rr=()=>{try{const s=typeof window<"u"?window.__RUNTIME_CONFIG__||{}:{},t=s.BACKEND_BASE_URL||s.VITE_API_BASE_URL,a=t&&String(t).trim()||"http://localhost:8000";return oe("info","API ê¸°ë³¸ URL ì„¤ì •",{baseURL:a,runtimeCfg:Object.keys(s)}),a}catch(s){return oe("error","API ê¸°ë³¸ URL ì„¤ì • ì˜¤ë¥˜",s),"http://localhost:8000"}},es=s=>{var t,a;try{return(a=(t=s==null?void 0:s.response)==null?void 0:t.data)!=null&&a.detail?s.response.data.detail:s!=null&&s.message?s.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."}catch(n){return oe("error","ì—ëŸ¬ ë©”ì‹œì§€ ì¶”ì¶œ ì‹¤íŒ¨",n),"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."}},Mr=(s,t=["password","token","secret"])=>{if(!s||typeof s!="object")return s;const a={...s};return t.forEach(n=>{a[n]&&(a[n]="[HIDDEN]")}),a},_t=Rr(),ge=ra.create({baseURL:_t,timeout:15e3});oe("info","API í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™” ì™„ë£Œ",{baseURL:_t,timeout:15e3});ge.interceptors.request.use(s=>{var t;return oe("debug","API ìš”ì²­ ì‹œì‘",{method:(t=s.method)==null?void 0:t.toUpperCase(),url:s.url,baseURL:s.baseURL,hasData:!!s.data,hasParams:!!s.params}),s},s=>(oe("error","API ìš”ì²­ ì¸í„°ì…‰í„° ì˜¤ë¥˜",s),Promise.reject(s)));ge.interceptors.response.use(s=>{var t;return oe("debug","API ì‘ë‹µ ì„±ê³µ",{status:s.status,url:s.config.url,method:(t=s.config.method)==null?void 0:t.toUpperCase()}),s},s=>{var a,n,i,g;const t=es(s);return oe("error","API ì‘ë‹µ ì˜¤ë¥˜",{status:(a=s==null?void 0:s.response)==null?void 0:a.status,url:(n=s==null?void 0:s.config)==null?void 0:n.url,method:(g=(i=s==null?void 0:s.config)==null?void 0:i.method)==null?void 0:g.toUpperCase(),message:t}),Q.error(`ìš”ì²­ ì‹¤íŒ¨: ${t}`),Promise.reject(s)});const zr=async(s,t,a="default")=>{var n;oe("info","LLM ë¶„ì„ ìš”ì²­ ì‹œì‘",{dbConfig:Mr(s),analysisParams:t,userId:a});try{const i=await ge.post("/api/analysis/trigger-llm-analysis",{user_id:a,db_config:s,...t});return oe("info","LLM ë¶„ì„ íŠ¸ë¦¬ê±° ì„±ê³µ",{analysisId:(n=i.data)==null?void 0:n.analysis_id}),i.data}catch(i){throw oe("error","LLM ë¶„ì„ íŠ¸ë¦¬ê±° ì‹¤íŒ¨",i),i}},Fr=async s=>{oe("info","LLM ë¶„ì„ ê²°ê³¼ ì¡°íšŒ",{analysisId:s});try{const t=await ge.get(`/api/analysis/llm-analysis/${s}`);return oe("info","LLM ë¶„ì„ ê²°ê³¼ ì¡°íšŒ ì„±ê³µ",{analysisId:s,hasData:!!t.data}),t.data}catch(t){throw oe("error","LLM ë¶„ì„ ê²°ê³¼ ì¡°íšŒ ì‹¤íŒ¨",{analysisId:s,error:t}),t}},Ds=async(s="default")=>{var t;oe("info","ì‚¬ìš©ì ì„¤ì • ì¡°íšŒ",{userId:s});try{const a=await ge.get("/api/preference/settings",{params:{user_id:s}});return oe("info","ì‚¬ìš©ì ì„¤ì • ì¡°íšŒ ì„±ê³µ",{userId:s}),{success:!0,data:a.data}}catch(a){return((t=a==null?void 0:a.response)==null?void 0:t.status)===404?(oe("info","ì‚¬ìš©ì ì„¤ì •ì´ ì—†ìŒ (ì‹ ê·œ ì‚¬ìš©ì)",{userId:s}),{success:!0,data:null,isNew:!0}):(oe("error","ì‚¬ìš©ì ì„¤ì • ì¡°íšŒ ì‹¤íŒ¨",{userId:s,error:a}),{success:!1,error:es(a)})}},_s=async(s="default",t)=>{oe("info","ì‚¬ìš©ì ì„¤ì • ì €ì¥",{userId:s,hasData:!!t,dataKeys:t?Object.keys(t):[]});try{const a=await ge.put("/api/preference/settings",t,{params:{user_id:s}});return oe("info","ì‚¬ìš©ì ì„¤ì • ì €ì¥ ì„±ê³µ",{userId:s}),{success:!0,data:a.data}}catch(a){return oe("error","ì‚¬ìš©ì ì„¤ì • ì €ì¥ ì‹¤íŒ¨",{userId:s,error:a}),{success:!1,error:es(a)}}},Ys=async s=>{const t=s.user_id||s.userId;oe("info","ì‚¬ìš©ì ì„¤ì • ìƒì„±",{userId:t});try{const a=await ge.post("/api/preference/settings",s);return oe("info","ì‚¬ìš©ì ì„¤ì • ìƒì„± ì„±ê³µ",{userId:t}),{success:!0,data:a.data}}catch(a){return oe("error","ì‚¬ìš©ì ì„¤ì • ìƒì„± ì‹¤íŒ¨",{userId:t,error:a}),{success:!1,error:es(a)}}},Gr=async(s="default")=>{oe("info","ì‚¬ìš©ì ì„¤ì • ì‚­ì œ",{userId:s});try{return await ge.delete("/api/preference/settings",{params:{user_id:s}}),oe("info","ì‚¬ìš©ì ì„¤ì • ì‚­ì œ ì„±ê³µ",{userId:s}),{success:!0}}catch(t){return oe("error","ì‚¬ìš©ì ì„¤ì • ì‚­ì œ ì‹¤íŒ¨",{userId:s,error:t}),{success:!1,error:es(t)}}},Br=async(s="default")=>{oe("info","ì‚¬ìš©ì ì„¤ì • ë‚´ë³´ë‚´ê¸°",{userId:s});try{const t=await ge.get("/api/preference/export",{params:{user_id:s}});return oe("info","ì‚¬ìš©ì ì„¤ì • ë‚´ë³´ë‚´ê¸° ì„±ê³µ",{userId:s}),{success:!0,data:t.data}}catch(t){return oe("error","ì‚¬ìš©ì ì„¤ì • ë‚´ë³´ë‚´ê¸° ì‹¤íŒ¨",{userId:s,error:t}),{success:!1,error:es(t)}}},Vr=async(s="default",t,a=!1)=>{oe("info","ì‚¬ìš©ì ì„¤ì • ê°€ì ¸ì˜¤ê¸°",{userId:s,fileName:t==null?void 0:t.name,fileSize:t==null?void 0:t.size,overwrite:a});try{const n=new FormData;n.append("file",t);const i=await ge.post("/api/preference/import",n,{params:{user_id:s,overwrite:a},headers:{"Content-Type":"multipart/form-data"}});return oe("info","ì‚¬ìš©ì ì„¤ì • ê°€ì ¸ì˜¤ê¸° ì„±ê³µ",{userId:s}),{success:!0,data:i.data}}catch(n){return oe("error","ì‚¬ìš©ì ì„¤ì • ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨",{userId:s,error:n}),{success:!1,error:es(n)}}},N=(s,t,a=null)=>{const i=`[PreferenceUtils] ${new Date().toISOString()}`;switch(s){case"info":console.log(`${i} â„¹ï¸ ${t}`,a);break;case"warn":console.warn(`${i} âš ï¸ ${t}`,a);break;case"error":console.error(`${i} âŒ ${t}`,a);break;default:console.log(`${i} ${t}`,a)}},Ur=()=>{try{if(N("info","ëŸ°íƒ€ì„ ì„¤ì • ì ‘ê·¼ ì‹œë„"),typeof window<"u"&&window.__RUNTIME_CONFIG__){const s=window.__RUNTIME_CONFIG__;return N("info","ëŸ°íƒ€ì„ ì„¤ì • ë¡œë“œ ì„±ê³µ",s),s}return N("warn","ëŸ°íƒ€ì„ ì„¤ì •ì´ ì—†ìŒ - ê¸°ë³¸ê°’ ì‚¬ìš©"),{}}catch(s){return N("error","ëŸ°íƒ€ì„ ì„¤ì • ì ‘ê·¼ ì‹¤íŒ¨",s.message),{}}},Et=()=>{N("info","ê¸°ë³¸ ì„¤ì •ê°’ ìƒì„± ì‹œì‘");const s=Ur(),t={dashboardSettings:{selectedPegs:[],defaultNe:"",defaultCellId:"",autoRefreshInterval:30,chartStyle:"line",showLegend:!0,showGrid:!0,theme:"light",defaultTimeRange:30,timeUnit:"minutes",time1Start:null,time1End:null,time2Start:null,time2End:null,enableTimeComparison:!1},statisticsSettings:{defaultDateRange:7,comparisonEnabled:!0,showDelta:!0,showRsd:!0,defaultPegs:["availability","rrc"],chartType:"bar",decimalPlaces:2,autoAnalysis:!1},databaseSettings:{host:s.DB_HOST||"postgres",port:parseInt(s.DB_PORT,10)||5432,user:s.DB_USER||"postgres",password:s.DB_PASSWORD||"postgres",dbname:s.DB_NAME||"netperf",table:"summary"},notificationSettings:{enableToasts:!0,enableSounds:!1,saveNotification:!0,errorNotification:!0},generalSettings:{language:"ko",timezone:"Asia/Seoul",dateFormat:"YYYY-MM-DD",numberFormat:"comma"},pegConfigurations:[],statisticsConfigurations:[]};return N("info","ê¸°ë³¸ ì„¤ì •ê°’ ìƒì„± ì™„ë£Œ",{sections:Object.keys(t),runtimeConfigKeys:Object.keys(s)}),t},Es={dashboardSettings:{selectedPegs:{required:!1,type:"array",message:"selectedPegsëŠ” ë°°ì—´ì´ì–´ì•¼ í•©ë‹ˆë‹¤."},autoRefreshInterval:{required:!1,type:"number",min:5,max:300,message:"ìë™ ìƒˆë¡œê³ ì¹¨ ê°„ê²©ì€ 5ì´ˆ~300ì´ˆ ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤."},defaultNe:{type:"string",maxLength:50,message:"NE IDëŠ” 50ìë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."},defaultCellId:{type:"string",maxLength:50,message:"Cell IDëŠ” 50ìë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."}},statisticsSettings:{defaultDateRange:{required:!1,type:"number",min:1,max:365,message:"ê¸°ë³¸ ë‚ ì§œ ë²”ìœ„ëŠ” 1ì¼~365ì¼ ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤."},decimalPlaces:{required:!1,type:"number",min:0,max:6,message:"ì†Œìˆ˜ì  ìë¦¿ìˆ˜ëŠ” 0~6ìë¦¬ ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤."},defaultPegs:{required:!1,type:"array",message:"defaultPegsëŠ” ë°°ì—´ì´ì–´ì•¼ í•©ë‹ˆë‹¤."}}},Kr=(s,t=null)=>{N("info","ì„¤ì • ìœ íš¨ì„± ê²€ì¦ ì‹œì‘",{section:t,hasSettings:!!s});const a={};if(!s||typeof s!="object")return N("error","ì„¤ì • ê°ì²´ê°€ ìœ íš¨í•˜ì§€ ì•ŠìŒ"),{general:"ì„¤ì • ê°ì²´ê°€ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."};if(t&&!Es[t])return N("warn","ì§€ì •ëœ ì„¹ì…˜ì— ëŒ€í•œ ê²€ì¦ ê·œì¹™ì´ ì—†ìŒ",t),a;const n=t?{[t]:Es[t]}:Es;Object.entries(n).forEach(([g,h])=>{if(!s[g]){N("info","ì„¹ì…˜ì´ ì—†ìŒ - ê²€ì¦ ìŠ¤í‚µ",g);return}Object.entries(h).forEach(([o,u])=>{const d=s[g][o],f=`${g}.${o}`;if(u.required&&(d==null||d==="")){a[f]=u.message||`${o}ëŠ” í•„ìˆ˜ í•­ëª©ì…ë‹ˆë‹¤.`,N("warn","í•„ìˆ˜ í•„ë“œ ëˆ„ë½",{fieldPath:f,value:d});return}if(d==null||d===""){N("info","í•„ë“œ ê°’ì´ ì—†ìŒ - ê²€ì¦ ìŠ¤í‚µ",f);return}if(u.type==="array"&&!Array.isArray(d)){a[f]=u.message||`${o}ëŠ” ë°°ì—´ì´ì–´ì•¼ í•©ë‹ˆë‹¤.`,N("warn","íƒ€ì… ê²€ì¦ ì‹¤íŒ¨ - ë°°ì—´ì´ ì•„ë‹˜",{fieldPath:f,value:d,expectedType:"array"});return}if(u.type==="number"&&typeof d!="number"){a[f]=u.message||`${o}ëŠ” ìˆ«ìì—¬ì•¼ í•©ë‹ˆë‹¤.`,N("warn","íƒ€ì… ê²€ì¦ ì‹¤íŒ¨ - ìˆ«ìê°€ ì•„ë‹˜",{fieldPath:f,value:d,expectedType:"number"});return}if(u.type==="string"&&typeof d!="string"){a[f]=u.message||`${o}ëŠ” ë¬¸ìì—´ì´ì–´ì•¼ í•©ë‹ˆë‹¤.`,N("warn","íƒ€ì… ê²€ì¦ ì‹¤íŒ¨ - ë¬¸ìì—´ì´ ì•„ë‹˜",{fieldPath:f,value:d,expectedType:"string"});return}if(u.type==="number"){if(u.min!==void 0&&d<u.min){a[f]=u.message||`${o}ëŠ” ${u.min} ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.`,N("warn","ìˆ«ì ë²”ìœ„ ê²€ì¦ ì‹¤íŒ¨ - ìµœì†Œê°’ ë¯¸ë‹¬",{fieldPath:f,value:d,min:u.min});return}if(u.max!==void 0&&d>u.max){a[f]=u.message||`${o}ëŠ” ${u.max} ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.`,N("warn","ìˆ«ì ë²”ìœ„ ê²€ì¦ ì‹¤íŒ¨ - ìµœëŒ€ê°’ ì´ˆê³¼",{fieldPath:f,value:d,max:u.max});return}}if(u.type==="array"){if(u.minLength!==void 0&&d.length<u.minLength){a[f]=u.message||`${o}ëŠ” ìµœì†Œ ${u.minLength}ê°œ í•­ëª©ì´ í•„ìš”í•©ë‹ˆë‹¤.`,N("warn","ë°°ì—´ ê¸¸ì´ ê²€ì¦ ì‹¤íŒ¨ - ìµœì†Œ ê¸¸ì´ ë¯¸ë‹¬",{fieldPath:f,length:d.length,minLength:u.minLength});return}if(u.maxLength!==void 0&&d.length>u.maxLength){a[f]=u.message||`${o}ëŠ” ìµœëŒ€ ${u.maxLength}ê°œ í•­ëª©ë§Œ í—ˆìš©ë©ë‹ˆë‹¤.`,N("warn","ë°°ì—´ ê¸¸ì´ ê²€ì¦ ì‹¤íŒ¨ - ìµœëŒ€ ê¸¸ì´ ì´ˆê³¼",{fieldPath:f,length:d.length,maxLength:u.maxLength});return}}if(u.type==="string"){if(u.minLength!==void 0&&d.length<u.minLength){a[f]=u.message||`${o}ëŠ” ìµœì†Œ ${u.minLength}ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.`,N("warn","ë¬¸ìì—´ ê¸¸ì´ ê²€ì¦ ì‹¤íŒ¨ - ìµœì†Œ ê¸¸ì´ ë¯¸ë‹¬",{fieldPath:f,length:d.length,minLength:u.minLength});return}if(u.maxLength!==void 0&&d.length>u.maxLength){a[f]=u.message||`${o}ëŠ” ìµœëŒ€ ${u.maxLength}ìê¹Œì§€ í—ˆìš©ë©ë‹ˆë‹¤.`,N("warn","ë¬¸ìì—´ ê¸¸ì´ ê²€ì¦ ì‹¤íŒ¨ - ìµœëŒ€ ê¸¸ì´ ì´ˆê³¼",{fieldPath:f,length:d.length,maxLength:u.maxLength});return}}})});const i=Object.keys(a).length;return N("info","ì„¤ì • ìœ íš¨ì„± ê²€ì¦ ì™„ë£Œ",{errorCount:i,hasErrors:i>0,errorFields:Object.keys(a)}),a},Js=(s,t)=>{if(N("info","ì„¤ì • ë³‘í•© ì‹œì‘",{hasSavedSettings:!!s,hasDefaultSettings:!!t}),!s)return N("info","ì €ì¥ëœ ì„¤ì •ì´ ì—†ìŒ - ê¸°ë³¸ê°’ ë°˜í™˜"),t;try{const a={...t};return Object.keys(t).forEach(n=>{s[n]&&typeof s[n]=="object"?(a[n]={...t[n],...s[n]},N("info","ì„¹ì…˜ ë³‘í•© ì™„ë£Œ",{section:n,mergedKeys:Object.keys(a[n])})):N("info","ì„¹ì…˜ì´ ì—†ê±°ë‚˜ ê°ì²´ê°€ ì•„ë‹˜ - ê¸°ë³¸ê°’ ì‚¬ìš©",{section:n})}),N("info","ì„¤ì • ë³‘í•© ì™„ë£Œ",{mergedSections:Object.keys(a),totalSections:Object.keys(t).length}),a}catch(a){return N("error","ì„¤ì • ë³‘í•© ì‹¤íŒ¨",a.message),t}},us="kpi-dashboard-preferences",hs=()=>{try{const s="__localStorage_test__";return localStorage.setItem(s,s),localStorage.removeItem(s),!0}catch(s){return N("warn","localStorage ì‚¬ìš© ë¶ˆê°€",s.message),!1}},Hr=s=>{if(N("info","localStorage ì €ì¥ ì‹œì‘",{hasSettings:!!s}),!hs()){const t="localStorageë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤";throw N("error","localStorage ì €ì¥ ì‹¤íŒ¨",t),new Error(t)}try{const t={settings:s,lastSaved:new Date().toISOString(),version:1};return localStorage.setItem(us,JSON.stringify(t)),N("info","localStorage ì €ì¥ ì™„ë£Œ",{lastSaved:t.lastSaved,settingsKeys:Object.keys(s)}),{success:!0,lastSaved:t.lastSaved}}catch(t){throw N("error","localStorage ì €ì¥ ì‹¤íŒ¨",t.message),new Error(`ì„¤ì • ì €ì¥ ì‹¤íŒ¨: ${t.message}`)}},qr=()=>{if(N("info","localStorage ë¡œë“œ ì‹œì‘"),!hs())return N("warn","localStorage ì‚¬ìš© ë¶ˆê°€ - null ë°˜í™˜"),null;try{const s=localStorage.getItem(us);if(!s)return N("info","localStorageì— ì €ì¥ëœ ì„¤ì • ì—†ìŒ"),null;const t=JSON.parse(s);return N("info","localStorage ë¡œë“œ ì™„ë£Œ",{lastSaved:t.lastSaved,version:t.version,settingsKeys:Object.keys(t.settings||{})}),t.settings}catch(s){N("error","localStorage ë¡œë“œ ì‹¤íŒ¨",s.message);try{localStorage.removeItem(us),N("info","ì†ìƒëœ ë°ì´í„° ì œê±° ì™„ë£Œ")}catch(t){N("error","ì†ìƒëœ ë°ì´í„° ì œê±° ì‹¤íŒ¨",t.message)}throw new Error(`ì„¤ì • ë¡œë“œ ì‹¤íŒ¨: ${s.message}`)}},Wr=()=>{if(N("info","localStorage ì‚­ì œ ì‹œì‘"),!hs()){const s="localStorageë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤";return N("error","localStorage ì‚­ì œ ì‹¤íŒ¨",s),{success:!1,error:s}}try{return localStorage.removeItem(us),N("info","localStorage ì‚­ì œ ì™„ë£Œ"),{success:!0}}catch(s){return N("error","localStorage ì‚­ì œ ì‹¤íŒ¨",s.message),{success:!1,error:s.message}}},Yr=()=>{const[s,t]=r.useState(!1),[a,n]=r.useState(null),[i,g]=r.useState(null);r.useEffect(()=>{N("info","localStorage ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸ ì‹œì‘");const l=hs();t(l),N("info","localStorage ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸ ì™„ë£Œ",{available:l})},[]);const h=r.useCallback(async l=>{N("info","ì„¤ì • ì €ì¥ ì‹œì‘",{hasSettings:!!l}),g(null);try{const p=Hr(l);return n(p.lastSaved),N("info","ì„¤ì • ì €ì¥ ì™„ë£Œ",p),{success:!0,lastSaved:p.lastSaved}}catch(p){const y=p.message;return g(y),N("error","ì„¤ì • ì €ì¥ ì‹¤íŒ¨",y),{success:!1,error:y}}},[]),o=r.useCallback(async()=>{N("info","ì„¤ì • ë¡œë“œ ì‹œì‘"),g(null);try{const l=qr();return N("info","ì„¤ì • ë¡œë“œ ì™„ë£Œ",{hasSettings:!!l}),{success:!0,settings:l}}catch(l){const p=l.message;return g(p),N("error","ì„¤ì • ë¡œë“œ ì‹¤íŒ¨",p),{success:!1,error:p,settings:null}}},[]),u=r.useCallback(async()=>{N("info","ì„¤ì • ì‚­ì œ ì‹œì‘"),g(null);try{const l=Wr();return l.success?(n(null),N("info","ì„¤ì • ì‚­ì œ ì™„ë£Œ")):(g(l.error),N("error","ì„¤ì • ì‚­ì œ ì‹¤íŒ¨",l.error)),l}catch(l){const p=l.message;return g(p),N("error","ì„¤ì • ì‚­ì œ ì‹¤íŒ¨",p),{success:!1,error:p}}},[]),d=r.useCallback(async(l,p=null)=>{N("info","ì„¤ì • ë°±ì—… ì‹œì‘",{hasSettings:!!l}),g(null);try{const y={settings:l,metadata:{exportedAt:new Date().toISOString(),version:"1.0.0",type:"backup"}},v=JSON.stringify(y,null,2),k=new Blob([v],{type:"application/json"}),_=document.createElement("a");return _.href=URL.createObjectURL(k),_.download=p||`preference-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(_.href),N("info","ì„¤ì • ë°±ì—… ì™„ë£Œ",{filename:_.download}),{success:!0,filename:_.download}}catch(y){const v=y.message;return g(v),N("error","ì„¤ì • ë°±ì—… ì‹¤íŒ¨",v),{success:!1,error:v}}},[]),f=r.useCallback(async l=>(N("info","ì„¤ì • ë³µì› ì‹œì‘",{fileName:l==null?void 0:l.name}),g(null),new Promise((p,y)=>{const v=new FileReader;v.onload=k=>{try{const _=JSON.parse(k.target.result);if(!_.settings)throw new Error("ìœ íš¨í•˜ì§€ ì•Šì€ ë°±ì—… íŒŒì¼ì…ë‹ˆë‹¤.");N("info","ì„¤ì • ë³µì› ì™„ë£Œ",{fileName:l.name,settingsKeys:Object.keys(_.settings)}),p({success:!0,settings:_.settings,metadata:_.metadata})}catch(_){const c=_.message;g(c),N("error","ì„¤ì • ë³µì› ì‹¤íŒ¨",c),y(_)}},v.onerror=()=>{const k=new Error("íŒŒì¼ ì½ê¸° ì‹¤íŒ¨");g(k.message),N("error","ì„¤ì • ë³µì› ì‹¤íŒ¨",k.message),y(k)},v.readAsText(l)})),[]),P=r.useCallback(()=>{if(N("info","ë™ê¸°í™” ìƒíƒœ í™•ì¸ ì‹œì‘"),!s)return N("warn","localStorage ì‚¬ìš© ë¶ˆê°€ - ë™ê¸°í™” ë¶ˆê°€"),{synced:!1,reason:"localStorage_unavailable"};try{const l=localStorage.getItem(us);if(!l)return N("info","ì €ì¥ëœ ì„¤ì • ì—†ìŒ - ë™ê¸°í™” ë¶ˆí•„ìš”"),{synced:!0,reason:"no_data"};const p=JSON.parse(l),y=!!p.settings;return N("info","ë™ê¸°í™” ìƒíƒœ í™•ì¸ ì™„ë£Œ",{synced:y,lastSaved:p.lastSaved,hasData:y}),{synced:y,lastSaved:p.lastSaved,reason:y?"synced":"no_data"}}catch(l){return N("error","ë™ê¸°í™” ìƒíƒœ í™•ì¸ ì‹¤íŒ¨",l.message),{synced:!1,reason:"error",error:l.message}}},[s]);return{isAvailable:s,lastSaved:a,error:i,saveSettings:h,loadSettings:o,clearSettings:u,backupSettings:d,restoreSettings:f,checkSyncStatus:P,isLocalStorageAvailable:hs}},Jr=()=>{const[s,t]=r.useState(!1),[a,n]=r.useState(null),[i,g]=r.useState(null),h=r.useCallback(async c=>{var D,A;N("info","API ì‘ì—… ì‹œì‘"),t(!0),n(null);try{const j=await c();return g(new Date),N("info","API ì‘ì—… ì™„ë£Œ",{success:!0}),j}catch(j){const $=((A=(D=j==null?void 0:j.response)==null?void 0:D.data)==null?void 0:A.detail)||(j==null?void 0:j.message)||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";throw n($),N("error","API ì‘ì—… ì‹¤íŒ¨",$),j}finally{t(!1)}},[]),o=r.useCallback(async(c="default")=>(N("info","ì‚¬ìš©ì ì„¤ì • ì¡°íšŒ ì‹œì‘",{userId:c}),await h(async()=>{const D=await Ds(c);if(D.success)return N("info","ì‚¬ìš©ì ì„¤ì • ì¡°íšŒ ì„±ê³µ",{hasData:!!D.data,isNew:D.isNew}),D;throw new Error(D.error||"ì„¤ì • ì¡°íšŒ ì‹¤íŒ¨")})),[h]),u=r.useCallback(async(c="default",D)=>(N("info","ì‚¬ìš©ì ì„¤ì • ì €ì¥ ì‹œì‘",{userId:c,hasData:!!D,dataKeys:D?Object.keys(D):[]}),await h(async()=>{const A=await _s(c,D);if(A.success)return N("info","ì‚¬ìš©ì ì„¤ì • ì €ì¥ ì„±ê³µ"),Q.success("ì„¤ì •ì´ ì„œë²„ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤"),A;throw new Error(A.error||"ì„¤ì • ì €ì¥ ì‹¤íŒ¨")})),[h]),d=r.useCallback(async c=>(N("info","ì‚¬ìš©ì ì„¤ì • ìƒì„± ì‹œì‘",{userId:c.user_id||c.userId,hasData:!!c}),await h(async()=>{const D=await Ys(c);if(D.success)return N("info","ì‚¬ìš©ì ì„¤ì • ìƒì„± ì„±ê³µ"),Q.success("ìƒˆë¡œìš´ ì„¤ì •ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤"),D;throw new Error(D.error||"ì„¤ì • ìƒì„± ì‹¤íŒ¨")})),[h]),f=r.useCallback(async(c="default")=>(N("info","ì‚¬ìš©ì ì„¤ì • ì‚­ì œ ì‹œì‘",{userId:c}),await h(async()=>{const D=await Gr(c);if(D.success)return N("info","ì‚¬ìš©ì ì„¤ì • ì‚­ì œ ì„±ê³µ"),Q.success("ì„¤ì •ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤"),D;throw new Error(D.error||"ì„¤ì • ì‚­ì œ ì‹¤íŒ¨")})),[h]),P=r.useCallback(async(c="default")=>(N("info","ì„¤ì • ë‚´ë³´ë‚´ê¸° ì‹œì‘",{userId:c}),await h(async()=>{const D=await Br(c);if(D.success){N("info","ì„¤ì • ë‚´ë³´ë‚´ê¸° ì„±ê³µ");const A=JSON.stringify(D.data,null,2),j=new Blob([A],{type:"application/json"}),$=document.createElement("a");return $.href=URL.createObjectURL(j),$.download=`preference-export-${c}-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild($),$.click(),document.body.removeChild($),URL.revokeObjectURL($.href),Q.success("ì„¤ì •ì´ íŒŒì¼ë¡œ ë‚´ë³´ë‚´ì¡ŒìŠµë‹ˆë‹¤"),{...D,filename:$.download}}else throw new Error(D.error||"ì„¤ì • ë‚´ë³´ë‚´ê¸° ì‹¤íŒ¨")})),[h]),l=r.useCallback(async(c="default",D,A=!1)=>(N("info","ì„¤ì • ê°€ì ¸ì˜¤ê¸° ì‹œì‘",{userId:c,fileName:D==null?void 0:D.name,overwrite:A}),await h(async()=>{const j=await Vr(c,D,A);if(j.success)return N("info","ì„¤ì • ê°€ì ¸ì˜¤ê¸° ì„±ê³µ"),Q.success("ì„¤ì •ì´ ì„±ê³µì ìœ¼ë¡œ ê°€ì ¸ì™€ì¡ŒìŠµë‹ˆë‹¤"),j;throw new Error(j.error||"ì„¤ì • ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨")})),[h]),p=r.useCallback(async(c="default",D)=>(N("info","ì„œë²„ ë™ê¸°í™” ì‹œì‘",{userId:c,hasLocalSettings:!!D}),await h(async()=>{try{const A=await Ds(c);if(A.success&&A.data){const j=await _s(c,D);if(j.success)return N("info","ì„œë²„ ë™ê¸°í™” ì™„ë£Œ - ì—…ë°ì´íŠ¸"),Q.success("ì„¤ì •ì´ ì„œë²„ì™€ ë™ê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤"),{success:!0,action:"updated"};throw new Error(j.error||"ì„¤ì • ì—…ë°ì´íŠ¸ ì‹¤íŒ¨")}else{const j={user_id:c,...D},$=await Ys(j);if($.success)return N("info","ì„œë²„ ë™ê¸°í™” ì™„ë£Œ - ìƒì„±"),Q.success("ìƒˆë¡œìš´ ì„¤ì •ì´ ì„œë²„ì— ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤"),{success:!0,action:"created"};throw new Error($.error||"ì„¤ì • ìƒì„± ì‹¤íŒ¨")}}catch(A){throw N("error","ì„œë²„ ë™ê¸°í™” ì‹¤íŒ¨",A.message),A}})),[h]),y=r.useCallback(async(c="default")=>(N("info","ì„œë²„ì—ì„œ ë™ê¸°í™” ì‹œì‘",{userId:c}),await h(async()=>{const D=await Ds(c);if(D.success)return N("info","ì„œë²„ì—ì„œ ë™ê¸°í™” ì™„ë£Œ",{hasData:!!D.data,isNew:D.isNew}),D.data?Q.success("ì„œë²„ì—ì„œ ì„¤ì •ì„ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤"):Q.info("ì„œë²„ì— ì €ì¥ëœ ì„¤ì •ì´ ì—†ìŠµë‹ˆë‹¤"),D;throw new Error(D.error||"ì„œë²„ ë™ê¸°í™” ì‹¤íŒ¨")})),[h]),v=r.useCallback(async(c="default",D,A,j="local")=>(N("info","ì„¤ì • ì¶©ëŒ í•´ê²° ì‹œì‘",{userId:c,strategy:j,hasLocalSettings:!!D,hasServerSettings:!!A}),await h(async()=>{let $=null;switch(j){case"local":$=D,N("info","ë¡œì»¬ ì„¤ì •ìœ¼ë¡œ ì¶©ëŒ í•´ê²°");break;case"server":$=A,N("info","ì„œë²„ ì„¤ì •ìœ¼ë¡œ ì¶©ëŒ í•´ê²°");break;case"merge":$={...D,...A},N("info","ì„¤ì • ë³‘í•©ìœ¼ë¡œ ì¶©ëŒ í•´ê²°");break;default:throw new Error("ì•Œ ìˆ˜ ì—†ëŠ” ì¶©ëŒ í•´ê²° ì „ëµì…ë‹ˆë‹¤")}const G=await _s(c,$);if(G.success)return N("info","ì¶©ëŒ í•´ê²° ì™„ë£Œ"),Q.success("ì„¤ì • ì¶©ëŒì´ í•´ê²°ë˜ì—ˆìŠµë‹ˆë‹¤"),{success:!0,resolvedSettings:$,strategy:j};throw new Error(G.error||"ì¶©ëŒ í•´ê²° ì‹¤íŒ¨")})),[h]),k=r.useCallback(async()=>{N("info","ë„¤íŠ¸ì›Œí¬ ìƒíƒœ í™•ì¸ ì‹œì‘");try{const c=await ge.get("/api/health",{timeout:5e3}),D=c.status===200;return N("info","ë„¤íŠ¸ì›Œí¬ ìƒíƒœ í™•ì¸ ì™„ë£Œ",{isOnline:D}),{isOnline:D,status:c.status}}catch(c){return N("warn","ë„¤íŠ¸ì›Œí¬ ìƒíƒœ í™•ì¸ ì‹¤íŒ¨",c.message),{isOnline:!1,error:c.message}}},[]),_=r.useCallback(()=>{N("info","ì—ëŸ¬ ìƒíƒœ ì´ˆê¸°í™”"),n(null)},[]);return{loading:s,error:a,lastSync:i,getUserPreferences:o,saveUserPreferences:u,createUserPreferences:d,deleteUserPreferences:f,exportUserPreferences:P,importUserPreferences:l,syncToServer:p,syncFromServer:y,resolveConflict:v,checkNetworkStatus:k,clearError:_}},Pt=r.createContext(null),Zr=({children:s})=>{const t=Et(),[a,n]=r.useState(t),[i,g]=r.useState(!1),[h,o]=r.useState(!1),[u,d]=r.useState(null),[f,P]=r.useState(!1),[l,p]=r.useState(!1),[y,v]=r.useState(null),k=r.useRef(!1),_=Yr(),c=Jr();r.useEffect(()=>(N("info","PreferenceProvider ì´ˆê¸°í™” ì‹œì‘"),k.current=!0,(async()=>{try{if(g(!0),d(null),await new Promise(x=>setTimeout(x,100)),!k.current)return;if(_.isAvailable)try{N("info","ì´ˆê¸°í™” ì‹œ localStorageì—ì„œ ì„¤ì • ë¡œë“œ ì‹œì‘");const x=await _.loadSettings();if(x.success&&x.settings){const b=Js(x.settings,t);n(b),p(!1),N("info","ì´ˆê¸°í™” ì‹œ ì„¤ì • ë¡œë“œ ì™„ë£Œ",{settingsKeys:Object.keys(b)})}else N("info","ì €ì¥ëœ ì„¤ì • ì—†ìŒ - ê¸°ë³¸ê°’ ì‚¬ìš©"),n(t)}catch(x){N("warn","ì´ˆê¸°í™” ì‹œ ì„¤ì • ë¡œë“œ ì‹¤íŒ¨, ê¸°ë³¸ê°’ ì‚¬ìš©",x.message),n(t)}else N("warn","localStorage ì‚¬ìš© ë¶ˆê°€ - ê¸°ë³¸ê°’ ì‚¬ìš©"),n(t);P(!0),N("info","PreferenceProvider ì´ˆê¸°í™” ì™„ë£Œ")}catch(x){N("error","PreferenceProvider ì´ˆê¸°í™” ì˜¤ë¥˜",x.message),d(x.message),n(t),P(!0)}finally{g(!1)}})(),()=>{k.current=!1}),[t,_.isAvailable]);const D=r.useCallback((m,x,b)=>{N("info","ì„¤ì • ì—…ë°ì´íŠ¸",{section:m,key:x,value:b}),n(F=>{const T={...F,[m]:{...F[m],[x]:b}};return p(!0),v(new Date),N("info","ì„¤ì • ì—…ë°ì´íŠ¸ ì™„ë£Œ",{section:m,key:x}),T})},[]),A=r.useCallback(m=>{N("info","ë‹¤ì¤‘ ì„¤ì • ì—…ë°ì´íŠ¸ ì‹œì‘",{newSettingsKeys:Object.keys(m)}),n(x=>{const b={...x};return Object.entries(m).forEach(([F,T])=>{typeof T=="object"&&(b[F]={...b[F],...T})}),p(!0),v(new Date),N("info","ë‹¤ì¤‘ ì„¤ì • ì—…ë°ì´íŠ¸ ì™„ë£Œ"),b})},[]),j=r.useCallback(async()=>{N("info","ì„¤ì • ì €ì¥ ì‹œì‘");try{o(!0),d(null);const m=await _.saveSettings(a);if(m.success)return p(!1),N("info","ì„¤ì • ì €ì¥ ì™„ë£Œ"),{success:!0};throw new Error(m.error)}catch(m){const x=m.message;return d(x),N("error","ì„¤ì • ì €ì¥ ì‹¤íŒ¨",x),{success:!1,error:x}}finally{o(!1)}},[a,_]),$=r.useCallback(async()=>{N("info","ì„¤ì • ë¡œë“œ ì‹œì‘");try{g(!0),d(null);const m=await _.loadSettings();if(m.success){if(m.settings){const x=Js(m.settings,t);n(x),p(!1),N("info","ì„¤ì • ë¡œë“œ ì™„ë£Œ",{settingsKeys:Object.keys(x)})}else N("info","ì €ì¥ëœ ì„¤ì • ì—†ìŒ");return{success:!0,settings:m.settings}}else throw new Error(m.error)}catch(m){const x=m.message;return d(x),N("error","ì„¤ì • ë¡œë“œ ì‹¤íŒ¨",x),{success:!1,error:x}}finally{g(!1)}},[t,_]),G=r.useCallback(async(m=null)=>{N("info","ì„¤ì • ì´ˆê¸°í™” ì‹œì‘",{sections:m});try{g(!0),d(null);let x=t;return m&&Array.isArray(m)&&(x={...a},m.forEach(b=>{t[b]&&(x[b]={...t[b]})})),n(x),p(!0),v(new Date),m===null&&await _.clearSettings(),N("info","ì„¤ì • ì´ˆê¸°í™” ì™„ë£Œ"),{success:!0}}catch(x){const b=x.message;return d(b),N("error","ì„¤ì • ì´ˆê¸°í™” ì‹¤íŒ¨",b),{success:!1,error:b}}finally{g(!1)}},[t,a,_]),w=r.useCallback((m=null)=>{N("info","ì„¤ì • ìœ íš¨ì„± ê²€ì¦ ì‹œì‘",{section:m});const x=Kr(a,m);return Object.keys(x).length>0?(N("warn","ì„¤ì • ìœ íš¨ì„± ê²€ì¦ ì‹¤íŒ¨",x),d(`ì„¤ì • ì˜¤ë¥˜: ${Object.values(x)[0]}`)):(N("info","ì„¤ì • ìœ íš¨ì„± ê²€ì¦ í†µê³¼"),d(null)),x},[a]),E={state:{settings:a,loading:i||_.loading||c.loading,saving:h||_.saving||c.saving,error:u||_.error||c.error,initialized:f,hasUnsavedChanges:l,lastModified:y,lastSaved:_.lastSaved,lastSync:c.lastSync,localStorageAvailable:_.isAvailable},settings:a,dashboardSettings:a.dashboardSettings||{},statisticsSettings:a.statisticsSettings||{},databaseSettings:a.databaseSettings||{},notificationSettings:a.notificationSettings||{},generalSettings:a.generalSettings||{},updateSetting:D,updateSettings:A,saveSettings:j,loadSettings:$,resetSettings:G,validateCurrentSettings:w,storage:_,api:c};return e.jsx(Pt.Provider,{value:E,children:s})},Qr=()=>{const s=r.useContext(Pt);if(!s){N("warn","usePreference: PreferenceProvider ì™¸ë¶€ì—ì„œ ì‚¬ìš©ë¨ - ê¸°ë³¸ê°’ ë°˜í™˜");const t=Et();return{state:{settings:t,loading:!1,saving:!1,error:null,initialized:!1,hasUnsavedChanges:!1,lastModified:null,lastSaved:null,lastSync:null,localStorageAvailable:!1},settings:t,dashboardSettings:t.dashboardSettings||{},statisticsSettings:t.statisticsSettings||{},databaseSettings:t.databaseSettings||{},notificationSettings:t.notificationSettings||{},generalSettings:t.generalSettings||{},updateSetting:()=>{},updateSettings:()=>{},saveSettings:()=>Promise.resolve({success:!1}),loadSettings:()=>Promise.resolve({success:!1}),resetSettings:()=>Promise.resolve({success:!1}),validateCurrentSettings:()=>({}),storage:{isAvailable:!1,saveSettings:()=>Promise.resolve({success:!1}),loadSettings:()=>Promise.resolve({success:!1}),clearSettings:()=>Promise.resolve({success:!1}),error:null},api:{loading:!1,error:null,getUserPreferences:()=>Promise.resolve({success:!1}),saveUserPreferences:()=>Promise.resolve({success:!1}),clearError:()=>{}}}}return s},ee=(s,t,a=null)=>{const i=`[usePreference:${new Date().toISOString()}]`;switch(s){case"info":console.log(`${i} ${t}`,a);break;case"error":console.error(`${i} ${t}`,a);break;case"warn":console.warn(`${i} ${t}`,a);break;case"debug":console.debug(`${i} ${t}`,a);break;default:console.log(`${i} ${t}`,a)}},Ps={dashboardSettings:{selectedPegs:{required:!0,type:"array",minLength:1,message:"ìµœì†Œ í•˜ë‚˜ì˜ PEGë¥¼ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤."},autoRefreshInterval:{required:!0,type:"number",min:5,max:300,message:"ìë™ ìƒˆë¡œê³ ì¹¨ ê°„ê²©ì€ 5ì´ˆ~300ì´ˆ ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤."},defaultNe:{type:"string",maxLength:50,message:"NE IDëŠ” 50ìë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."},defaultCellId:{type:"string",maxLength:50,message:"Cell IDëŠ” 50ìë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."}},statisticsSettings:{defaultDateRange:{required:!0,type:"number",min:1,max:365,message:"ê¸°ë³¸ ë‚ ì§œ ë²”ìœ„ëŠ” 1ì¼~365ì¼ ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤."},decimalPlaces:{required:!0,type:"number",min:0,max:6,message:"ì†Œìˆ˜ì  ìë¦¿ìˆ˜ëŠ” 0~6ìë¦¬ ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤."},defaultPegs:{required:!0,type:"array",minLength:1,message:"ìµœì†Œ í•˜ë‚˜ì˜ ê¸°ë³¸ PEGë¥¼ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤."}}},Zs=(s,t=null)=>{ee("debug","ì„¤ì • ìœ íš¨ì„± ê²€ì¦ ì‹œì‘",{section:t,settings:s});const a={};if(t&&!Ps[t])return ee("warn",`ê²€ì¦ ê·œì¹™ì´ ì—†ëŠ” ì„¹ì…˜: ${t}`),a;const n=t?{[t]:Ps[t]}:Ps;return Object.entries(n).forEach(([i,g])=>{if(!s[i]){ee("debug",`ì„¹ì…˜ ${i}ê°€ ì„¤ì •ì— ì—†ìŒ`);return}Object.entries(g).forEach(([h,o])=>{const u=s[i][h],d=`${i}.${h}`;if(o.required&&(u==null||u==="")){a[d]=o.message||`${h}ëŠ” í•„ìˆ˜ í•­ëª©ì…ë‹ˆë‹¤.`,ee("error",`í•„ìˆ˜ í•„ë“œ ëˆ„ë½: ${d}`);return}if(u==null||u===""){ee("debug",`í•„ë“œ ${d} ê°’ì´ ì—†ì–´ ê²€ì¦ ìŠ¤í‚µ`);return}if(o.type==="array"&&!Array.isArray(u)){a[d]=o.message||`${h}ëŠ” ë°°ì—´ì´ì–´ì•¼ í•©ë‹ˆë‹¤.`,ee("error",`íƒ€ì… ì˜¤ë¥˜: ${d}ëŠ” ë°°ì—´ì´ì–´ì•¼ í•¨`);return}if(o.type==="number"&&typeof u!="number"){a[d]=o.message||`${h}ëŠ” ìˆ«ìì—¬ì•¼ í•©ë‹ˆë‹¤.`,ee("error",`íƒ€ì… ì˜¤ë¥˜: ${d}ëŠ” ìˆ«ìì—¬ì•¼ í•¨`);return}if(o.type==="string"&&typeof u!="string"){a[d]=o.message||`${h}ëŠ” ë¬¸ìì—´ì´ì–´ì•¼ í•©ë‹ˆë‹¤.`,ee("error",`íƒ€ì… ì˜¤ë¥˜: ${d}ëŠ” ë¬¸ìì—´ì´ì–´ì•¼ í•¨`);return}if(o.type==="number"){if(o.min!==void 0&&u<o.min){a[d]=o.message||`${h}ëŠ” ${o.min} ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.`,ee("error",`ë²”ìœ„ ì˜¤ë¥˜: ${d}ëŠ” ${o.min} ì´ìƒì´ì–´ì•¼ í•¨`);return}if(o.max!==void 0&&u>o.max){a[d]=o.message||`${h}ëŠ” ${o.max} ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.`,ee("error",`ë²”ìœ„ ì˜¤ë¥˜: ${d}ëŠ” ${o.max} ì´í•˜ì—¬ì•¼ í•¨`);return}}if(o.type==="array"){if(o.minLength!==void 0&&u.length<o.minLength){a[d]=o.message||`${h}ëŠ” ìµœì†Œ ${o.minLength}ê°œ í•­ëª©ì´ í•„ìš”í•©ë‹ˆë‹¤.`,ee("error",`ë°°ì—´ ê¸¸ì´ ì˜¤ë¥˜: ${d}ëŠ” ìµœì†Œ ${o.minLength}ê°œ í•„ìš”`);return}if(o.maxLength!==void 0&&u.length>o.maxLength){a[d]=o.message||`${h}ëŠ” ìµœëŒ€ ${o.maxLength}ê°œ í•­ëª©ë§Œ í—ˆìš©ë©ë‹ˆë‹¤.`,ee("error",`ë°°ì—´ ê¸¸ì´ ì˜¤ë¥˜: ${d}ëŠ” ìµœëŒ€ ${o.maxLength}ê°œë§Œ í—ˆìš©`);return}}if(o.type==="string"){if(o.minLength!==void 0&&u.length<o.minLength){a[d]=o.message||`${h}ëŠ” ìµœì†Œ ${o.minLength}ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.`,ee("error",`ë¬¸ìì—´ ê¸¸ì´ ì˜¤ë¥˜: ${d}ëŠ” ìµœì†Œ ${o.minLength}ì í•„ìš”`);return}if(o.maxLength!==void 0&&u.length>o.maxLength){a[d]=o.message||`${h}ëŠ” ìµœëŒ€ ${o.maxLength}ìê¹Œì§€ í—ˆìš©ë©ë‹ˆë‹¤.`,ee("error",`ë¬¸ìì—´ ê¸¸ì´ ì˜¤ë¥˜: ${d}ëŠ” ìµœëŒ€ ${o.maxLength}ìë§Œ í—ˆìš©`);return}}})}),ee("debug","ì„¤ì • ìœ íš¨ì„± ê²€ì¦ ì™„ë£Œ",{errors:a}),a},Ye=()=>{ee("info","usePreference í›… ì´ˆê¸°í™”");const s=Qr(),[t,a]=r.useState({}),n=r.useMemo(()=>{const l=(s==null?void 0:s.settings)||{};return ee("debug","ì„¤ì • ì ‘ê·¼",{hasSettings:!!l}),l},[s==null?void 0:s.settings]),i=r.useCallback(l=>{ee("info","ì„¤ì • ì—…ë°ì´íŠ¸ ì‹œì‘",{newSettings:l}),s!=null&&s.updateSetting?(Object.entries(l).forEach(([p,y])=>{typeof y=="object"&&Object.entries(y).forEach(([v,k])=>{ee("debug",`ì„¤ì • ì—…ë°ì´íŠ¸: ${p}.${v}`,{value:k}),s.updateSetting(p,v,k)})}),ee("info","ì„¤ì • ì—…ë°ì´íŠ¸ ì™„ë£Œ")):ee("error","updateSetting í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ")},[s==null?void 0:s.updateSetting]),g=r.useCallback(async()=>{if(ee("info","ì„¤ì • ì €ì¥ ì‹œì‘"),s!=null&&s.saveSettings)try{const l=await s.saveSettings();return ee("info","ì„¤ì • ì €ì¥ ì™„ë£Œ",{result:l}),l}catch(l){throw ee("error","ì„¤ì • ì €ì¥ ì‹¤íŒ¨",l),l}else return ee("error","saveSettings í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ"),!1},[s==null?void 0:s.saveSettings]),h=r.useCallback(async()=>{if(ee("info","ì„¤ì • ë¡œë“œ ì‹œì‘"),s!=null&&s.loadSettings)try{const l=await s.loadSettings();return ee("info","ì„¤ì • ë¡œë“œ ì™„ë£Œ",{result:l}),l}catch(l){throw ee("error","ì„¤ì • ë¡œë“œ ì‹¤íŒ¨",l),l}else return ee("error","loadSettings í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ"),!1},[s==null?void 0:s.loadSettings]),o=r.useCallback(async l=>{if(ee("info","ì„¤ì • ë¦¬ì…‹ ì‹œì‘",{sections:l}),s!=null&&s.resetSettings)try{const p=await s.resetSettings(l);return ee("info","ì„¤ì • ë¦¬ì…‹ ì™„ë£Œ",{result:p}),p}catch(p){return ee("error","ì„¤ì • ë¦¬ì…‹ ì‹¤íŒ¨",p),{success:!1,error:p.message}}else return ee("error","resetSettings í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ"),{success:!1,error:"resetSettings í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"}},[s==null?void 0:s.resetSettings]),u=r.useCallback((l,p=null)=>{var k;ee("info","ì„¤ì • ì—…ë°ì´íŠ¸ ë° ê²€ì¦ ì‹œì‘",{newSettings:l,section:p});const y=p?{...n,[p]:{...n[p],...l[p]}}:{...n,...l},v=Zs(y,p);if(a(v),Object.keys(v).length>0){ee("error","ì„¤ì • ìœ íš¨ì„± ê²€ì¦ ì‹¤íŒ¨",v);const _=Object.values(v)[0];return(k=n.notificationSettings)!=null&&k.errorNotification&&Q.error(`ì„¤ì • ì˜¤ë¥˜: ${_}`),!1}return i(l),ee("info","ì„¤ì • ì—…ë°ì´íŠ¸ ì™„ë£Œ"),!0},[n,i]),d=r.useCallback((l=null,p=null)=>{var y,v;ee("info","ì„¤ì • ë‚´ë³´ë‚´ê¸° ì‹œì‘",{filename:l,partial:p});try{const k={settings:p&&Object.keys(p).length>0?{...n,...p}:n,metadata:{exportedAt:new Date().toISOString(),version:"1.0.0",userId:(s==null?void 0:s.userId)||"default"}},_=JSON.stringify(k,null,2),c=new Blob([_],{type:"application/json"}),D=document.createElement("a");return D.href=URL.createObjectURL(c),D.download=l||`preference-settings-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(D.href),ee("info","ì„¤ì • ë‚´ë³´ë‚´ê¸° ì™„ë£Œ",{filename:D.download}),(y=n.notificationSettings)!=null&&y.enableToasts&&Q.success("ì„¤ì •ì´ íŒŒì¼ë¡œ ë‚´ë³´ë‚´ì¡ŒìŠµë‹ˆë‹¤"),!0}catch(k){return ee("error","ì„¤ì • ë‚´ë³´ë‚´ê¸° ì‹¤íŒ¨",k),(v=n.notificationSettings)!=null&&v.errorNotification&&Q.error("ì„¤ì • ë‚´ë³´ë‚´ê¸° ì‹¤íŒ¨: "+k.message),!1}},[n,s==null?void 0:s.userId]),f=r.useCallback(l=>(ee("info","ì„¤ì • ê°€ì ¸ì˜¤ê¸° ì‹œì‘",{filename:l.name}),new Promise((p,y)=>{const v=new FileReader;v.onload=k=>{var _,c;try{const D=JSON.parse(k.target.result);if(!D.settings)throw new Error("ìœ íš¨í•˜ì§€ ì•Šì€ ì„¤ì • íŒŒì¼ì…ë‹ˆë‹¤.");i(D.settings),ee("info","ì„¤ì • ê°€ì ¸ì˜¤ê¸° ì™„ë£Œ",{filename:l.name}),(_=n.notificationSettings)!=null&&_.enableToasts&&Q.success("ì„¤ì •ì´ ì„±ê³µì ìœ¼ë¡œ ê°€ì ¸ì™€ì¡ŒìŠµë‹ˆë‹¤"),p(D)}catch(D){ee("error","ì„¤ì • ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨",D),(c=n.notificationSettings)!=null&&c.errorNotification&&Q.error("ì„¤ì • ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨: "+D.message),y(D)}},v.onerror=()=>{const k=new Error("íŒŒì¼ ì½ê¸° ì‹¤íŒ¨");ee("error","ì„¤ì • ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨",k),y(k)},v.readAsText(l)})),[n,i]),P={settings:n,dashboardSettings:n.dashboardSettings||{},statisticsSettings:n.statisticsSettings||{},databaseSettings:n.databaseSettings||{},notificationSettings:n.notificationSettings||{},generalSettings:n.generalSettings||{},loading:(s==null?void 0:s.loading)||!1,saving:(s==null?void 0:s.saving)||!1,error:(s==null?void 0:s.error)||null,initialized:(s==null?void 0:s.initialized)||!1,updateSettings:i,updateSettingsWithValidation:u,saveSettings:g,loadSettings:h,exportSettings:d,importSettings:f,resetSettings:o,validationErrors:t,validateSettings:(l,p)=>Zs(l,p),logInfo:(l,p)=>ee("info",l,p),logError:(l,p)=>ee("error",l,p)};return ee("debug","usePreference í›… ë°˜í™˜ê°’ ìƒì„± ì™„ë£Œ"),P},Xr=()=>{ee("info","useDashboardSettings í›… ì´ˆê¸°í™”");const{dashboardSettings:s,updateSettings:t,saving:a,error:n,validationErrors:i,logInfo:g}=Ye(),h=r.useMemo(()=>{const d={selectedPegs:[],defaultNe:"",defaultCellId:"",autoRefreshInterval:30,chartStyle:"line",showLegend:!0,showGrid:!0},f={...d,...s};return Array.isArray(s==null?void 0:s.selectedPegs)&&s.selectedPegs.length>0?f.selectedPegs=s.selectedPegs:f.selectedPegs=d.selectedPegs,ee("debug","Dashboard ì„¤ì • ì²˜ë¦¬ ì™„ë£Œ",{settings:f}),f},[s]),o=r.useCallback(d=>(g("Dashboard ì„¤ì • ì—…ë°ì´íŠ¸",d),t({dashboardSettings:d})),[t,g]),u=r.useMemo(()=>Object.fromEntries(Object.entries(i).filter(([d])=>d.startsWith("dashboardSettings."))),[i]);return{settings:h,updateSettings:o,saving:a,error:n,validationErrors:u,hasErrors:Object.keys(u).length>0}},$t=()=>{ee("info","useStatisticsSettings í›… ì´ˆê¸°í™”");const{statisticsSettings:s,updateSettings:t,saving:a,error:n,validationErrors:i,logInfo:g}=Ye(),h=r.useCallback(u=>(g("Statistics ì„¤ì • ì—…ë°ì´íŠ¸",u),t({statisticsSettings:u})),[t,g]),o=r.useMemo(()=>Object.fromEntries(Object.entries(i).filter(([u])=>u.startsWith("statisticsSettings."))),[i]);return{settings:s,updateSettings:h,saving:a,error:n,validationErrors:o,hasErrors:Object.keys(o).length>0}},en=(s,t,a=null)=>{const i=`[DashboardHeader:${new Date().toISOString()}]`;switch(s){case"info":console.log(`${i} ${t}`,a);break;case"error":console.error(`${i} ${t}`,a);break;case"warn":console.warn(`${i} ${t}`,a);break;case"debug":console.debug(`${i} ${t}`,a);break;default:console.log(`${i} ${t}`,a)}},Qs=({loading:s,saving:t,settingsError:a,selectedPegs:n,chartStyle:i,enableTimeComparison:g,defaultNe:h,defaultCellId:o,autoRefreshInterval:u,refreshCountdown:d,lastRefresh:f,onManualRefresh:P})=>(en("debug","DashboardHeader ë Œë”ë§",{loading:s,saving:t,settingsError:a,selectedPegsCount:n==null?void 0:n.length,chartStyle:i,enableTimeComparison:g,defaultNe:h,defaultCellId:o,autoRefreshInterval:u,refreshCountdown:d,lastRefresh:f}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold",children:"Dashboard"}),e.jsxs("p",{className:"text-muted-foreground",children:[(n==null?void 0:n.length)||0,"ê°œ PEG í•­ëª© â€¢ ì°¨íŠ¸ ìŠ¤íƒ€ì¼: ",i,g&&" â€¢ Time1/Time2 ë¹„êµ ëª¨ë“œ",h&&` â€¢ NE: ${h}`,o&&` â€¢ Cell: ${o}`]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[t&&e.jsxs(Z,{variant:"secondary",className:"text-xs",children:[e.jsx(Be,{className:"h-3 w-3 mr-1"}),"ì„¤ì • ì €ì¥ ì¤‘"]}),a&&e.jsx(Z,{variant:"destructive",className:"text-xs",children:"ì„¤ì • ì˜¤ë¥˜"}),g&&e.jsx(Z,{variant:"default",className:"text-xs bg-blue-100 text-blue-800",children:"Time1/Time2 ë¹„êµ"}),u>0&&d>0&&e.jsxs(Z,{variant:"outline",className:"text-xs",children:[e.jsx(Be,{className:"h-3 w-3 mr-1"}),d,"ì´ˆ í›„ ìƒˆë¡œê³ ì¹¨"]}),f&&e.jsxs(Z,{variant:"secondary",className:"text-xs",children:["ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ",f.toLocaleTimeString()]}),e.jsxs(J,{variant:"outline",size:"sm",onClick:P,disabled:s,children:[e.jsx(os,{className:`h-4 w-4 mr-2 ${s?"animate-spin":""}`}),"ìƒˆë¡œê³ ì¹¨"]})]})]}));function Ee({...s}){return e.jsx(xa,{"data-slot":"select",...s})}function Pe({...s}){return e.jsx(pa,{"data-slot":"select-value",...s})}function $e({className:s,size:t="default",children:a,...n}){return e.jsxs(ga,{"data-slot":"select-trigger","data-size":t,className:te("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...n,children:[a,e.jsx(fa,{asChild:!0,children:e.jsx(Xe,{className:"size-4 opacity-50"})})]})}function Ae({className:s,children:t,position:a="popper",...n}){return e.jsx(ja,{children:e.jsxs(va,{"data-slot":"select-content",className:te("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:a,...n,children:[e.jsx(sn,{}),e.jsx(ba,{className:te("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),e.jsx(tn,{})]})})}function le({className:s,children:t,...a}){return e.jsxs(ya,{"data-slot":"select-item",className:te("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",s),...a,children:[e.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:e.jsx(Na,{children:e.jsx(Fe,{className:"size-4"})})}),e.jsx(wa,{children:t})]})}function sn({className:s,...t}){return e.jsx(Sa,{"data-slot":"select-scroll-up-button",className:te("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(ys,{className:"size-4"})})}function tn({className:s,...t}){return e.jsx(Ca,{"data-slot":"select-scroll-down-button",className:te("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(Xe,{className:"size-4"})})}function rs({className:s,...t}){return e.jsx(ka,{"data-slot":"switch",className:te("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...t,children:e.jsx(Da,{"data-slot":"switch-thumb",className:te("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}function W({className:s,...t}){return e.jsx(_a,{"data-slot":"label",className:te("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...t})}const an=(s,t,a=null)=>{const i=`[DashboardSettings:${new Date().toISOString()}]`;switch(s){case"info":console.log(`${i} ${t}`,a);break;case"error":console.error(`${i} ${t}`,a);break;case"warn":console.warn(`${i} ${t}`,a);break;case"debug":console.debug(`${i} ${t}`,a);break;default:console.log(`${i} ${t}`,a)}},rn=({defaultTimeRange:s,enableTimeComparison:t,tempTimeSettings:a,inputCompleted:n,loading:i,onUpdateDefaultTimeRange:g,onUpdateEnableTimeComparison:h,onUpdateTempTimeSetting:o,onApplyTime1Settings:u,onApplyTime2Settings:d,onManualRefresh:f})=>(an("debug","DashboardSettings ë Œë”ë§",{defaultTimeRange:s,enableTimeComparison:t,tempTimeSettings:a,inputCompleted:n,loading:i}),e.jsxs(re,{children:[e.jsx(he,{children:e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"h-5 w-5"}),"ê¸°ë³¸ì‹œê°„ ì„¤ì •"]})}),e.jsxs(ne,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(W,{htmlFor:"defaultTimeRange",className:"text-sm font-medium",children:"ê¸°ë³¸ ì‹œê°„ ë²”ìœ„"}),e.jsxs(Ee,{value:s.toString(),onValueChange:g,children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:"ì‹œê°„ ë²”ìœ„ ì„ íƒ"})}),e.jsxs(Ae,{children:[e.jsx(le,{value:"5",children:"5ë¶„"}),e.jsx(le,{value:"15",children:"15ë¶„"}),e.jsx(le,{value:"30",children:"30ë¶„"}),e.jsx(le,{value:"60",children:"1ì‹œê°„"}),e.jsx(le,{value:"120",children:"2ì‹œê°„"}),e.jsx(le,{value:"360",children:"6ì‹œê°„"}),e.jsx(le,{value:"720",children:"12ì‹œê°„"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(rs,{id:"enableTimeComparison",checked:t,onCheckedChange:h}),e.jsx(W,{htmlFor:"enableTimeComparison",className:"text-sm font-medium",children:"Time1/Time2 ë¹„êµ í™œì„±í™”"})]}),t&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-600",children:"Time1 ì„¤ì •"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(W,{htmlFor:"time1Start",className:"text-xs text-muted-foreground",children:"ì‹œì‘ ì‹œê°„"}),e.jsx("input",{type:"datetime-local",id:"time1Start",className:"w-full px-2 py-1 border border-gray-300 rounded text-xs",value:a.time1Start,onChange:P=>o("time1","Start",P.target.value)})]}),e.jsxs("div",{children:[e.jsx(W,{htmlFor:"time1End",className:"text-xs text-muted-foreground",children:"ë ì‹œê°„"}),e.jsx("input",{type:"datetime-local",id:"time1End",className:"w-full px-2 py-1 border border-gray-300 rounded text-xs",value:a.time1End,onChange:P=>o("time1","End",P.target.value)})]}),e.jsx(J,{onClick:u,disabled:!a.time1Start||!a.time1End||n.time1,size:"sm",className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:n.time1?e.jsxs(e.Fragment,{children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),"Time1 ì„¤ì • ì™„ë£Œ"]}):"Time1 ì„¤ì • ì…ë ¥"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-green-600",children:"Time2 ì„¤ì •"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(W,{htmlFor:"time2Start",className:"text-xs text-muted-foreground",children:"ì‹œì‘ ì‹œê°„"}),e.jsx("input",{type:"datetime-local",id:"time2Start",className:"w-full px-2 py-1 border border-gray-300 rounded text-xs",value:a.time2Start,onChange:P=>o("time2","Start",P.target.value)})]}),e.jsxs("div",{children:[e.jsx(W,{htmlFor:"time2End",className:"text-xs text-muted-foreground",children:"ë ì‹œê°„"}),e.jsx("input",{type:"datetime-local",id:"time2End",className:"w-full px-2 py-1 border border-gray-300 rounded text-xs",value:a.time2End,onChange:P=>o("time2","End",P.target.value)})]}),e.jsx(J,{onClick:d,disabled:!a.time2Start||!a.time2End||n.time2,size:"sm",className:"w-full bg-green-600 hover:bg-green-700 text-white",children:n.time2?e.jsxs(e.Fragment,{children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),"Time2 ì„¤ì • ì™„ë£Œ"]}):"Time2 ì„¤ì • ì…ë ¥"})]})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(J,{onClick:f,disabled:i||!n.time1||!n.time2,className:"bg-purple-600 hover:bg-purple-700 text-white",children:i?"ë°ì´í„° ë¡œë”© ì¤‘...":"Time1/Time2 ë¹„êµ ë°ì´í„° ë¡œë“œ"})}),e.jsxs("div",{className:"flex justify-center gap-4 text-xs",children:[e.jsxs("div",{className:`flex items-center gap-1 ${n.time1?"text-green-600":"text-gray-500"}`,children:[n.time1?e.jsx(Fe,{className:"h-3 w-3"}):e.jsx(Le,{className:"h-3 w-3"}),"Time1 ì„¤ì • ",n.time1?"ì™„ë£Œ":"ëŒ€ê¸°"]}),e.jsxs("div",{className:`flex items-center gap-1 ${n.time2?"text-green-600":"text-gray-500"}`,children:[n.time2?e.jsx(Fe,{className:"h-3 w-3"}):e.jsx(Le,{className:"h-3 w-3"}),"Time2 ì„¤ì • ",n.time2?"ì™„ë£Œ":"ëŒ€ê¸°"]})]})]}),!t&&e.jsx(J,{onClick:f,disabled:i,className:"w-full",children:i?"ë°ì´í„° ë¡œë”© ì¤‘...":"ë°ì´í„° ìƒˆë¡œê³ ì¹¨"})]})]})]})),fs=(s,t,a=null)=>{const i=`[DashboardChart:${new Date().toISOString()}]`;switch(s){case"info":console.log(`${i} ${t}`,a);break;case"error":console.error(`${i} ${t}`,a);break;case"warn":console.warn(`${i} ${t}`,a);break;case"debug":console.debug(`${i} ${t}`,a);break;default:console.log(`${i} ${t}`,a)}},Ve=s=>{const t=["#8884d8","#82ca9d","#ffc658","#ff7300","#8dd1e1","#d084d0"];return s<t.length?t[s]:`hsl(${s*47%360}, 70%, 50%)`},At=({chartData:s,key:t,idx:a,chartStyle:n,showGrid:i,showLegend:g,enableTimeComparison:h})=>{if(fs("debug","DashboardChart ë Œë”ë§",{key:t,chartStyle:n,dataLength:s==null?void 0:s.length,showGrid:i,showLegend:g,enableTimeComparison:h}),!s||s.length===0)return fs("warn","ì°¨íŠ¸ ë°ì´í„°ê°€ ì—†ìŒ",{key:t}),e.jsx("div",{className:"h-full flex items-center justify-center text-muted-foreground",children:"ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤"});const o=s.length>0?Object.keys(s[0]).filter(f=>f!=="time"):[];fs("debug","ì°¨íŠ¸ ì—”í‹°í‹° ì •ë³´",{key:t,entities:o,entitiesCount:o.length});const u={data:s,className:"h-64"},d=[i&&e.jsx(He,{strokeDasharray:"3 3"},"grid"),e.jsx(qe,{dataKey:"time"},"xaxis"),e.jsx(ze,{},"yaxis"),e.jsx(Re,{},"tooltip"),g&&e.jsx(Me,{},"legend")].filter(Boolean);try{switch(n){case"area":return e.jsx(Ie,{width:"100%",height:"100%",children:e.jsxs(bt,{...u,children:[d,o.map((f,P)=>{if(h&&f.includes("_Time")){const l=f.replace("_Time1","").replace("_Time2",""),p=f.includes("_Time1");return e.jsx(as,{type:"monotone",dataKey:f,stroke:Ve((a+P)%12),fill:Ve((a+P)%12),fillOpacity:.3,strokeWidth:2,strokeDasharray:p?void 0:"5 5",name:`${l} (${p?"Time1":"Time2"})`},f)}else return e.jsx(as,{type:"monotone",dataKey:f,stroke:Ve((a+P)%12),fill:Ve((a+P)%12),fillOpacity:.3,strokeWidth:2},f)})]})});case"bar":return e.jsx(Ie,{width:"100%",height:"100%",children:e.jsxs(vs,{...u,children:[d,o.map((f,P)=>{if(h&&f.includes("_Time")){const l=f.replace("_Time1","").replace("_Time2",""),p=f.includes("_Time1");return e.jsx(Te,{dataKey:f,fill:Ve((a+P)%12),name:`${l} (${p?"Time1":"Time2"})`},f)}else return e.jsx(Te,{dataKey:f,fill:Ve((a+P)%12)},f)})]})});case"line":default:return e.jsx(Ie,{width:"100%",height:"100%",children:e.jsxs(Gs,{...u,children:[d,o.map((f,P)=>{if(h&&f.includes("_Time")){const l=f.replace("_Time1","").replace("_Time2",""),p=f.includes("_Time1");return e.jsx(Ge,{type:"monotone",dataKey:f,stroke:Ve((a+P)%12),strokeWidth:2,strokeDasharray:p?void 0:"5 5",name:`${l} (${p?"Time1":"Time2"})`},f)}else return e.jsx(Ge,{type:"monotone",dataKey:f,stroke:Ve((a+P)%12),strokeWidth:2},f)})]})})}}catch(f){return fs("error","ì°¨íŠ¸ ë Œë”ë§ ì˜¤ë¥˜",{key:t,error:f}),e.jsx("div",{className:"h-full flex items-center justify-center text-red-500",children:"ì°¨íŠ¸ ë Œë”ë§ ì˜¤ë¥˜"})}},nn=(s,t,a=null)=>{const i=`[DashboardCard:${new Date().toISOString()}]`;switch(s){case"info":console.log(`${i} ${t}`,a);break;case"error":console.error(`${i} ${t}`,a);break;case"warn":console.warn(`${i} ${t}`,a);break;case"debug":console.debug(`${i} ${t}`,a);break;default:console.log(`${i} ${t}`,a)}},Xs=s=>s,et=({key:s,idx:t,title:a,chartData:n,chartStyle:i,chartLayout:g,enableTimeComparison:h,showGrid:o,showLegend:u,onZoom:d})=>{nn("debug","DashboardCard ë Œë”ë§",{key:s,idx:t,title:a,chartStyle:i,chartLayout:g,dataLength:n==null?void 0:n.length,enableTimeComparison:h});const f=(n==null?void 0:n.length)>0?Object.keys(n[0]).filter(P=>P!=="time"):[];return e.jsxs(re,{children:[e.jsx(he,{children:e.jsxs(xe,{className:"flex items-center justify-between",children:[Xs(a),e.jsxs("div",{className:"flex items-center gap-2",children:[h&&e.jsx(Z,{variant:"default",className:"text-xs bg-blue-100 text-blue-800",children:"Time1/Time2 ë¹„êµ"}),e.jsxs(Z,{variant:"outline",className:"text-xs",children:[f.length,"ê°œ ì‹œë¦¬ì¦ˆ"]}),e.jsxs(Z,{variant:"secondary",className:"text-xs",children:[(n==null?void 0:n.length)||0,"ê°œ ë°ì´í„°í¬ì¸íŠ¸"]})]})]})}),e.jsx(ne,{children:e.jsx("div",{className:"h-64 cursor-zoom-in",onClick:()=>d({open:!0,title:Xs(a),data:n}),children:e.jsx(At,{chartData:n,idx:t,chartStyle:i,showGrid:o,showLegend:u,enableTimeComparison:h},s)})})]},`${s}-${t}`)},je=(s,t,a=null)=>{const i=`[Dashboard:${new Date().toISOString()}]`;switch(s){case"info":console.log(`${i} ${t}`,a);break;case"error":console.error(`${i} ${t}`,a);break;case"warn":console.warn(`${i} ${t}`,a);break;case"debug":console.debug(`${i} ${t}`,a);break;default:console.log(`${i} ${t}`,a)}},It=()=>{je("info","Dashboard ì»´í¬ë„ŒíŠ¸ ì´ˆê¸°í™”");const[s,t]=r.useState({}),[a,n]=r.useState(null),[i,g]=r.useState(!0),[h,o]=r.useState(null),[u,d]=r.useState(0),[f,P]=r.useState({open:!1,title:"",data:[]}),l=r.useRef(null),p=r.useRef(null),[y,v]=r.useState({time1Start:"",time1End:"",time2Start:"",time2End:""}),[k,_]=r.useState({time1:!1,time2:!1}),{settings:c={},saving:D=!1,error:A=null,updateSettings:j=()=>{}}=Xr(),{settings:$={}}=Ye(),G=r.useMemo(()=>Array.isArray(c==null?void 0:c.selectedPegs)?c.selectedPegs:[],[c==null?void 0:c.selectedPegs]),w=r.useMemo(()=>($==null?void 0:$.statisticsSettings)||{},[$==null?void 0:$.statisticsSettings]),E=r.useMemo(()=>Array.isArray(w.selectedNEs)?w.selectedNEs:[],[w.selectedNEs]),m=r.useMemo(()=>Array.isArray(w.selectedCellIds)?w.selectedCellIds:[],[w.selectedCellIds]),x=r.useMemo(()=>(c==null?void 0:c.autoRefreshInterval)||30,[c==null?void 0:c.autoRefreshInterval]),b=r.useMemo(()=>(c==null?void 0:c.chartStyle)||"line",[c==null?void 0:c.chartStyle]),F=r.useMemo(()=>(c==null?void 0:c.chartLayout)||"byPeg",[c==null?void 0:c.chartLayout]),T=r.useMemo(()=>(c==null?void 0:c.showLegend)!==!1,[c==null?void 0:c.showLegend]),q=r.useMemo(()=>(c==null?void 0:c.showGrid)!==!1,[c==null?void 0:c.showGrid]),se=r.useMemo(()=>(c==null?void 0:c.defaultNe)||"",[c==null?void 0:c.defaultNe]),ie=r.useMemo(()=>(c==null?void 0:c.defaultCellId)||"",[c==null?void 0:c.defaultCellId]),O=r.useMemo(()=>(c==null?void 0:c.defaultTimeRange)||30,[c==null?void 0:c.defaultTimeRange]),R=r.useMemo(()=>(c==null?void 0:c.time1Start)||"",[c==null?void 0:c.time1Start]),U=r.useMemo(()=>(c==null?void 0:c.time1End)||"",[c==null?void 0:c.time1End]),B=r.useMemo(()=>(c==null?void 0:c.time2Start)||"",[c==null?void 0:c.time2Start]),S=r.useMemo(()=>(c==null?void 0:c.time2End)||"",[c==null?void 0:c.time2End]),M=r.useMemo(()=>(c==null?void 0:c.enableTimeComparison)||!1,[c==null?void 0:c.enableTimeComparison]),C=r.useCallback(ae=>{je("info","ê¸°ë³¸ì‹œê°„ë²”ìœ„ ì—…ë°ì´íŠ¸",{value:ae}),j({defaultTimeRange:parseInt(ae)})},[j]),K=r.useCallback(ae=>{je("info","í† ê¸€ ìƒíƒœ ë³€ê²½",{checked:ae}),j({enableTimeComparison:ae})},[j]),H=r.useCallback((ae,fe,be)=>{je("debug","ì„ì‹œ ì‹œê°„ ì„¤ì • ì—…ë°ì´íŠ¸",{type:ae,field:fe,value:be}),v(ce=>({...ce,[`${ae}${fe}`]:be}))},[]),V=r.useCallback(()=>{y.time1Start&&y.time1End&&(je("info","Time1 ì„¤ì • ì ìš©",{start:y.time1Start,end:y.time1End}),j({time1Start:y.time1Start,time1End:y.time1End}),_(ae=>({...ae,time1:!0})))},[y.time1Start,y.time1End,j]),Y=r.useCallback(()=>{y.time2Start&&y.time2End&&(je("info","Time2 ì„¤ì • ì ìš©",{start:y.time2Start,end:y.time2End}),j({time2Start:y.time2Start,time2End:y.time2End}),_(ae=>({...ae,time2:!0})))},[y.time2Start,y.time2End,j]),de=r.useCallback(async()=>{var ce,ye,z;je("info","ë°ì´í„° fetching ì‹œì‘");const ae=G.length>0?G:["randomaccessproblem"],fe=E.length>0?E:["NVGNB#101086"],be=m.length>0?m.map(I=>parseInt(I)):[8418];if(je("debug","ë°ì´í„° fetching íŒŒë¼ë¯¸í„°",{selectedPegs:G,safeSelectedPegs:ae,selectedNEs:E,safeSelectedNEs:fe,selectedCellIds:m,safeSelectedCellIds:be,defaultNe:se,defaultCellId:ie,enableTimeComparison:M,time1Start:R,time1End:U,time2Start:B,time2End:S}),ae.length===0){je("warn","ì„ íƒëœ PEGê°€ ì—†ìŒ - ë°ì´í„° fetching ì¤‘ë‹¨"),t({}),n(null),g(!1);return}try{if(g(!0),M&&R&&U&&B&&S){je("info","Time1/Time2 ë¹„êµ ëª¨ë“œë¡œ ë°ì´í„° fetching");const I={start_date:R,end_date:U,kpi_types:ae,ne:fe,cellid:be};je("debug","Time1 API íŒŒë¼ë¯¸í„°",I);const L=await ge.post("/api/kpi/query",I),ue={start_date:B,end_date:S,kpi_types:ae,ne:fe,cellid:be};je("debug","Time2 API íŒŒë¼ë¯¸í„°",ue);const X=await ge.post("/api/kpi/query",ue),Ne=((ce=L==null?void 0:L.data)==null?void 0:ce.data)||{},pe=((ye=X==null?void 0:X.data)==null?void 0:ye.data)||{};t(Ne),n(pe),je("info","Time1/Time2 ë°ì´í„° fetching ì™„ë£Œ",{time1KpiCount:Object.keys(Ne).length,time1TotalRows:Object.values(Ne).reduce((Je,Ze)=>Je+((Ze==null?void 0:Ze.length)||0),0),time2KpiCount:Object.keys(pe).length,time2TotalRows:Object.values(pe).reduce((Je,Ze)=>Je+((Ze==null?void 0:Ze.length)||0),0),time1DataKeys:Object.keys(Ne),time2DataKeys:Object.keys(pe)})}else{je("info","ì¼ë°˜ ëª¨ë“œë¡œ ë°ì´í„° fetching");const I=new Date,L=new Date(I.getTime()-((c==null?void 0:c.defaultHours)||1)*60*60*1e3),ue={kpi_types:ae,ne:fe,cellid:be,start:L.toISOString(),end:I.toISOString()};je("debug","ì¼ë°˜ ëª¨ë“œ API íŒŒë¼ë¯¸í„°",ue);const X=await ge.post("/api/kpi/timeseries",ue),Ne=((z=X==null?void 0:X.data)==null?void 0:z.data)||{};t(Ne),n(null),je("info","ì¼ë°˜ ëª¨ë“œ ë°ì´í„° fetching ì™„ë£Œ",{kpiCount:Object.keys(Ne).length,totalRows:Object.values(Ne).reduce((pe,Je)=>pe+((Je==null?void 0:Je.length)||0),0),dataKeys:Object.keys(Ne)})}o(new Date)}catch(I){je("error","ë°ì´í„° fetching ì˜¤ë¥˜",I),t({}),n(null)}finally{g(!1)}},[G,E,m,c==null?void 0:c.defaultHours,se,ie,M,R,U,B,S]);r.useEffect(()=>(je("debug","ìë™ ìƒˆë¡œê³ ì¹¨ ì„¤ì • ë³€ê²½",{autoRefreshInterval:x}),l.current&&clearInterval(l.current),p.current&&clearInterval(p.current),x>0&&(je("info","ìë™ ìƒˆë¡œê³ ì¹¨ ì„¤ì •",{interval:x}),l.current=setInterval(()=>{de()},x*1e3),d(x),p.current=setInterval(()=>{d(ae=>ae<=1?x:ae-1)},1e3)),()=>{l.current&&clearInterval(l.current),p.current&&clearInterval(p.current)}),[x,de]),r.useEffect(()=>{de()},[de]);const me=r.useCallback(()=>{je("info","ìˆ˜ë™ ìƒˆë¡œê³ ì¹¨ ì‹¤í–‰"),de()},[de]),ke=r.useCallback(ae=>{je("debug","ì°¨íŠ¸ ë°ì´í„° êµ¬ì„±",{kpiKey:ae,chartLayout:F});const fe=Array.isArray(s[ae])?s[ae]:[],be=M&&a?Array.isArray(a[ae])?a[ae]:[]:[];if(fe.length===0&&be.length===0)return[];if(F==="byPeg"){const ce={};return fe.forEach(ye=>{const z=new Date(ye.timestamp).toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"});ce[z]||(ce[z]={time:z});const I=M?`${ye.entity_id}_Time1`:ye.entity_id;ce[z][I]=ye.value}),M&&be.forEach(ye=>{const z=new Date(ye.timestamp).toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"});ce[z]||(ce[z]={time:z});const I=`${ye.entity_id}_Time2`;ce[z][I]=ye.value}),Object.values(ce)}else{const ce={};fe.forEach(z=>{const I=new Date(z.timestamp).toLocaleString(),L=z.entity_id;ce[L]=ce[L]||{},ce[L][I]=ce[L][I]||{time:I},ce[L][I][z.peg_name]=z.value});const ye={};return Object.keys(ce).forEach(z=>{ye[z]=Object.values(ce[z]).sort((I,L)=>new Date(I.time)-new Date(L.time))}),ye}},[s,a,M,F]);return i?(je("debug","ë¡œë”© ìƒíƒœ ë Œë”ë§"),e.jsxs("div",{className:"space-y-6",children:[e.jsx(Qs,{loading:i,saving:D,settingsError:A,selectedPegs:G,chartStyle:b,enableTimeComparison:M,defaultNe:se,defaultCellId:ie,autoRefreshInterval:x,refreshCountdown:u,lastRefresh:h,onManualRefresh:me}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:G.map(ae=>e.jsx(re,{children:e.jsx(ne,{className:"pt-6",children:e.jsx("div",{className:"h-64 flex items-center justify-center",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading..."})})})},ae))})]})):(je("debug","Dashboard ë©”ì¸ ë Œë”ë§"),e.jsxs("div",{className:"space-y-6",children:[e.jsx(rn,{defaultTimeRange:O,enableTimeComparison:M,tempTimeSettings:y,inputCompleted:k,loading:i,onUpdateDefaultTimeRange:C,onUpdateEnableTimeComparison:K,onUpdateTempTimeSetting:H,onApplyTime1Settings:V,onApplyTime2Settings:Y,onManualRefresh:me}),e.jsx(Qs,{loading:i,saving:D,settingsError:A,selectedPegs:G,chartStyle:b,enableTimeComparison:M,defaultNe:se,defaultCellId:ie,autoRefreshInterval:x,refreshCountdown:u,lastRefresh:h,onManualRefresh:me}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(Z,{variant:"default",children:["ì„ íƒëœ PEG: ",G.join(", ")]}),M&&e.jsx(Z,{variant:"default",className:"bg-blue-100 text-blue-800",children:"Time1/Time2 ë¹„êµ í™œì„±í™”"}),x>0&&e.jsxs(Z,{variant:"outline",children:["ìë™ ìƒˆë¡œê³ ì¹¨: ",x,"ì´ˆ"]}),e.jsxs(Z,{variant:"outline",children:["ì°¨íŠ¸ ìŠ¤íƒ€ì¼: ",b]}),!T&&e.jsx(Z,{variant:"secondary",children:"ë²”ë¡€ ìˆ¨ê¹€"}),!q&&e.jsx(Z,{variant:"secondary",children:"ê²©ì ìˆ¨ê¹€"})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:G.map((ae,fe)=>{const be=ke(ae);if(F==="byPeg"){const ce=Array.isArray(be)?be:[];return e.jsx(et,{idx:fe,title:ae,chartData:ce,chartStyle:b,chartLayout:F,enableTimeComparison:M,showGrid:q,showLegend:T,onZoom:P},`${ae}-${fe}`)}else{const ce=be||{};return Object.keys(ce).map((ye,z)=>{const I=ce[ye];return e.jsx(et,{idx:fe+z,title:ye,chartData:I,chartStyle:b,chartLayout:F,enableTimeComparison:M,showGrid:q,showLegend:T,onZoom:P},`${ae}-${ye}-${z}`)})}})}),e.jsx(St,{open:f.open,onOpenChange:ae=>P(fe=>({...fe,open:ae})),children:e.jsxs(Ct,{className:"max-w-6xl",children:[e.jsx(kt,{children:e.jsx(Dt,{children:f.title})}),e.jsx("div",{className:"h-[480px]",children:Array.isArray(f.data)&&f.data.length>0&&e.jsx(At,{chartData:f.data,idx:0,chartStyle:b,showGrid:q,showLegend:T,enableTimeComparison:M},"zoom")})]})}),G.length===0&&e.jsx(re,{children:e.jsx(ne,{className:"pt-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ls,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"í‘œì‹œí•  PEGê°€ ì„ íƒë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤"}),e.jsx("p",{className:"text-muted-foreground",children:"Preference ë©”ë‰´ì—ì„œ í‘œì‹œí•  PEG í•­ëª©ì„ ì„ íƒí•˜ì„¸ìš”."})]})})})]}))},Lt=Object.freeze(Object.defineProperty({__proto__:null,default:It},Symbol.toStringTag,{value:"Module"}));function ws({className:s,...t}){return e.jsx(Ea,{"data-slot":"tabs",className:te("flex flex-col gap-2",s),...t})}function Ss({className:s,...t}){return e.jsx(Pa,{"data-slot":"tabs-list",className:te("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",s),...t})}function De({className:s,...t}){return e.jsx($a,{"data-slot":"tabs-trigger",className:te("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...t})}function _e({className:s,...t}){return e.jsx(Aa,{"data-slot":"tabs-content",className:te("flex-1 outline-none",s),...t})}function ve({className:s,type:t,...a}){return e.jsx("input",{type:t,"data-slot":"input",className:te("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",s),...a})}function ns({className:s,...t}){return e.jsx(Ia,{"data-slot":"checkbox",className:te("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...t,children:e.jsx(La,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(Fe,{className:"size-3.5"})})})}const Tt=r.memo(({chartConfig:s,onConfigChange:t,kpiOptions:a,loading:n,onGenerate:i,useDbPegs:g,onToggleDbPegs:h,pegOptionsLoading:o,dbPegOptions:u})=>{const d=(l,p)=>{t(y=>({...y,[l]:p}))},f=()=>{var l,p;try{const y=localStorage.getItem("activePreference");if(!y)return;const v=JSON.parse(y),k=Array.isArray((l=v==null?void 0:v.config)==null?void 0:l.defaultNEs)?v.config.defaultNEs.map(String):[],_=Array.isArray((p=v==null?void 0:v.config)==null?void 0:p.defaultCellIDs)?v.config.defaultCellIDs.map(String):[];t(c=>({...c,ne:k.join(","),cellid:_.join(",")}))}catch{}},P=()=>g&&u.length>0?u:a;return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 p-4 border rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(W,{className:"text-sm font-medium",children:"PEG ë°ì´í„° ì†ŒìŠ¤"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:g?"Databaseì—ì„œ ì‹¤ì œ PEG ëª©ë¡ì„ ì‚¬ìš©í•©ë‹ˆë‹¤":"ê¸°ë³¸ KPI ëª©ë¡ì„ ì‚¬ìš©í•©ë‹ˆë‹¤"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{variant:g?"secondary":"default",size:"sm",onClick:()=>h(!1),children:"ê¸°ë³¸ KPI"}),e.jsx(J,{variant:g?"default":"secondary",size:"sm",onClick:()=>h(!0),disabled:o,children:o?"ë¡œë”© ì¤‘...":"DB PEG"})]})]}),g&&u.length===0&&!o&&e.jsx("p",{className:"text-xs text-amber-600 mt-2",children:"âš ï¸ DB PEGë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. Database Settingsë¥¼ í™•ì¸í•˜ì„¸ìš”."}),g&&u.length>0&&e.jsxs("p",{className:"text-xs text-green-600 mt-2",children:["âœ… ",u.length,"ê°œì˜ DB PEGë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{children:"Primary KPI"}),e.jsxs(Ee,{value:s.primaryKPI,onValueChange:l=>d("primaryKPI",l),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Ae,{children:P().map(l=>e.jsx(le,{value:l.value,children:l.label},l.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{children:"Secondary KPI (Dual Axis)"}),e.jsxs(Ee,{value:s.secondaryKPI,onValueChange:l=>d("secondaryKPI",l),disabled:!s.showSecondaryAxis,children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Ae,{children:P().map(l=>e.jsx(le,{value:l.value,children:l.label},l.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{children:"Period 1 Start"}),e.jsx(ve,{type:"date",value:s.startDate1,onChange:l=>d("startDate1",l.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{children:"Period 1 End"}),e.jsx(ve,{type:"date",value:s.endDate1,onChange:l=>d("endDate1",l.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{children:"Period 2 Start"}),e.jsx(ve,{type:"date",value:s.startDate2,onChange:l=>d("startDate2",l.target.value),disabled:!s.showComparison})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{children:"Period 2 End"}),e.jsx(ve,{type:"date",value:s.endDate2,onChange:l=>d("endDate2",l.target.value),disabled:!s.showComparison})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{children:"NE"}),e.jsx(ve,{placeholder:"e.g., nvgnb#10000 or nvgnb#10000,nvgnb#20000",value:s.ne,onChange:l=>d("ne",l.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{children:"Cell ID"}),e.jsx(ve,{placeholder:"e.g., 2010 or 2010,2011",value:s.cellid,onChange:l=>d("cellid",l.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{children:"Use Preference (NE/Cell)"}),e.jsx(J,{type:"button",variant:"outline",onClick:f,children:"Load from Preference"})]})]}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ns,{id:"showComparison",checked:s.showComparison,onCheckedChange:l=>d("showComparison",l)}),e.jsx(W,{htmlFor:"showComparison",children:"Show Period Comparison"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ns,{id:"showSecondaryAxis",checked:s.showSecondaryAxis,onCheckedChange:l=>d("showSecondaryAxis",l)}),e.jsx(W,{htmlFor:"showSecondaryAxis",children:"Show Secondary Y-Axis"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ns,{id:"showThreshold",checked:s.showThreshold,onCheckedChange:l=>d("showThreshold",l)}),e.jsx(W,{htmlFor:"showThreshold",children:"Show Threshold Line"})]}),s.showThreshold&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(W,{htmlFor:"threshold",children:"Threshold Value:"}),e.jsx(ve,{id:"threshold",type:"number",step:"0.1",value:s.thresholdValue,onChange:l=>d("thresholdValue",parseFloat(l.target.value)),className:"w-24"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs(J,{onClick:i,disabled:n,className:"flex items-center gap-2",children:[e.jsx(gs,{className:"h-4 w-4"}),n?"Generating...":"Generate Chart"]})})]})});Tt.displayName="ChartControls";const Ot=r.memo(({chartData:s,chartConfig:t,loading:a,kpiOptions:n,useDbPegs:i,dbPegOptions:g})=>{const h=r.useMemo(()=>{if(s.length===0)return{primary:[],secondary:[]};const d=Object.keys(s[0]).filter(l=>l!=="time"),f=d.filter(l=>l.endsWith("_period1")||l.endsWith("_period2")),P=d.filter(l=>l.endsWith("_secondary"));return{primary:f,secondary:P}},[s]),{primary:o,secondary:u}=h;return s.length===0?e.jsx("div",{className:"flex items-center justify-center h-96 text-gray-500",children:a?"Generating chart...":'Click "Generate Chart" to create visualization'}):e.jsx("div",{className:"h-96",children:e.jsx(Ie,{width:"100%",height:"100%",children:e.jsxs(Gs,{data:s,children:[e.jsx(He,{strokeDasharray:"3 3"}),e.jsx(qe,{dataKey:"time"}),e.jsx(ze,{yAxisId:"left"}),t.showSecondaryAxis&&e.jsx(ze,{yAxisId:"right",orientation:"right"}),e.jsx(Re,{}),e.jsx(Me,{}),t.showThreshold&&e.jsx(vr,{y:t.thresholdValue,stroke:"red",strokeDasharray:"5 5",yAxisId:"left"}),o.map((d,f)=>e.jsx(Ge,{yAxisId:"left",type:"monotone",dataKey:d,stroke:d.includes("period1")?`hsl(${f*60}, 70%, 40%)`:`hsl(${f*60}, 70%, 60%)`,strokeWidth:2,strokeDasharray:d.includes("period1")?"0":"5 5"},d)),t.showSecondaryAxis&&u.map((d,f)=>e.jsx(Ge,{yAxisId:"right",type:"monotone",dataKey:d,stroke:`hsl(${(f+o.length)*60}, 70%, 50%)`,strokeWidth:2,strokeDasharray:"10 5"},d))]})})})});Ot.displayName="ChartDisplay";const $s=[{value:"availability",label:"Availability (%)",threshold:99},{value:"rrc",label:"RRC Success Rate (%)",threshold:98.5},{value:"erab",label:"ERAB Success Rate (%)",threshold:99},{value:"sar",label:"SAR",threshold:2.5},{value:"mobility_intra",label:"Mobility Intra (%)",threshold:95},{value:"cqi",label:"CQI",threshold:8}],Vs=r.memo(()=>{var c,D;const[s,t]=r.useState({primaryKPI:"availability",secondaryKPI:"rrc",startDate1:new Date(Date.now()-12096e5).toISOString().split("T")[0],endDate1:new Date(Date.now()-6048e5).toISOString().split("T")[0],startDate2:new Date(Date.now()-6048e5).toISOString().split("T")[0],endDate2:new Date().toISOString().split("T")[0],ne:"",cellid:"",showSecondaryAxis:!0,showComparison:!0,showThreshold:!0,thresholdValue:99}),[a,n]=r.useState([]),[i,g]=r.useState(!1),[h,o]=r.useState(!1),[u,d]=r.useState($s),[f,P]=r.useState([]),[l,p]=r.useState(!1),y=r.useMemo(()=>l&&f.length>0?f:u,[l,f,u]),v=r.useCallback(async()=>{var A;try{o(!0),console.info("[AdvancedChart] Fetching DB PEGs");let j={};try{const E=localStorage.getItem("dbConfig");E&&(j=JSON.parse(E))}catch(E){console.error("Error parsing dbConfig from localStorage",E)}if(!j.host){console.warn("[AdvancedChart] No DB config found");return}const $=await ge.post("/api/master/pegs",{db:j,table:j.table||"summary",limit:100}),G=((A=$==null?void 0:$.data)==null?void 0:A.pegs)||[];console.info("[AdvancedChart] DB PEGs loaded:",G.length);const w=G.map(E=>({value:E.id||E.name,label:`${E.name||E.id} (DB)`,threshold:0,isDbPeg:!0}));P(w)}catch(j){console.error("[AdvancedChart] Error fetching DB PEGs:",j)}finally{o(!1)}},[]),k=r.useCallback((A,j)=>{var x,b;if(!A||A.length===0)return[];const $=((b=(x=A[0])==null?void 0:x.data)==null?void 0:b.data)||[],G=j.showComparison&&A[1]?A[1].data.data:[],w=j.showSecondaryAxis&&A[2]?A[2].data.data:[],E={};function m(F,T){const q={};F.forEach(se=>{const ie=new Date(se.timestamp).toLocaleString();q[ie]||(q[ie]={sum:0,cnt:0}),q[ie].sum+=Number(se.value)||0,q[ie].cnt+=1}),Object.keys(q).forEach(se=>{E[se]||(E[se]={time:se});const ie=q[se].cnt>0?+(q[se].sum/q[se].cnt).toFixed(2):0;E[se][T]=ie})}return m($,`${j.primaryKPI}_period1`),j.showComparison&&m(G,`${j.primaryKPI}_period2`),j.showSecondaryAxis&&m(w,`${j.secondaryKPI}_secondary`),Object.values(E).sort((F,T)=>new Date(F.time)-new Date(T.time)).slice(0,200)},[]),_=r.useCallback(async()=>{try{g(!0),console.info("[AdvancedChart] Generate with config:",s,"useDbPegs:",l);const A=[];A.push(ge.post("/api/kpi/query",{start_date:s.startDate1,end_date:s.endDate1,kpi_type:s.primaryKPI,ne:s.ne,cellid:s.cellid,ids:2})),s.showComparison&&A.push(ge.post("/api/kpi/query",{start_date:s.startDate2,end_date:s.endDate2,kpi_type:s.primaryKPI,ne:s.ne,cellid:s.cellid,ids:2})),s.showSecondaryAxis&&s.secondaryKPI!==s.primaryKPI&&A.push(ge.post("/api/kpi/query",{start_date:s.startDate2,end_date:s.endDate2,kpi_type:s.secondaryKPI,ne:s.ne,cellid:s.cellid,ids:2}));const j=await Promise.all(A);console.info("[AdvancedChart] API responses:",j.map(G=>{var w,E;return((E=(w=G==null?void 0:G.data)==null?void 0:w.data)==null?void 0:E.length)??0}));const $=k(j,s);n($)}catch(A){console.error("[AdvancedChart] Error generating advanced chart:",A)}finally{g(!1)}},[s,l,k]);return r.useEffect(()=>{var A;try{const j=localStorage.getItem("activePreference");if(j){const $=JSON.parse(j),G=Array.isArray((A=$==null?void 0:$.config)==null?void 0:A.availableKPIs)&&$.config.availableKPIs.length>0?$.config.availableKPIs.map(E=>({value:String((E==null?void 0:E.value)||""),label:String((E==null?void 0:E.label)||(E==null?void 0:E.value)||""),threshold:Number((E==null?void 0:E.threshold)??0)})):$s;d(G);const w=G.map(E=>E.value);t(E=>{var m,x,b,F;return{...E,primaryKPI:w.includes(E.primaryKPI)?E.primaryKPI:((m=G[0])==null?void 0:m.value)||"availability",secondaryKPI:w.includes(E.secondaryKPI)?E.secondaryKPI:((x=G[1])==null?void 0:x.value)||((b=G[0])==null?void 0:b.value)||"rrc",thresholdValue:((F=G.find(T=>{var q;return T.value===(w.includes(E.primaryKPI)?E.primaryKPI:((q=G[0])==null?void 0:q.value)||"availability")}))==null?void 0:F.threshold)??E.thresholdValue}})}}catch{d($s)}},[]),r.useEffect(()=>{l&&f.length===0&&v()},[l,f.length,v]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(re,{children:[e.jsx(he,{children:e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"h-5 w-5"}),"Advanced Chart Configuration"]})}),e.jsx(ne,{children:e.jsx(Tt,{chartConfig:s,onConfigChange:t,kpiOptions:u,loading:i,onGenerate:_,useDbPegs:l,pegOptionsLoading:h,dbPegOptions:f})})]}),e.jsxs(re,{children:[e.jsx(he,{children:e.jsxs(xe,{children:[((c=y.find(A=>A.value===s.primaryKPI))==null?void 0:c.label)||"KPI"," Analysis",s.showSecondaryAxis&&` vs ${(D=y.find(A=>A.value===s.secondaryKPI))==null?void 0:D.label}`]})}),e.jsx(ne,{children:e.jsx(Ot,{chartData:a,chartConfig:s,loading:i,kpiOptions:u,useDbPegs:l,dbPegOptions:f})})]})]})});Vs.displayName="AdvancedChart";const Rt=Object.freeze(Object.defineProperty({__proto__:null,default:Vs},Symbol.toStringTag,{value:"Module"}));function xs({className:s,orientation:t="horizontal",decorative:a=!0,...n}){return e.jsx(Ta,{"data-slot":"separator-root",decorative:a,orientation:t,className:te("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",s),...n})}function bs({className:s,children:t,...a}){return e.jsxs(Oa,{"data-slot":"scroll-area",className:te("relative",s),...a,children:[e.jsx(Ra,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),e.jsx(ln,{}),e.jsx(Ma,{})]})}function ln({className:s,orientation:t="vertical",...a}){return e.jsx(za,{"data-slot":"scroll-area-scrollbar",orientation:t,className:te("flex touch-none p-px transition-colors select-none",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",s),...a,children:e.jsx(Fa,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}const st=({title:s="ë‚ ì§œ ë²”ìœ„",description:t="ë¶„ì„í•  ê¸°ê°„ì„ ì„ íƒí•˜ì„¸ìš”",startDate:a,endDate:n,onDateChange:i,preset:g="",onPresetChange:h,disabled:o=!1,error:u=null,className:d="",showPresets:f=!0,minDate:P=null,maxDate:l=null})=>{const[p,y]=r.useState(a||""),[v,k]=r.useState(n||""),[_,c]=r.useState(null),D=[{value:"last7days",label:"ìµœê·¼ 7ì¼",days:7},{value:"last14days",label:"ìµœê·¼ 14ì¼",days:14},{value:"last30days",label:"ìµœê·¼ 30ì¼",days:30},{value:"thisweek",label:"ì´ë²ˆ ì£¼",custom:!0},{value:"lastweek",label:"ì§€ë‚œ ì£¼",custom:!0},{value:"thismonth",label:"ì´ë²ˆ ë‹¬",custom:!0},{value:"lastmonth",label:"ì§€ë‚œ ë‹¬",custom:!0},{value:"custom",label:"ì§ì ‘ ì„ íƒ",custom:!0}];r.useEffect(()=>{y(a||""),k(n||"")},[a,n]);const A=(x,b)=>{if(!x||!b)return"ì‹œì‘ ë‚ ì§œì™€ ì¢…ë£Œ ë‚ ì§œë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”";const F=new Date(x),T=new Date(b);return isNaN(F)||isNaN(T)?"ì˜¬ë°”ë¥¸ ë‚ ì§œ í˜•ì‹ì„ ì…ë ¥í•´ì£¼ì„¸ìš”":F>=T?"ì¢…ë£Œ ë‚ ì§œëŠ” ì‹œì‘ ë‚ ì§œë³´ë‹¤ ì´í›„ì—¬ì•¼ í•©ë‹ˆë‹¤":(T-F)/(1e3*60*60*24)>365?"ë‚ ì§œ ë²”ìœ„ëŠ” ìµœëŒ€ 365ì¼ê¹Œì§€ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤":P&&F<new Date(P)?`ì‹œì‘ ë‚ ì§œëŠ” ${P} ì´í›„ì—¬ì•¼ í•©ë‹ˆë‹¤`:l&&T>new Date(l)?`ì¢…ë£Œ ë‚ ì§œëŠ” ${l} ì´ì „ì´ì–´ì•¼ í•©ë‹ˆë‹¤`:null},j=(x,b)=>{let F=p,T=v;x==="start"?(F=b,y(b)):x==="end"&&(T=b,k(b));const q=A(F,T);c(q),!q&&i&&i({startDate:F,endDate:T})},$=x=>{const b=new Date;let F,T;switch(x){case"last7days":T=new Date(b),F=new Date(b.getTime()-10080*60*1e3);break;case"last14days":T=new Date(b),F=new Date(b.getTime()-336*60*60*1e3);break;case"last30days":T=new Date(b),F=new Date(b.getTime()-720*60*60*1e3);break;case"thisweek":const O=new Date(b);O.setDate(b.getDate()-b.getDay()),F=O,T=new Date(b);break;case"lastweek":const R=new Date(b);R.setDate(b.getDate()-b.getDay()-1);const U=new Date(R);U.setDate(R.getDate()-6),F=U,T=R;break;case"thismonth":F=new Date(b.getFullYear(),b.getMonth(),1),T=new Date(b);break;case"lastmonth":const B=new Date(b.getFullYear(),b.getMonth()-1,1),S=new Date(b.getFullYear(),b.getMonth(),0);F=B,T=S;break;case"custom":h&&h(x);return;default:return}const q=F.toISOString().split("T")[0],se=T.toISOString().split("T")[0];y(q),k(se);const ie=A(q,se);c(ie),!ie&&i&&i({startDate:q,endDate:se}),h&&h(x)},w=(()=>{if(!p||!v)return null;try{const x=new Date(p),b=new Date(v);return{days:Math.ceil((b-x)/(1e3*60*60*24)),startFormatted:x.toLocaleDateString("ko-KR"),endFormatted:b.toLocaleDateString("ko-KR")}}catch{return null}})(),E=u||_,m=!E&&p&&v;return e.jsxs(re,{className:`${d} ${o?"opacity-50":""}`,children:[e.jsxs(he,{className:"pb-3",children:[e.jsxs(xe,{className:"flex items-center gap-2 text-base",children:[e.jsx(ds,{className:"h-4 w-4"}),s]}),t&&e.jsx("p",{className:"text-sm text-muted-foreground",children:t})]}),e.jsxs(ne,{className:"space-y-4",children:[f&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{className:"text-sm font-medium",children:"ë¹ ë¥¸ ì„ íƒ"}),e.jsxs(Ee,{value:g,onValueChange:$,disabled:o,children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:"ê¸°ê°„ì„ ì„ íƒí•˜ì„¸ìš”"})}),e.jsx(Ae,{children:D.map(x=>e.jsx(le,{value:x.value,children:x.label},x.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{htmlFor:`start-${s}`,className:"text-sm",children:"ì‹œì‘ ë‚ ì§œ"}),e.jsx(ve,{id:`start-${s}`,type:"date",value:p,onChange:x=>j("start",x.target.value),disabled:o,min:P,max:l,className:E?"border-red-500":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{htmlFor:`end-${s}`,className:"text-sm",children:"ì¢…ë£Œ ë‚ ì§œ"}),e.jsx(ve,{id:`end-${s}`,type:"date",value:v,onChange:x=>j("end",x.target.value),disabled:o,min:P,max:l,className:E?"border-red-500":""})]})]}),E&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx(Ce,{className:"h-4 w-4 text-red-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-red-700",children:E})]}),w&&m&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx(Ms,{className:"h-4 w-4 text-green-500 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-green-700",children:[e.jsxs("span",{className:"font-medium",children:[w.days,"ì¼ ê¸°ê°„"]}),e.jsxs("span",{className:"text-green-600 ml-2",children:["(",w.startFormatted," ~ ",w.endFormatted,")"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Z,{variant:m?"default":"secondary",className:"text-xs",children:[e.jsx(Be,{className:"h-3 w-3 mr-1"}),m?"ìœ íš¨í•œ ë²”ìœ„":"ë²”ìœ„ ì„¤ì • í•„ìš”"]}),w&&m&&e.jsxs(Z,{variant:"outline",className:"text-xs",children:[w.days,"ì¼ ë°ì´í„°"]})]})]})]})},ts=({comparisonResults:s,title:t="ë¹„êµ ë¶„ì„ ì°¨íŠ¸",className:a="",showControls:n=!0,defaultChartType:i="bar",height:g=400})=>{const[h,o]=r.useState(i),[u,d]=r.useState(!1),[f,P]=r.useState("mean"),l=[{value:"bar",label:"ë§‰ëŒ€ ì°¨íŠ¸",icon:Oe},{value:"line",label:"ë¼ì¸ ì°¨íŠ¸",icon:Us},{value:"area",label:"ì˜ì—­ ì°¨íŠ¸",icon:gs},{value:"pie",label:"íŒŒì´ ì°¨íŠ¸",icon:tr},{value:"radar",label:"ë ˆì´ë” ì°¨íŠ¸",icon:Us},{value:"composed",label:"ë³µí•© ì°¨íŠ¸",icon:Oe}],p=[{value:"mean",label:"í‰ê· ê°’",description:"ë‘ ê¸°ê°„ì˜ í‰ê·  ë¹„êµ"},{value:"delta",label:"Delta",description:"ì ˆëŒ€ê°’ ë³€í™”ëŸ‰"},{value:"delta_percentage",label:"Delta %",description:"ìƒëŒ€ì  ë³€í™”ìœ¨"}],y=r.useMemo(()=>s!=null&&s.analysis_results?(console.log("ğŸ“Š ì°¨íŠ¸ ë°ì´í„° ìƒì„± ì¤‘:",s.analysis_results),s.analysis_results.map(w=>{var F,T;const E=parseFloat((F=w.period1_stats)==null?void 0:F.mean)||0,m=parseFloat((T=w.period2_stats)==null?void 0:T.mean)||0,x=parseFloat(w.delta)||0,b=parseFloat(w.delta_percentage)||0;return{name:w.peg_name,peg_name:w.peg_name,period1:E,period2:m,delta:x,delta_percentage:b,improvement_status:w.improvement_status,improvement_magnitude:w.improvement_magnitude,rsd_period1:parseFloat(w.rsd_period1)||0,rsd_period2:parseFloat(w.rsd_period2)||0,color:w.improvement_status==="improved"?"#22c55e":w.improvement_status==="degraded"?"#ef4444":"#3b82f6",abs_delta:Math.abs(x),abs_delta_percentage:Math.abs(b)}})):[],[s]),v=r.useMemo(()=>{if(!y.length)return[];const w=y.filter(x=>x.improvement_status==="improved").length,E=y.filter(x=>x.improvement_status==="degraded").length,m=y.filter(x=>x.improvement_status==="stable").length;return[{name:"ê°œì„ ",value:w,color:"#22c55e"},{name:"ì•…í™”",value:E,color:"#ef4444"},{name:"ì•ˆì •",value:m,color:"#3b82f6"}].filter(x=>x.value>0)},[y]),k=({active:w,payload:E,label:m})=>{if(w&&E&&E.length){const x=E[0].payload;return e.jsxs("div",{className:"bg-white p-3 border rounded-lg shadow-lg",children:[e.jsx("h4",{className:"font-semibold text-sm",children:m}),e.jsxs("div",{className:"space-y-1 mt-2",children:[E.map((b,F)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("div",{className:"w-3 h-3 rounded",style:{backgroundColor:b.color}}),e.jsxs("span",{children:[b.name,": ",b.value]})]},F)),x.improvement_status&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-2 pt-2 border-t",children:["ìƒíƒœ: ",x.improvement_status==="improved"?"ê°œì„ ":x.improvement_status==="degraded"?"ì•…í™”":"ì•ˆì •",x.improvement_magnitude&&` (${x.improvement_magnitude})`]})]})]})}return null},_=()=>e.jsx(Ie,{width:"100%",height:u?"80vh":g,children:e.jsxs(vs,{data:y,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(He,{strokeDasharray:"3 3"}),e.jsx(qe,{dataKey:"name",angle:-45,textAnchor:"end",height:100,fontSize:12}),e.jsx(ze,{fontSize:12}),e.jsx(Re,{content:e.jsx(k,{})}),e.jsx(Me,{}),f==="mean"&&e.jsxs(e.Fragment,{children:[e.jsx(Te,{dataKey:"period1",fill:"#8884d8",name:"ê¸°ê°„ 1"}),e.jsx(Te,{dataKey:"period2",fill:"#82ca9d",name:"ê¸°ê°„ 2"})]}),f==="delta"&&e.jsx(Te,{dataKey:"delta",name:"Delta",children:y.map((w,E)=>e.jsx(ks,{fill:w.color},`cell-${E}`))}),f==="delta_percentage"&&e.jsx(Te,{dataKey:"delta_percentage",name:"Delta %",children:y.map((w,E)=>e.jsx(ks,{fill:w.color},`cell-${E}`))})]})}),c=()=>e.jsx(Ie,{width:"100%",height:u?"80vh":g,children:e.jsxs(Gs,{data:y,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(He,{strokeDasharray:"3 3"}),e.jsx(qe,{dataKey:"name",angle:-45,textAnchor:"end",height:100,fontSize:12}),e.jsx(ze,{fontSize:12}),e.jsx(Re,{content:e.jsx(k,{})}),e.jsx(Me,{}),f==="mean"&&e.jsxs(e.Fragment,{children:[e.jsx(Ge,{type:"monotone",dataKey:"period1",stroke:"#8884d8",strokeWidth:2,name:"ê¸°ê°„ 1"}),e.jsx(Ge,{type:"monotone",dataKey:"period2",stroke:"#82ca9d",strokeWidth:2,name:"ê¸°ê°„ 2"})]}),f==="delta"&&e.jsx(Ge,{type:"monotone",dataKey:"delta",stroke:"#ff7300",strokeWidth:2,name:"Delta"}),f==="delta_percentage"&&e.jsx(Ge,{type:"monotone",dataKey:"delta_percentage",stroke:"#ff7300",strokeWidth:2,name:"Delta %"})]})}),D=()=>e.jsx(Ie,{width:"100%",height:u?"80vh":g,children:e.jsxs(bt,{data:y,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(He,{strokeDasharray:"3 3"}),e.jsx(qe,{dataKey:"name",angle:-45,textAnchor:"end",height:100,fontSize:12}),e.jsx(ze,{fontSize:12}),e.jsx(Re,{content:e.jsx(k,{})}),e.jsx(Me,{}),f==="mean"&&e.jsxs(e.Fragment,{children:[e.jsx(as,{type:"monotone",dataKey:"period1",stackId:"1",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.6,name:"ê¸°ê°„ 1"}),e.jsx(as,{type:"monotone",dataKey:"period2",stackId:"2",stroke:"#82ca9d",fill:"#82ca9d",fillOpacity:.6,name:"ê¸°ê°„ 2"})]}),f==="delta"&&e.jsx(as,{type:"monotone",dataKey:"delta",stroke:"#ff7300",fill:"#ff7300",fillOpacity:.6,name:"Delta"}),f==="delta_percentage"&&e.jsx(as,{type:"monotone",dataKey:"delta_percentage",stroke:"#ff7300",fill:"#ff7300",fillOpacity:.6,name:"Delta %"})]})}),A=()=>e.jsx(Ie,{width:"100%",height:u?"80vh":g,children:e.jsxs(Cr,{children:[e.jsx(kr,{data:v,cx:"50%",cy:"50%",labelLine:!1,label:({name:w,value:E,percent:m})=>`${w}: ${E}ê°œ (${(m*100).toFixed(0)}%)`,outerRadius:u?200:100,fill:"#8884d8",dataKey:"value",children:v.map((w,E)=>e.jsx(ks,{fill:w.color},`cell-${E}`))}),e.jsx(Re,{}),e.jsx(Me,{})]})}),j=()=>{const w=y.map(E=>({peg:E.name.length>10?E.name.substring(0,8)+"...":E.name,period1:Math.min(Math.max(E.period1/Math.max(...y.map(m=>m.period1))*100,0),100),period2:Math.min(Math.max(E.period2/Math.max(...y.map(m=>m.period2))*100,0),100)}));return e.jsx(Ie,{width:"100%",height:u?"80vh":g,children:e.jsxs(yr,{data:w,children:[e.jsx(Nr,{}),e.jsx(wr,{dataKey:"peg",fontSize:10}),e.jsx(Sr,{angle:90,domain:[0,100],fontSize:10,tick:!1}),e.jsx(qs,{name:"ê¸°ê°„ 1",dataKey:"period1",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.3}),e.jsx(qs,{name:"ê¸°ê°„ 2",dataKey:"period2",stroke:"#82ca9d",fill:"#82ca9d",fillOpacity:.3}),e.jsx(Me,{}),e.jsx(Re,{})]})})},$=()=>e.jsx(Ie,{width:"100%",height:u?"80vh":g,children:e.jsxs(br,{data:y,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(He,{strokeDasharray:"3 3"}),e.jsx(qe,{dataKey:"name",angle:-45,textAnchor:"end",height:100,fontSize:12}),e.jsx(ze,{yAxisId:"left",fontSize:12}),e.jsx(ze,{yAxisId:"right",orientation:"right",fontSize:12}),e.jsx(Re,{content:e.jsx(k,{})}),e.jsx(Me,{}),e.jsx(Te,{yAxisId:"left",dataKey:"period1",fill:"#8884d8",name:"ê¸°ê°„ 1"}),e.jsx(Te,{yAxisId:"left",dataKey:"period2",fill:"#82ca9d",name:"ê¸°ê°„ 2"}),e.jsx(Ge,{yAxisId:"right",type:"monotone",dataKey:"delta_percentage",stroke:"#ff7300",strokeWidth:3,name:"Delta %"})]})}),G=()=>{switch(h){case"bar":return _();case"line":return c();case"area":return D();case"pie":return A();case"radar":return j();case"composed":return $();default:return _()}};return!s||!y.length?e.jsx(re,{className:a,children:e.jsxs(ne,{className:"flex flex-col items-center justify-center h-64",children:[e.jsx(Oe,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"ì°¨íŠ¸ ë°ì´í„° ì—†ìŒ"}),e.jsx("p",{className:"text-muted-foreground text-center",children:"ë¹„êµ ë¶„ì„ì„ ì‹¤í–‰í•˜ë©´ ê²°ê³¼ë¥¼ ì°¨íŠ¸ë¡œ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤"})]})}):e.jsxs(re,{className:`${a} ${u?"fixed inset-4 z-50 bg-white":""}`,children:[e.jsxs(he,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"h-5 w-5"}),t,e.jsxs(Z,{variant:"outline",className:"ml-2",children:[y.length,"ê°œ PEG"]})]}),n&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(J,{variant:"ghost",size:"sm",onClick:()=>d(!u),children:u?e.jsx(pt,{className:"h-4 w-4"}):e.jsx(jt,{className:"h-4 w-4"})})})]}),n&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"ì°¨íŠ¸ íƒ€ì…"}),e.jsxs(Ee,{value:h,onValueChange:o,children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Ae,{children:l.map(w=>{const E=w.icon;return e.jsx(le,{value:w.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4"}),w.label]})},w.value)})})]})]}),!["pie","radar"].includes(h)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"í‘œì‹œ ë©”íŠ¸ë¦­"}),e.jsxs(Ee,{value:f,onValueChange:P,children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Ae,{children:p.map(w=>e.jsx(le,{value:w.value,children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:w.label}),e.jsx("div",{className:"text-xs text-muted-foreground",children:w.description})]})},w.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"ì°¨íŠ¸ ì •ë³´"}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("div",{children:["ì´ ",y.length,"ê°œ PEG ë¹„êµ"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Z,{variant:"secondary",className:"text-xs",children:["ê°œì„ : ",y.filter(w=>w.improvement_status==="improved").length]}),e.jsxs(Z,{variant:"destructive",className:"text-xs",children:["ì•…í™”: ",y.filter(w=>w.improvement_status==="degraded").length]})]})]})]})]})]}),e.jsxs(ne,{children:[e.jsx("div",{className:"w-full",children:G()}),e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsx("div",{className:"text-xs text-muted-foreground space-y-1",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded"}),e.jsxs("span",{children:["ê°œì„  (",y.filter(w=>w.improvement_status==="improved").length,"ê°œ)"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded"}),e.jsxs("span",{children:["ì•…í™” (",y.filter(w=>w.improvement_status==="degraded").length,"ê°œ)"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),e.jsxs("span",{children:["ì•ˆì • (",y.filter(w=>w.improvement_status==="stable").length,"ê°œ)"]})]}),e.jsxs("div",{className:"text-muted-foreground",children:["ì´ ",y.length,"ê°œ PEG ë¶„ì„"]})]})})})]})]})},Mt=Object.freeze(Object.defineProperty({__proto__:null,default:ts},Symbol.toStringTag,{value:"Module"})),zt=()=>{var O,R,U,B,S,M;const{settings:s}=$t(),{updatePreference:t,isSaving:a}=Ye(),[n,i]=r.useState({startDate:"",endDate:"",preset:"last7days"}),[g,h]=r.useState({startDate:"",endDate:"",preset:"last14days"}),[o,u]=r.useState(["availability","rrc","erab"]),[d,f]=r.useState(!0),[P,l]=r.useState(4),[p,y]=r.useState(null),[v,k]=r.useState(!1),[_,c]=r.useState(null),[D,A]=r.useState(null),[j,$]=r.useState(new Set),G=r.useMemo(()=>s!=null&&s.table?[{value:"availability",label:"Availability (%)"},{value:"rrc",label:"RRC Success Rate (%)"},{value:"erab",label:"ERAB Success Rate (%)"},{value:"sar",label:"SAR"},{value:"mobility_intra",label:"Mobility Intra (%)"},{value:"cqi",label:"CQI"}]:[],[s==null?void 0:s.table]),w=r.useCallback(async()=>{console.log("ğŸ” Available PEGs ë¡œë“œ ì‹œì‘");try{const C=localStorage.getItem("dbConfig"),K=localStorage.getItem("useDbPegs")==="true";console.log("ğŸ“Š DB ì„¤ì • ìƒíƒœ:",{hasDbConfig:!!C,useDbPegs:K,dbConfigData:C?JSON.parse(C):null});let H=[];if(K&&C){console.log("ğŸ”— Databaseì—ì„œ PEG ëª©ë¡ ì¡°íšŒ ì¤‘...");const V=await ge.get("/api/master/pegs");console.log("ğŸ“¥ Database PEG ì‘ë‹µ:",V.data),V.data&&Array.isArray(V.data)&&(H=V.data.map(Y=>({value:Y.peg_name||Y.value||Y.id,label:Y.display_name||Y.label||`${Y.peg_name} (${Y.unit||"N/A"})`})))}if(H.length===0&&(console.log("ğŸ“ ê¸°ë³¸ PEG ëª©ë¡ ì‚¬ìš©"),H=[{value:"availability",label:"Availability (%)"},{value:"rrc",label:"RRC Success Rate (%)"},{value:"erab",label:"ERAB Success Rate (%)"},{value:"sar",label:"SAR"},{value:"mobility_intra",label:"Mobility Intra (%)"},{value:"cqi",label:"CQI"},{value:"se",label:"Spectral Efficiency"},{value:"dl_thp",label:"DL Throughput"},{value:"ul_int",label:"UL Interference"}]),console.log("âœ… PEG ëª©ë¡ ë¡œë“œ ì™„ë£Œ:",H),o.length===0&&H.length>0){const V=H.slice(0,3).map(Y=>Y.value);u(V),console.log("ğŸ¯ ê¸°ë³¸ PEG ì„ íƒ:",V)}}catch(C){console.error("âŒ PEG ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:",C)}finally{}},[o.length]);r.useEffect(()=>{const C=new Date,K=new Date(C),H=new Date(C.getTime()-10080*60*1e3),V=new Date(H),Y=new Date(H.getTime()-10080*60*1e3);i({startDate:H.toISOString().split("T")[0],endDate:K.toISOString().split("T")[0],preset:"last7days"}),h({startDate:Y.toISOString().split("T")[0],endDate:V.toISOString().split("T")[0],preset:"custom"}),w()},[w]),r.useEffect(()=>{s.defaultPegs&&u(s.defaultPegs),s.decimalPlaces!==void 0&&l(s.decimalPlaces),s.includeOutliers!==void 0&&f(s.includeOutliers)},[s]);const E=r.useCallback(({startDate:C,endDate:K})=>{i(H=>({...H,startDate:C,endDate:K,preset:"custom"}))},[]),m=r.useCallback(({startDate:C,endDate:K})=>{h(H=>({...H,startDate:C,endDate:K,preset:"custom"}))},[]),x=async()=>{var C,K,H;if(!n.startDate||!n.endDate||!g.startDate||!g.endDate){Q.error("ë‘ ê¸°ê°„ì˜ ë‚ ì§œë¥¼ ëª¨ë‘ ì„¤ì •í•´ì£¼ì„¸ìš”");return}if(o.length===0){Q.error("ë¶„ì„í•  PEGë¥¼ ìµœì†Œ 1ê°œ ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”");return}k(!0),c(null);try{console.log("ğŸ” Statistics ë¹„êµ ë¶„ì„ ì‹œì‘:",{period1:n,period2:g,selectedPegs:o,includeOutliers:d,decimalPlaces:P});const V={period1:{start_date:`${n.startDate}T00:00:00`,end_date:`${n.endDate}T23:59:59`},period2:{start_date:`${g.startDate}T00:00:00`,end_date:`${g.endDate}T23:59:59`},peg_names:o,include_outliers:d,decimal_places:P,ne_filter:s.defaultNe?[s.defaultNe]:null,cell_id_filter:s.defaultCellId?[s.defaultCellId]:null};console.log("ğŸ“¤ API ìš”ì²­ í˜ì´ë¡œë“œ:",V);const Y=await ge.post("/api/statistics/compare",V);console.log("ğŸ“¥ API ì‘ë‹µ:",Y.data),y(Y.data),A(new Date),Q.success(`ë¹„êµ ë¶„ì„ ì™„ë£Œ! ${((C=Y.data.analysis_results)==null?void 0:C.length)||0}ê°œ PEG ë¶„ì„ë¨`)}catch(V){console.error("âŒ ë¹„êµ ë¶„ì„ ì‹¤íŒ¨:",V);let Y="ë¹„êµ ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤";(H=(K=V.response)==null?void 0:K.data)!=null&&H.error_message?Y=V.response.data.error_message:V.message&&(Y=V.message),c(Y),Q.error(Y)}finally{k(!1)}},b=C=>{const K=new Set(j);K.has(C)?K.delete(C):K.add(C),$(K)},F=()=>{var C,K;if(j.size===((C=p==null?void 0:p.analysis_results)==null?void 0:C.length))$(new Set);else{const H=((K=p==null?void 0:p.analysis_results)==null?void 0:K.map(V=>V.peg_name))||[];$(new Set(H))}},T=async()=>{if(j.size===0){Q.error("ì €ì¥í•  PEGë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”");return}try{console.log("ğŸ’¾ Dashboardì— ì €ì¥í•  PEG:",Array.from(j));const C=dashboardSettings||{},K=(C==null?void 0:C.selectedPegs)||[],H=Array.from(j).filter(Y=>!K.includes(Y)),V=[...K,...H];console.log("ğŸ“Š í˜„ì¬ Dashboard PEG:",K),console.log("ğŸ†• ì¶”ê°€í•  ìƒˆ PEG:",H),console.log("ğŸ“ˆ ì—…ë°ì´íŠ¸ëœ PEG ëª©ë¡:",V),await t("dashboardSettings",{...C,selectedPegs:V}),Q.success(`${j.size}ê°œ PEGê°€ Dashboardì— ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤`,{description:`ì´ ${V.length}ê°œ PEGê°€ Dashboardì— ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. Dashboardë¡œ ì´ë™í•´ì„œ í™•ì¸í•´ë³´ì„¸ìš”!`,duration:5e3}),$(new Set)}catch(C){console.error("âŒ Dashboard ì €ì¥ ì‹¤íŒ¨:",C),Q.error("Dashboard ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",{description:C.message||"ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤"})}},q=n.startDate&&n.endDate&&g.startDate&&g.endDate&&o.length>0,se=C=>{switch(C){case"improved":return e.jsx(gs,{className:"h-4 w-4 text-green-500"});case"degraded":return e.jsx(rr,{className:"h-4 w-4 text-red-500"});case"stable":return e.jsx(ar,{className:"h-4 w-4 text-blue-500"});default:return e.jsx(Is,{className:"h-4 w-4 text-yellow-500"})}},ie=(C,K)=>{const H={improved:"bg-green-100 text-green-800 border-green-200",degraded:"bg-red-100 text-red-800 border-red-200",stable:"bg-blue-100 text-blue-800 border-blue-200"},V={significant:"ìƒë‹¹í•œ",moderate:"ë³´í†µ",minor:"ë¯¸ë¯¸í•œ",none:"ë³€í™”ì—†ìŒ"};return e.jsxs(Z,{className:`${H[C]||"bg-gray-100 text-gray-800"} text-xs`,children:[se(C),e.jsxs("span",{className:"ml-1",children:[C==="improved"?"ê°œì„ ":C==="degraded"?"ì•…í™”":"ì•ˆì •",K&&` (${V[K]})`]})]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Basic ë¹„êµ ë¶„ì„"}),e.jsx("p",{className:"text-muted-foreground",children:"ë‘ ê¸°ê°„ì˜ KPI ë°ì´í„°ë¥¼ ë¹„êµí•˜ì—¬ ì„±ëŠ¥ ë³€í™”ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[D&&e.jsxs(Z,{variant:"outline",className:"text-xs",children:["ë§ˆì§€ë§‰ ë¶„ì„: ",D.toLocaleTimeString("ko-KR")]}),e.jsx(J,{onClick:x,disabled:!q||v,className:"bg-blue-600 hover:bg-blue-700",children:v?e.jsxs(e.Fragment,{children:[e.jsx(os,{className:"h-4 w-4 mr-2 animate-spin"}),"ë¶„ì„ ì¤‘..."]}):e.jsxs(e.Fragment,{children:[e.jsx(zs,{className:"h-4 w-4 mr-2"}),"ë¹„êµ ë¶„ì„ ì‹¤í–‰"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx(st,{title:"ê¸°ê°„ 1 (ê¸°ì¤€)",description:"ë¹„êµì˜ ê¸°ì¤€ì´ ë˜ëŠ” ì²« ë²ˆì§¸ ê¸°ê°„",startDate:n.startDate,endDate:n.endDate,preset:n.preset,onDateChange:E,onPresetChange:C=>i(K=>({...K,preset:C}))}),e.jsx(st,{title:"ê¸°ê°„ 2 (ë¹„êµ ëŒ€ìƒ)",description:"ê¸°ì¤€ê³¼ ë¹„êµí•  ë‘ ë²ˆì§¸ ê¸°ê°„",startDate:g.startDate,endDate:g.endDate,preset:g.preset,onDateChange:m,onPresetChange:C=>h(K=>({...K,preset:C}))}),e.jsxs(re,{children:[e.jsx(he,{className:"pb-3",children:e.jsxs(xe,{className:"flex items-center gap-2 text-base",children:[e.jsx(ls,{className:"h-4 w-4"}),"ë¶„ì„ ì˜µì…˜"]})}),e.jsxs(ne,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{className:"text-sm font-medium flex items-center justify-between",children:e.jsx("span",{children:"ë¶„ì„í•  PEG"})}),e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:G.length>0?G.map(C=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ns,{id:`peg-${C.value}`,checked:o.includes(C.value),onCheckedChange:K=>{u(K?H=>[...H,C.value]:H=>H.filter(V=>V!==C.value))}}),e.jsx(W,{htmlFor:`peg-${C.value}`,className:"text-sm cursor-pointer flex-1",children:C.label})]},C.value)):e.jsxs("div",{className:"text-center text-muted-foreground py-4",children:[e.jsx(We,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"ì‚¬ìš© ê°€ëŠ¥í•œ PEGê°€ ì—†ìŠµë‹ˆë‹¤"}),e.jsx("p",{className:"text-xs",children:"Database ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”"})]})}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs(Z,{variant:"outline",className:"text-xs",children:[o.length,"ê°œ ì„ íƒë¨"]})})]}),e.jsx(xs,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(W,{className:"text-sm",children:"ì´ìƒì¹˜ í¬í•¨"}),e.jsx(J,{variant:d?"default":"outline",size:"sm",onClick:()=>f(!d),children:d?"í¬í•¨":"ì œì™¸"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{className:"text-sm",children:"ì†Œìˆ˜ì  ìë¦¿ìˆ˜"}),e.jsxs(Ee,{value:P.toString(),onValueChange:C=>l(parseInt(C)),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Ae,{children:[e.jsx(le,{value:"2",children:"2ìë¦¬"}),e.jsx(le,{value:"3",children:"3ìë¦¬"}),e.jsx(le,{value:"4",children:"4ìë¦¬"}),e.jsx(le,{value:"5",children:"5ìë¦¬"})]})]})]})]})]})]})]}),_&&e.jsx(re,{className:"border-red-200 bg-red-50",children:e.jsxs(ne,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Is,{className:"h-5 w-5 text-red-500"}),e.jsx("span",{className:"text-red-700 font-medium",children:"ë¶„ì„ ì˜¤ë¥˜"})]}),e.jsx("p",{className:"text-red-600 mt-2",children:_})]})}),p&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(xs,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"ë¹„êµ ë¶„ì„ ê²°ê³¼"}),e.jsx("div",{className:"mb-6",children:e.jsx(ts,{comparisonResults:p,title:"PEG ë¹„êµ ë¶„ì„ ì°¨íŠ¸",showControls:!0,defaultChartType:"bar",height:400})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(re,{children:e.jsx(ne,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:((O=p.summary)==null?void 0:O.total_pegs_analyzed)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"ë¶„ì„ëœ PEG"})]})})}),e.jsx(re,{children:e.jsx(ne,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:((R=p.summary)==null?void 0:R.improved_count)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"ê°œì„ "})]})})}),e.jsx(re,{children:e.jsx(ne,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:((U=p.summary)==null?void 0:U.degraded_count)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"ì•…í™”"})]})})}),e.jsx(re,{children:e.jsx(ne,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:((B=p.summary)==null?void 0:B.stable_count)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"ì•ˆì •"})]})})})]}),e.jsxs(re,{children:[e.jsx(he,{children:e.jsx(xe,{children:"ìƒì„¸ ë¹„êµ ê²°ê³¼"})}),e.jsx(ne,{children:e.jsxs(ws,{defaultValue:"table",className:"w-full",children:[e.jsxs(Ss,{className:"grid w-full grid-cols-2",children:[e.jsxs(De,{value:"table",className:"flex items-center gap-2",children:[e.jsx(vt,{className:"h-4 w-4"}),"í…Œì´ë¸” ë·°"]}),e.jsxs(De,{value:"chart",className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"h-4 w-4"}),"ì°¨íŠ¸ ë·°"]})]}),e.jsxs(_e,{value:"table",className:"space-y-4",children:[((S=p==null?void 0:p.analysis_results)==null?void 0:S.length)>0&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 border border-slate-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:j.size===p.analysis_results.length&&j.size>0,onChange:F,className:"w-4 h-4 text-blue-600 rounded"}),e.jsxs("span",{className:"text-sm font-medium",children:["ì „ì²´ ì„ íƒ (",j.size,"/",p.analysis_results.length,")"]})]}),j.size>0&&e.jsxs(Z,{variant:"secondary",className:"bg-blue-100 text-blue-700",children:[j.size,"ê°œ ì„ íƒë¨"]})]}),j.size>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{variant:"outline",size:"sm",onClick:()=>$(new Set),children:"ì„ íƒ í•´ì œ"}),e.jsx(J,{size:"sm",onClick:T,disabled:a,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400",children:a?e.jsxs(e.Fragment,{children:[e.jsx(os,{className:"h-3 w-3 mr-1 animate-spin"}),"ì €ì¥ ì¤‘..."]}):e.jsxs(e.Fragment,{children:[e.jsx(cs,{className:"h-3 w-3 mr-1"}),"Dashboardì— ì €ì¥"]})})]})]}),e.jsx(bs,{className:"h-96",children:e.jsx("div",{className:"space-y-4",children:(M=p.analysis_results)==null?void 0:M.map((C,K)=>{var H,V;return e.jsx(re,{className:`border-l-4 border-l-blue-500 ${j.has(C.peg_name)?"ring-2 ring-blue-500 bg-blue-50":""}`,children:e.jsxs(ne,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:j.has(C.peg_name),onChange:()=>b(C.peg_name),className:"w-4 h-4 text-blue-600 rounded"}),e.jsx("h4",{className:"font-semibold",children:C.peg_name})]}),ie(C.improvement_status,C.improvement_magnitude)]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"ê¸°ê°„ 1 í‰ê· "}),e.jsx("div",{className:"font-medium",children:(H=C.period1_stats)==null?void 0:H.mean})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"ê¸°ê°„ 2 í‰ê· "}),e.jsx("div",{className:"font-medium",children:(V=C.period2_stats)==null?void 0:V.mean})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Delta"}),e.jsxs("div",{className:`font-medium ${C.delta>0?"text-green-600":C.delta<0?"text-red-600":"text-blue-600"}`,children:[C.delta>0?"+":"",C.delta]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Delta %"}),e.jsxs("div",{className:`font-medium ${C.delta_percentage>0?"text-green-600":C.delta_percentage<0?"text-red-600":"text-blue-600"}`,children:[C.delta_percentage>0?"+":"",C.delta_percentage,"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-3 pt-3 border-t text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"ê¸°ê°„ 1 RSD"}),e.jsxs("div",{className:"font-medium",children:[C.rsd_period1,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"ê¸°ê°„ 2 RSD"}),e.jsxs("div",{className:"font-medium",children:[C.rsd_period2,"%"]})]})]})]})},K)})})})]}),e.jsx(_e,{value:"chart",children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(ts,{comparisonResults:p,title:"ë§‰ëŒ€ ì°¨íŠ¸",showControls:!1,defaultChartType:"bar",height:300}),e.jsx(ts,{comparisonResults:p,title:"ë¼ì¸ ì°¨íŠ¸",showControls:!1,defaultChartType:"line",height:300}),e.jsx(ts,{comparisonResults:p,title:"ê°œì„  ìƒíƒœ ë¶„í¬",showControls:!1,defaultChartType:"pie",height:300}),e.jsx(ts,{comparisonResults:p,title:"ë ˆì´ë” ì°¨íŠ¸",showControls:!1,defaultChartType:"radar",height:300})]})})})]})})]})]})]}),!p&&!_&&e.jsx(re,{className:"text-center py-12",children:e.jsxs(ne,{children:[e.jsx(Oe,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"ë¹„êµ ë¶„ì„ ì¤€ë¹„"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"ë‘ ê¸°ê°„ê³¼ ë¶„ì„í•  PEGë¥¼ ì„ íƒí•œ í›„ 'ë¹„êµ ë¶„ì„ ì‹¤í–‰' ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”"}),e.jsx(Z,{variant:"outline",children:q?"ë¶„ì„ ì¤€ë¹„ ì™„ë£Œ":"ì„¤ì • í•„ìš”"})]})})]})},cn=Object.freeze(Object.defineProperty({__proto__:null,default:zt},Symbol.toStringTag,{value:"Module"})),Ft=()=>{const{settings:s}=$t(),t=s.defaultDateRange||7,a=s.defaultNe||"",n=s.defaultCellId||"",i=s.decimalPlaces||2,g=s.showComparisonOptions!==!1,h=s.autoCalculateStats!==!1;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold",children:"Statistics"}),e.jsxs("p",{className:"text-muted-foreground",children:["ê¸°ë³¸ ë‚ ì§œ ë²”ìœ„: ",t,"ì¼ â€¢ ì†Œìˆ˜ì : ",i,"ìë¦¬",a&&` â€¢ ê¸°ë³¸ NE: ${a}`,n&&` â€¢ ê¸°ë³¸ Cell: ${n}`]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[h&&e.jsxs(Z,{variant:"outline",className:"text-xs",children:[e.jsx(gs,{className:"h-3 w-3 mr-1"}),"ìë™ í†µê³„ ê³„ì‚°"]}),g&&e.jsxs(Z,{variant:"outline",className:"text-xs",children:[e.jsx(Oe,{className:"h-3 w-3 mr-1"}),"ë¹„êµ ì˜µì…˜ í™œì„±"]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(Z,{variant:"default",children:["ê¸°ë³¸ ê¸°ê°„: ",t,"ì¼"]}),e.jsxs(Z,{variant:"outline",children:["ì†Œìˆ˜ì : ",i,"ìë¦¬"]}),h&&e.jsx(Z,{variant:"secondary",children:"ìë™ í†µê³„ ê³„ì‚°"}),g&&e.jsx(Z,{variant:"secondary",children:"ë¹„êµ ì˜µì…˜"})]}),e.jsxs(ws,{defaultValue:"basic",className:"w-full",children:[e.jsxs(Ss,{className:"grid w-full grid-cols-2",children:[e.jsx(De,{value:"basic",children:"Basic Analysis"}),e.jsx(De,{value:"advanced",children:"Advanced Analysis"})]}),e.jsx(_e,{value:"basic",className:"space-y-6",children:e.jsx(zt,{})}),e.jsx(_e,{value:"advanced",className:"space-y-6",children:e.jsx(Vs,{})})]})]})},Gt=Object.freeze(Object.defineProperty({__proto__:null,default:Ft},Symbol.toStringTag,{value:"Module"}));function Bt({...s}){return e.jsx(Ga,{"data-slot":"collapsible",...s})}function Vt({...s}){return e.jsx(Ba,{"data-slot":"collapsible-trigger",...s})}function Ut({...s}){return e.jsx(Va,{"data-slot":"collapsible-content",...s})}const on=Rs("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function Kt({className:s,variant:t,...a}){return e.jsx("div",{"data-slot":"alert",role:"alert",className:te(on({variant:t}),s),...a})}function Ht({className:s,...t}){return e.jsx("div",{"data-slot":"alert-description",className:te("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",s),...t})}const is={text:{placeholder:"í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”",maxLength:100},number:{placeholder:"ìˆ«ìë¥¼ ì…ë ¥í•˜ì„¸ìš”",min:0,max:999999},select:{placeholder:"ì„ íƒí•˜ì„¸ìš”",options:[]},multiselect:{placeholder:"í•˜ë‚˜ ì´ìƒ ì„ íƒí•˜ì„¸ìš”",options:[]},checkbox:{label:"í™œì„±í™”"},switch:{label:"ì¼œê¸°/ë„ê¸°"}},dn=({field:s,value:t,onChange:a,error:n,disabled:i})=>{var g,h,o,u;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(W,{htmlFor:s.key,className:"text-sm font-medium",children:[s.label,s.required&&e.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),e.jsx(ve,{id:s.key,type:s.type==="number"?"number":"text",value:t||"",onChange:d=>{const f=s.type==="number"?d.target.value===""?"":Number(d.target.value):d.target.value;a(f)},placeholder:s.placeholder||((g=is[s.type])==null?void 0:g.placeholder),maxLength:s.maxLength||((h=is[s.type])==null?void 0:h.maxLength),min:s.min||((o=is[s.type])==null?void 0:o.min),max:s.max||((u=is[s.type])==null?void 0:u.max),disabled:i,className:n?"border-destructive":""}),s.description&&e.jsx("p",{className:"text-xs text-muted-foreground",children:s.description}),n&&e.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[e.jsx(Ce,{className:"h-3 w-3"}),n]})]})},mn=({field:s,value:t,onChange:a,error:n,disabled:i})=>{var g;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(W,{htmlFor:s.key,className:"text-sm font-medium",children:[s.label,s.required&&e.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),e.jsxs(Ee,{value:t||"",onValueChange:a,disabled:i,children:[e.jsx($e,{className:n?"border-destructive":"",children:e.jsx(Pe,{placeholder:s.placeholder||is.select.placeholder})}),e.jsx(Ae,{children:(g=s.options)==null?void 0:g.map(h=>e.jsx(le,{value:h.value,children:h.label},h.value))})]}),s.description&&e.jsx("p",{className:"text-xs text-muted-foreground",children:s.description}),n&&e.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[e.jsx(Ce,{className:"h-3 w-3"}),n]})]})},un=({field:s,value:t,onChange:a,error:n,disabled:i})=>{var o,u;const g=Array.isArray(t)?t:[],h=d=>{const f=g.includes(d)?g.filter(P=>P!==d):[...g,d];a(f)};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(W,{className:"text-sm font-medium",children:[s.label,s.required&&e.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),e.jsxs("div",{className:`border rounded-md p-3 space-y-2 ${n?"border-destructive":"border-input"}`,children:[(o=s.options)==null?void 0:o.map(d=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ns,{id:`${s.key}-${d.value}`,checked:g.includes(d.value),onCheckedChange:()=>h(d.value),disabled:i}),e.jsx(W,{htmlFor:`${s.key}-${d.value}`,className:"text-sm cursor-pointer",children:d.label})]},d.value)),((u=s.options)==null?void 0:u.length)===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"ì„ íƒ ê°€ëŠ¥í•œ ì˜µì…˜ì´ ì—†ìŠµë‹ˆë‹¤"})]}),g.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:g.map(d=>{var P;const f=(P=s.options)==null?void 0:P.find(l=>l.value===d);return f?e.jsx(Z,{variant:"secondary",className:"text-xs",children:f.label},d):null})}),s.description&&e.jsx("p",{className:"text-xs text-muted-foreground",children:s.description}),n&&e.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[e.jsx(Ce,{className:"h-3 w-3"}),n]})]})},hn=({field:s,value:t,onChange:a,error:n,disabled:i})=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs(W,{htmlFor:s.key,className:"text-sm font-medium",children:[s.label,s.required&&e.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),s.description&&e.jsx("p",{className:"text-xs text-muted-foreground",children:s.description})]}),e.jsx(rs,{id:s.key,checked:!!t,onCheckedChange:a,disabled:i})]}),n&&e.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[e.jsx(Ce,{className:"h-3 w-3"}),n]})]}),As=({title:s,description:t,settingKey:a,fields:n=[],defaultOpen:i=!1,disabled:g=!1,className:h="",onFieldChange:o,showSaveButton:u=!1,showResetButton:d=!1})=>{const[f,P]=r.useState(i),[l,p]=r.useState(!1),{settings:y,updateSettings:v,updateSectionLocal:k,saving:_,error:c,validationErrors:D,logInfo:A,saveImmediately:j,defaultSettings:$}=Ye(),G=y[a]||{},w=r.useMemo(()=>{const T={};return Object.entries(D).forEach(([q,se])=>{if(q.startsWith(`${a}.`)){const ie=q.replace(`${a}.`,"");T[ie]=se}}),T},[D,a]),E=Object.keys(w).length>0,m=r.useCallback((T,q)=>{A(`SettingBox í•„ë“œ ë³€ê²½: ${a}.${T}`,{oldValue:G[T],newValue:q});const se={...G,[T]:q};u?k(a,se):v({[a]:se}),o==null||o(T,q,se),p(!0)},[a,G,v,o,A]),x=r.useCallback(async()=>{A(`SettingBox ì¦‰ì‹œ ì €ì¥: ${a}`),await j()},[j,A,a]),b=r.useCallback(()=>{A(`SettingBox ì´ˆê¸°í™”: ${a}`);const T=$[a]||{};v({[a]:T}),p(!1)},[a,v,$,A]),F=r.useCallback(T=>{const q=G[T.key],se=l?w[T.key]:null,O={field:T,value:q,onChange:R=>m(T.key,R),error:se,disabled:g||_};switch(T.type){case"text":case"number":return e.jsx(dn,{...O},T.key);case"select":return e.jsx(mn,{...O},T.key);case"multiselect":return e.jsx(un,{...O},T.key);case"switch":case"checkbox":return e.jsx(hn,{...O},T.key);default:return e.jsxs("div",{className:"text-sm text-muted-foreground",children:["ì§€ì›í•˜ì§€ ì•ŠëŠ” í•„ë“œ íƒ€ì…: ",T.type]},T.key)}},[G,w,l,g,_,m]);return e.jsx(re,{className:`w-full ${h}`,children:e.jsxs(Bt,{open:f,onOpenChange:P,children:[e.jsx(Vt,{asChild:!0,children:e.jsx(he,{className:"cursor-pointer hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(xe,{className:"text-lg flex items-center gap-2",children:[s,_&&e.jsxs(Z,{variant:"secondary",className:"text-xs",children:[e.jsx(Be,{className:"h-3 w-3 mr-1"}),"ì €ì¥ ì¤‘"]}),l&&E&&e.jsxs(Z,{variant:"destructive",className:"text-xs",children:[e.jsx(Ce,{className:"h-3 w-3 mr-1"}),"ì˜¤ë¥˜"]}),l&&!E&&!_&&e.jsxs(Z,{variant:"default",className:"text-xs",children:[e.jsx(Fe,{className:"h-3 w-3 mr-1"}),"ìœ íš¨"]})]}),t&&e.jsx(Ns,{children:t})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Z,{variant:"outline",className:"text-xs",children:[n.length,"ê°œ ì„¤ì •"]}),f?e.jsx(ys,{className:"h-4 w-4"}):e.jsx(Xe,{className:"h-4 w-4"})]})]})})}),e.jsx(Ut,{children:e.jsxs(ne,{className:"space-y-6",children:[c&&e.jsxs(Kt,{variant:"destructive",children:[e.jsx(Ce,{className:"h-4 w-4"}),e.jsx(Ht,{children:c})]}),n.length>0?e.jsx("div",{className:"space-y-4",children:n.map(F)}):e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"ì„¤ì •í•  ìˆ˜ ìˆëŠ” í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤."}),(u||d||E)&&e.jsxs(e.Fragment,{children:[e.jsx(xs,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:d&&e.jsxs(J,{variant:"outline",size:"sm",onClick:b,disabled:g||_,children:[e.jsx(Ls,{className:"h-4 w-4 mr-1"}),"ì´ˆê¸°í™”"]})}),e.jsx("div",{className:"flex items-center gap-2",children:u&&e.jsxs(J,{size:"sm",onClick:x,disabled:g||_||E,children:[e.jsx(nr,{className:"h-4 w-4 mr-1"}),"ì €ì¥"]})})]})]})]})})]})})};function xn({className:s,value:t,...a}){return e.jsx(Ua,{"data-slot":"progress",className:te("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",s),...a,children:e.jsx(Ka,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})})}const ps=[{key:"dashboardSettings",label:"Dashboard ì„¤ì •",description:"ì„ íƒëœ PEG, ì°¨íŠ¸ ìŠ¤íƒ€ì¼, ìƒˆë¡œê³ ì¹¨ ê°„ê²© ë“±"},{key:"statisticsSettings",label:"Statistics ì„¤ì •",description:"ê¸°ë³¸ ë‚ ì§œ ë²”ìœ„, ë¹„êµ ì˜µì…˜, ì†Œìˆ˜ì  ìë¦¿ìˆ˜ ë“±"},{key:"derivedPegSettings",label:"Derived PEG ì„¤ì •",description:"ì‚¬ìš©ì ì •ì˜ ìˆ˜ì‹, í™œì„±í™” ìƒíƒœ, ê³„ì‚° ì •ë°€ë„ ë“±"},{key:"notificationSettings",label:"ì•Œë¦¼ ì„¤ì •",description:"í† ìŠ¤íŠ¸, ì‚¬ìš´ë“œ, ì•Œë¦¼ íƒ€ì… ì„¤ì •"},{key:"generalSettings",label:"ì¼ë°˜ ì„¤ì •",description:"ì–¸ì–´, ì‹œê°„ëŒ€, ë‚ ì§œ í˜•ì‹ ë“±"}],gn=({title:s="ì„¤ì • ë°±ì—… & ë³µì›",description:t="ì„¤ì •ì„ JSON íŒŒì¼ë¡œ ë‚´ë³´ë‚´ê±°ë‚˜ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤",defaultOpen:a=!1,className:n=""})=>{const[i,g]=r.useState(a),[h,o]=r.useState(!1),[u,d]=r.useState(!1),[f,P]=r.useState(0),[l,p]=r.useState(!1),[y,v]=r.useState(null),[k,_]=r.useState(null),[c,D]=r.useState(ps.reduce((S,M)=>({...S,[M.key]:!0}),{})),[A,j]=r.useState(""),$=r.useRef(null),{settings:G,exportSettings:w,importSettings:E,hasUnsavedChanges:m,saving:x,logInfo:b,logError:F}=Ye(),T=r.useCallback(async(S="full")=>{d(!0),v(null);try{b("ì„¤ì • ë‚´ë³´ë‚´ê¸° ì‹œì‘",{exportType:S,customFileName:A});let M=G;if(S==="partial"){const V=Object.entries(c).filter(([Y,de])=>de).map(([Y])=>Y);if(V.length===0){Q.error("ë‚´ë³´ë‚¼ ì„¤ì • ì„¹ì…˜ì„ í•˜ë‚˜ ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”");return}M=V.reduce((Y,de)=>(G[de]&&(Y[de]=G[de]),Y),{}),b("ë¶€ë¶„ ë‚´ë³´ë‚´ê¸° ì„ íƒëœ ì„¹ì…˜",V)}const C=new Date().toISOString().split("T")[0],K=A.trim()||(S==="partial"?`preference-settings-partial-${C}.json`:`preference-settings-${C}.json`);await w(K,M)&&(Q.success(`ì„¤ì •ì´ "${K}" íŒŒì¼ë¡œ ë‚´ë³´ë‚´ì¡ŒìŠµë‹ˆë‹¤`),j(""))}catch(M){F("ì„¤ì • ë‚´ë³´ë‚´ê¸° ì‹¤íŒ¨",M),Q.error("ì„¤ì • ë‚´ë³´ë‚´ê¸° ì‹¤íŒ¨: "+M.message)}finally{d(!1)}},[G,c,A,w,b,F]),q=r.useCallback(async S=>{if(S){o(!0),P(0),v(null);try{if(b("ì„¤ì • ê°€ì ¸ì˜¤ê¸° ì‹œì‘",{fileName:S.name,fileSize:S.size}),!S.name.toLowerCase().endsWith(".json"))throw new Error("JSON íŒŒì¼ë§Œ ì§€ì›ë©ë‹ˆë‹¤");if(S.size>5*1024*1024)throw new Error("íŒŒì¼ í¬ê¸°ê°€ ë„ˆë¬´ í½ë‹ˆë‹¤ (ìµœëŒ€ 5MB)");P(20);const M=await E(S);P(80),_({name:S.name,size:S.size,importedAt:new Date,sectionsCount:Object.keys(M).length}),P(100),b("ì„¤ì • ê°€ì ¸ì˜¤ê¸° ì™„ë£Œ",{fileName:S.name,sectionsImported:Object.keys(M).length}),Q.success(`"${S.name}"ì—ì„œ ì„¤ì •ì„ ì„±ê³µì ìœ¼ë¡œ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤`)}catch(M){F("ì„¤ì • ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨",M),v(M.message),Q.error("ì„¤ì • ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨: "+M.message)}finally{o(!1),setTimeout(()=>{P(0)},3e3)}}},[E,b,F]),se=r.useCallback(S=>{const M=S.target.files[0];M&&(q(M),S.target.value="")},[q]),ie=r.useCallback(S=>{S.preventDefault(),p(!0)},[]),O=r.useCallback(S=>{S.preventDefault(),p(!1)},[]),R=r.useCallback(S=>{S.preventDefault(),p(!1);const M=S.dataTransfer.files;M.length>0&&q(M[0])},[q]),U=r.useCallback(S=>{D(M=>({...M,[S]:!M[S]}))},[]),B=r.useCallback(()=>{const S=Object.values(c).every(Boolean),M=ps.reduce((C,K)=>({...C,[K.key]:!S}),{});D(M)},[c]);return e.jsx(re,{className:`w-full ${n}`,children:e.jsxs(Bt,{open:i,onOpenChange:g,children:[e.jsx(Vt,{asChild:!0,children:e.jsx(he,{className:"cursor-pointer hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(xe,{className:"text-lg flex items-center gap-2",children:[e.jsx(lr,{className:"h-5 w-5"}),s,h&&e.jsxs(Z,{variant:"secondary",className:"text-xs",children:[e.jsx(Be,{className:"h-3 w-3 mr-1"}),"ê°€ì ¸ì˜¤ëŠ” ì¤‘"]}),u&&e.jsxs(Z,{variant:"secondary",className:"text-xs",children:[e.jsx(Be,{className:"h-3 w-3 mr-1"}),"ë‚´ë³´ë‚´ëŠ” ì¤‘"]}),m&&e.jsxs(Z,{variant:"outline",className:"text-xs",children:[e.jsx(Ce,{className:"h-3 w-3 mr-1"}),"ì €ì¥ë˜ì§€ ì•Šì€ ë³€ê²½ì‚¬í•­"]})]}),t&&e.jsx(Ns,{children:t})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[k&&e.jsxs(Z,{variant:"default",className:"text-xs",children:[e.jsx(Fe,{className:"h-3 w-3 mr-1"}),"ê°€ì ¸ì˜´"]}),i?e.jsx(ys,{className:"h-4 w-4"}):e.jsx(Xe,{className:"h-4 w-4"})]})]})})}),e.jsx(Ut,{children:e.jsxs(ne,{className:"space-y-6",children:[y&&e.jsxs(Kt,{variant:"destructive",children:[e.jsx(Ce,{className:"h-4 w-4"}),e.jsx(Ht,{children:y})]}),h&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"íŒŒì¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘..."}),e.jsxs("span",{children:[f,"%"]})]}),e.jsx(xn,{value:f,className:"h-2"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[e.jsx(ir,{className:"h-4 w-4"}),"ì„¤ì • ê°€ì ¸ì˜¤ê¸°"]}),e.jsx("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${l?"border-primary bg-primary/5":h?"border-muted bg-muted/20":"border-muted-foreground/25 hover:border-muted-foreground/50"}`,onDragOver:ie,onDragLeave:O,onDrop:R,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(cr,{className:`h-8 w-8 mx-auto ${l?"text-primary":"text-muted-foreground"}`}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:`text-sm font-medium ${l?"text-primary":""}`,children:l?"íŒŒì¼ì„ ì—¬ê¸°ì— ë†“ìœ¼ì„¸ìš”":"JSON íŒŒì¼ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì„ íƒí•˜ì„¸ìš”"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"ìµœëŒ€ 5MB, .json íŒŒì¼ë§Œ ì§€ì›"})]}),e.jsxs(J,{variant:"outline",size:"sm",onClick:()=>{var S;return(S=$.current)==null?void 0:S.click()},disabled:h,className:"mt-2",children:[e.jsx(or,{className:"h-4 w-4 mr-2"}),"íŒŒì¼ ì„ íƒ"]})]})}),e.jsx("input",{ref:$,type:"file",accept:".json",onChange:se,style:{display:"none"}}),k&&e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Fe,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"font-medium",children:"ë§ˆì§€ë§‰ ê°€ì ¸ì˜¨ íŒŒì¼:"}),e.jsx("span",{children:k.name}),e.jsxs(Z,{variant:"secondary",className:"text-xs",children:[k.sectionsCount,"ê°œ ì„¹ì…˜"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:k.importedAt.toLocaleString()})]})]}),e.jsx(xs,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[e.jsx(cs,{className:"h-4 w-4"}),"ì„¤ì • ë‚´ë³´ë‚´ê¸°"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{htmlFor:"fileName",className:"text-sm",children:"íŒŒì¼ëª… (ì„ íƒì‚¬í•­)"}),e.jsx(ve,{id:"fileName",value:A,onChange:S=>j(S.target.value),placeholder:"preference-settings-custom.json",disabled:u}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"ë¹„ì›Œë‘ë©´ ìë™ìœ¼ë¡œ ë‚ ì§œê°€ í¬í•¨ëœ íŒŒì¼ëª…ì´ ìƒì„±ë©ë‹ˆë‹¤"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(W,{className:"text-sm font-medium",children:"ë‚´ë³´ë‚¼ ì„¤ì • ì„ íƒ"}),e.jsx(J,{variant:"outline",size:"sm",onClick:B,disabled:u,children:Object.values(c).every(Boolean)?"ì „ì²´ í•´ì œ":"ì „ì²´ ì„ íƒ"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:ps.map(S=>e.jsxs("div",{className:"flex items-start space-x-2 p-2 rounded border",children:[e.jsx(ns,{id:S.key,checked:c[S.key],onCheckedChange:()=>U(S.key),disabled:u}),e.jsxs("div",{className:"grid gap-1.5 leading-none",children:[e.jsx(W,{htmlFor:S.key,className:"text-sm font-medium cursor-pointer",children:S.label}),e.jsx("p",{className:"text-xs text-muted-foreground",children:S.description})]})]},S.key))})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs(J,{onClick:()=>T("full"),disabled:u||x,className:"flex-1",children:[e.jsx(cs,{className:"h-4 w-4 mr-2"}),"ì „ì²´ ì„¤ì • ë‚´ë³´ë‚´ê¸°"]}),e.jsxs(J,{variant:"outline",onClick:()=>T("partial"),disabled:u||x||Object.values(c).every(S=>!S),className:"flex-1",children:[e.jsx(cs,{className:"h-4 w-4 mr-2"}),"ì„ íƒëœ ì„¤ì •ë§Œ ë‚´ë³´ë‚´ê¸°"]})]}),Object.values(c).every(S=>!S)&&e.jsx("p",{className:"text-xs text-destructive",children:"ë‚´ë³´ë‚¼ ì„¤ì • ì„¹ì…˜ì„ í•˜ë‚˜ ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”"})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3",children:[e.jsx("h5",{className:"text-sm font-medium mb-2",children:"í˜„ì¬ ì„¤ì • ìƒíƒœ"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 text-xs",children:ps.map(S=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[S.label,":"]}),e.jsx("span",{className:"text-muted-foreground",children:G[S.key]?"ì„¤ì •ë¨":"ê¸°ë³¸ê°’"})]},S.key))}),m&&e.jsxs("p",{className:"text-xs text-amber-600 mt-2 flex items-center gap-1",children:[e.jsx(Ce,{className:"h-3 w-3"}),"ì €ì¥ë˜ì§€ ì•Šì€ ë³€ê²½ì‚¬í•­ì´ ìˆìŠµë‹ˆë‹¤"]})]})]})})]})})};function fn({className:s,...t}){return e.jsx("textarea",{"data-slot":"textarea",className:te("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),...t})}const pn=({derivedPegSettings:s,updateDerivedPegSettings:t,availablePegs:a=[],saving:n=!1})=>{var E;const[i,g]=r.useState(null),[h,o]=r.useState(null),[u,d]=r.useState(""),[f,P]=r.useState(null),[l,p]=r.useState(null),y=(s==null?void 0:s.formulas)||[],v=(s==null?void 0:s.settings)||{autoValidate:!0,showInDashboard:!0,showInStatistics:!0,evaluationPrecision:4},k=[{id:"success_rate",name:"Success Rate (%)",formula:"(success_count / total_count) * 100",description:"ì„±ê³µë¥  ê³„ì‚° í…œí”Œë¦¿",category:"percentage"},{id:"efficiency",name:"Efficiency (%)",formula:"(good_values / all_values) * 100",description:"íš¨ìœ¨ì„± ê³„ì‚° í…œí”Œë¦¿",category:"percentage"},{id:"delta",name:"Delta Calculation",formula:"current_value - previous_value",description:"ë³€í™”ëŸ‰ ê³„ì‚° í…œí”Œë¦¿",category:"difference"},{id:"ratio",name:"Simple Ratio",formula:"numerator / denominator",description:"ë‹¨ìˆœ ë¹„ìœ¨ ê³„ì‚° í…œí”Œë¦¿",category:"ratio"}],_=[{symbol:"+",name:"ë”í•˜ê¸°",example:"a + b"},{symbol:"-",name:"ë¹¼ê¸°",example:"a - b"},{symbol:"*",name:"ê³±í•˜ê¸°",example:"a * b"},{symbol:"/",name:"ë‚˜ëˆ„ê¸°",example:"a / b"},{symbol:"%",name:"ë‚˜ë¨¸ì§€",example:"a % b"},{symbol:"^",name:"ê±°ë“­ì œê³±",example:"a ^ 2"},{symbol:"()",name:"ê´„í˜¸",example:"(a + b) * c"},{symbol:"sqrt()",name:"ì œê³±ê·¼",example:"sqrt(a)"},{symbol:"log()",name:"ë¡œê·¸",example:"log(a)"},{symbol:"abs()",name:"ì ˆëŒ“ê°’",example:"abs(a)"},{symbol:"min()",name:"ìµœì†Ÿê°’",example:"min(a, b)"},{symbol:"max()",name:"ìµœëŒ“ê°’",example:"max(a, b)"}],c=r.useMemo(()=>u?y.filter(m=>{var x;return m.name.toLowerCase().includes(u.toLowerCase())||m.formula.toLowerCase().includes(u.toLowerCase())||((x=m.description)==null?void 0:x.toLowerCase().includes(u.toLowerCase()))}):y,[y,u]),D=r.useCallback(m=>{try{const x=[],b=[],F=(m.match(/\(/g)||[]).length,T=(m.match(/\)/g)||[]).length;F!==T&&x.push("ê´„í˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤");const q=m.replace(/\$\{[^}]+\}/g," ").match(/[a-zA-Z_][a-zA-Z0-9_]*/g)||[],se=[...a.map(B=>B.value),...y.filter(B=>B.active).map(B=>B.name.replace(/[^a-zA-Z0-9_]/g,"_").toLowerCase())],ie=q.filter(B=>!se.includes(B)&&!["sqrt","log","abs","min","max","if"].includes(B));if(ie.length>0&&b.push(`ì•Œ ìˆ˜ ì—†ëŠ” PEG: ${ie.join(", ")}`),h){const B=h.name.replace(/[^a-zA-Z0-9_]/g,"_").toLowerCase();q.includes(B)&&x.push("ìˆ˜ì‹ì´ ìê¸° ìì‹ ì„ ì°¸ì¡°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤ (ìˆœí™˜ ì°¸ì¡°)")}const O=m.replace(/\$\{[^}]+\}/g,"").match(/[^a-zA-Z0-9_+\-*/()^%.,\s]/g);O&&x.push(`ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¬¸ì: ${O.join(", ")}`);const R=q.filter(B=>a.some(S=>S.value===B)),U=q.filter(B=>y.some(S=>S.active&&S.name.replace(/[^a-zA-Z0-9_]/g,"_").toLowerCase()===B));return{isValid:x.length===0,errors:x,warnings:b,dependencies:R,derivedDependencies:U}}catch{return{isValid:!1,errors:["ìˆ˜ì‹ ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤"],warnings:[],dependencies:[],derivedDependencies:[]}}},[a,y,h]),A=r.useCallback(m=>{try{const x={};a.forEach(T=>{x[T.value]=Math.random()*100+50});let b=m;Object.keys(x).forEach(T=>{const q=new RegExp(`\\b${T}\\b`,"g");b=b.replace(q,x[T].toString())}),b=b.replace(/sqrt\(([^)]+)\)/g,"Math.sqrt($1)"),b=b.replace(/log\(([^)]+)\)/g,"Math.log($1)"),b=b.replace(/abs\(([^)]+)\)/g,"Math.abs($1)"),b=b.replace(/\^/g,"**");const F=Function(`"use strict"; return (${b})`)();return{success:!0,result:Number(F).toFixed(v.evaluationPrecision||4),mockData:x}}catch(x){return{success:!1,error:x.message}}},[a,v.evaluationPrecision]),j=()=>{const m={id:`formula_${Date.now()}`,name:"ìƒˆ ìˆ˜ì‹",formula:"",description:"",active:!0,category:"custom",unit:"",dependencies:[],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};o(m),g(m.id)},$=()=>{if(!h)return;const m=D(h.formula);if(!m.isValid){Q.error(`ìˆ˜ì‹ ì €ì¥ ì‹¤íŒ¨: ${m.errors.join(", ")}`);return}const x={...h,dependencies:m.dependencies,derivedDependencies:m.derivedDependencies||[],updatedAt:new Date().toISOString()},b=y.findIndex(T=>T.id===h.id);let F;b>=0?(F=[...y],F[b]=x):F=[...y,x],t({...s,formulas:F}),o(null),Q.success("ìˆ˜ì‹ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤")},G=m=>{const x=y.filter(b=>b.id!==m);t({...s,formulas:x}),i===m&&g(null),(h==null?void 0:h.id)===m&&o(null),Q.success("ìˆ˜ì‹ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤")},w=m=>{h&&(o({...h,formula:m.formula,description:m.description,category:m.category}),Q.success(`í…œí”Œë¦¿ "${m.name}"ì´ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤`))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(re,{children:[e.jsx(he,{children:e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"h-5 w-5"}),"Derived PEG ê´€ë¦¬"]})}),e.jsx(ne,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(rs,{id:"auto-validate",checked:v.autoValidate,onCheckedChange:m=>t({...s,settings:{...v,autoValidate:m}})}),e.jsx(W,{htmlFor:"auto-validate",children:"ì‹¤ì‹œê°„ ê²€ì¦"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(rs,{id:"show-dashboard",checked:v.showInDashboard,onCheckedChange:m=>t({...s,settings:{...v,showInDashboard:m}})}),e.jsx(W,{htmlFor:"show-dashboard",children:"Dashboardì— í‘œì‹œ"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(rs,{id:"show-statistics",checked:v.showInStatistics,onCheckedChange:m=>t({...s,settings:{...v,showInStatistics:m}})}),e.jsx(W,{htmlFor:"show-statistics",children:"Statisticsì— í‘œì‹œ"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{children:"ê³„ì‚° ì •ë°€ë„"}),e.jsxs(Ee,{value:(E=v.evaluationPrecision)==null?void 0:E.toString(),onValueChange:m=>t({...s,settings:{...v,evaluationPrecision:parseInt(m)}}),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Ae,{children:[e.jsx(le,{value:"2",children:"ì†Œìˆ˜ì  2ìë¦¬"}),e.jsx(le,{value:"4",children:"ì†Œìˆ˜ì  4ìë¦¬"}),e.jsx(le,{value:"6",children:"ì†Œìˆ˜ì  6ìë¦¬"})]})]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(re,{children:[e.jsxs(he,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(xe,{children:"ìˆ˜ì‹ ëª©ë¡"}),e.jsxs(J,{onClick:j,size:"sm",children:[e.jsx(dr,{className:"h-4 w-4 mr-2"}),"ìƒˆ ìˆ˜ì‹"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(js,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ve,{placeholder:"ìˆ˜ì‹ ê²€ìƒ‰...",className:"pl-8",value:u,onChange:m=>d(m.target.value)})]})]}),e.jsx(ne,{children:e.jsx(bs,{className:"h-96",children:e.jsx("div",{className:"space-y-2",children:c.map(m=>e.jsx("div",{className:`p-3 border rounded-lg cursor-pointer transition-colors ${i===m.id?"bg-blue-50 border-blue-200":"hover:bg-gray-50"}`,onClick:()=>g(m.id),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-sm truncate",children:m.name}),e.jsx(Z,{variant:m.active?"default":"secondary",className:"text-xs",children:m.active?"í™œì„±":"ë¹„í™œì„±"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 font-mono",children:m.formula}),m.description&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:m.description}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(Z,{variant:"outline",className:"text-xs",children:m.category}),m.unit&&e.jsx(Z,{variant:"outline",className:"text-xs",children:m.unit})]})]}),e.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[e.jsx(J,{variant:"ghost",size:"sm",onClick:x=>{x.stopPropagation(),o({...m})},children:e.jsx(Ks,{className:"h-3 w-3"})}),e.jsx(J,{variant:"ghost",size:"sm",onClick:x=>{x.stopPropagation(),G(m.id)},children:e.jsx(Ts,{className:"h-3 w-3"})})]})]})},m.id))})})})]}),e.jsxs(re,{children:[e.jsx(he,{children:e.jsx(xe,{children:h?"ìˆ˜ì‹ í¸ì§‘":"ìˆ˜ì‹ ìƒì„¸"})}),e.jsx(ne,{children:h?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{htmlFor:"formula-name",children:"ìˆ˜ì‹ ì´ë¦„"}),e.jsx(ve,{id:"formula-name",value:h.name,onChange:m=>o({...h,name:m.target.value}),placeholder:"ì˜ˆ: RACH Success Rate (%)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{htmlFor:"formula-input",children:"ìˆ˜ì‹"}),e.jsx(fn,{id:"formula-input",value:h.formula,onChange:m=>{o({...h,formula:m.target.value}),v.autoValidate&&P(D(m.target.value))},placeholder:"ì˜ˆ: (randomaccesspremable / randomaccessresponse) * 100",className:"font-mono text-sm",rows:4}),f&&e.jsxs("div",{className:"space-y-2",children:[f.isValid?e.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[e.jsx(Ms,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"ìˆ˜ì‹ì´ ìœ íš¨í•©ë‹ˆë‹¤"})]}):e.jsxs("div",{className:"flex items-center gap-2 text-red-600",children:[e.jsx(Ce,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:f.errors.join(", ")})]}),f.warnings.length>0&&e.jsxs("div",{className:"flex items-center gap-2 text-amber-600",children:[e.jsx(Ce,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:f.warnings.join(", ")})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{htmlFor:"formula-description",children:"ì„¤ëª…"}),e.jsx(ve,{id:"formula-description",value:h.description,onChange:m=>o({...h,description:m.target.value}),placeholder:"ìˆ˜ì‹ì— ëŒ€í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{htmlFor:"formula-category",children:"ì¹´í…Œê³ ë¦¬"}),e.jsxs(Ee,{value:h.category,onValueChange:m=>o({...h,category:m}),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Ae,{children:[e.jsx(le,{value:"percentage",children:"ë¹„ìœ¨ (%)"}),e.jsx(le,{value:"success_rate",children:"ì„±ê³µë¥ "}),e.jsx(le,{value:"efficiency",children:"íš¨ìœ¨ì„±"}),e.jsx(le,{value:"quality",children:"í’ˆì§ˆ"}),e.jsx(le,{value:"performance",children:"ì„±ëŠ¥"}),e.jsx(le,{value:"custom",children:"ì‚¬ìš©ì ì •ì˜"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{htmlFor:"formula-unit",children:"ë‹¨ìœ„"}),e.jsx(ve,{id:"formula-unit",value:h.unit,onChange:m=>o({...h,unit:m.target.value}),placeholder:"ì˜ˆ: %, ms, Mbps"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(rs,{id:"formula-active",checked:h.active,onCheckedChange:m=>o({...h,active:m})}),e.jsx(W,{htmlFor:"formula-active",children:"ìˆ˜ì‹ í™œì„±í™”"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(J,{onClick:()=>{const m=D(h.formula);P(m);const x=A(h.formula);p(x)},children:[e.jsx(zs,{className:"h-4 w-4 mr-2"}),"í…ŒìŠ¤íŠ¸"]}),e.jsxs(J,{onClick:$,disabled:n,children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),"ì €ì¥"]}),e.jsxs(J,{variant:"outline",onClick:()=>o(null),children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"ì·¨ì†Œ"]})]}),l&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(xs,{}),e.jsx("h4",{className:"font-medium",children:"í…ŒìŠ¤íŠ¸ ê²°ê³¼"}),l.success?e.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx("p",{className:"text-sm text-green-700",children:e.jsxs("strong",{children:["ê²°ê³¼: ",l.result]})}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"ëª¨ì˜ ë°ì´í„°ë¥¼ ì‚¬ìš©í•œ ê³„ì‚° ê²°ê³¼ì…ë‹ˆë‹¤"})]}):e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-red-700",children:["ì˜¤ë¥˜: ",l.error]})})]})]}):i?e.jsx("div",{className:"space-y-4",children:(()=>{const m=y.find(x=>x.id===i);return m?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:m.name}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:m.description})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{children:"ìˆ˜ì‹"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg font-mono text-sm",children:m.formula})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(W,{className:"text-xs",children:"ì¹´í…Œê³ ë¦¬"}),e.jsx("p",{className:"text-sm",children:m.category})]}),e.jsxs("div",{children:[e.jsx(W,{className:"text-xs",children:"ë‹¨ìœ„"}),e.jsx("p",{className:"text-sm",children:m.unit||"ì—†ìŒ"})]})]}),(m.dependencies&&m.dependencies.length>0||m.derivedDependencies&&m.derivedDependencies.length>0)&&e.jsxs("div",{className:"space-y-2",children:[m.dependencies&&m.dependencies.length>0&&e.jsxs("div",{children:[e.jsxs(W,{className:"text-xs flex items-center gap-1",children:[e.jsx(We,{className:"h-3 w-3"}),"ê¸°ë³¸ PEG ì˜ì¡´ì„±"]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:m.dependencies.map(x=>e.jsx(Z,{variant:"outline",className:"text-xs",children:x},x))})]}),m.derivedDependencies&&m.derivedDependencies.length>0&&e.jsxs("div",{children:[e.jsxs(W,{className:"text-xs flex items-center gap-1",children:[e.jsx(Qe,{className:"h-3 w-3"}),"Derived PEG ì˜ì¡´ì„±"]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:m.derivedDependencies.map(x=>e.jsx(Z,{variant:"secondary",className:"text-xs bg-blue-100 text-blue-700",children:x},x))})]})]}),e.jsxs(J,{onClick:()=>o({...m}),className:"w-full",children:[e.jsx(Ks,{className:"h-4 w-4 mr-2"}),"í¸ì§‘"]})]}):e.jsx("p",{children:"ìˆ˜ì‹ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."})})()}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Qe,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"ìˆ˜ì‹ì„ ì„ íƒí•˜ê±°ë‚˜ ìƒˆë¡œ ë§Œë“¤ì–´ë³´ì„¸ìš”"})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(re,{children:[e.jsx(he,{children:e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(mr,{className:"h-5 w-5"}),"í…œí”Œë¦¿ ë¼ì´ë¸ŒëŸ¬ë¦¬"]})}),e.jsx(ne,{children:e.jsx("div",{className:"space-y-2",children:k.map(m=>e.jsx("div",{className:"p-3 border rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>w(m),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm",children:m.name}),e.jsx("p",{className:"text-xs font-mono text-muted-foreground",children:m.formula}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:m.description})]}),e.jsx(J,{variant:"ghost",size:"sm",children:e.jsx(ur,{className:"h-3 w-3"})})]})},m.id))})})]}),e.jsxs(re,{children:[e.jsx(he,{children:e.jsx(xe,{children:"ì§€ì› ì—°ì‚°ì"})}),e.jsx(ne,{children:e.jsx(bs,{className:"h-64",children:e.jsx("div",{className:"space-y-2",children:_.map((m,x)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("code",{className:"font-mono font-medium",children:m.symbol}),e.jsx("span",{className:"text-sm text-muted-foreground ml-2",children:m.name})]}),e.jsx("code",{className:"text-xs text-muted-foreground",children:m.example})]},x))})})})]})]}),e.jsxs(re,{children:[e.jsxs(he,{children:[e.jsx(xe,{children:"ì‚¬ìš© ê°€ëŠ¥í•œ PEG"}),e.jsx(Ns,{children:"ìˆ˜ì‹ì— ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê¸°ë³¸ PEGì™€ ìƒì„±ëœ Derived PEG ëª©ë¡ì…ë‹ˆë‹¤"})]}),e.jsx(ne,{children:e.jsxs("div",{className:"space-y-4",children:[a.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-sm mb-2 flex items-center gap-2",children:[e.jsx(We,{className:"h-4 w-4"}),"ê¸°ë³¸ PEG (",a.length,"ê°œ)"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.map(m=>e.jsx(J,{variant:"outline",size:"sm",onClick:()=>{h&&o({...h,formula:h.formula+m.value})},className:"text-xs",children:m.label||m.value},m.value))})]}),y.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-sm mb-2 flex items-center gap-2",children:[e.jsx(Qe,{className:"h-4 w-4"}),"Derived PEG (",y.filter(m=>m.active).length,"ê°œ)"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:y.filter(m=>m.active).map(m=>e.jsxs(J,{variant:"outline",size:"sm",onClick:()=>{if(h){const x=`${m.name.replace(/[^a-zA-Z0-9_]/g,"_").toLowerCase()}`;o({...h,formula:h.formula+x})}},className:"text-xs bg-blue-50 border-blue-200 hover:bg-blue-100",title:m.description,children:[e.jsx(Qe,{className:"h-3 w-3 mr-1"}),m.name,m.unit&&e.jsxs("span",{className:"ml-1 text-muted-foreground",children:["(",m.unit,")"]})]},m.id))}),y.filter(m=>m.active).length===0&&e.jsxs("div",{className:"text-center py-4 text-muted-foreground",children:[e.jsx(Qe,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"ì•„ì§ ìƒì„±ëœ Derived PEGê°€ ì—†ìŠµë‹ˆë‹¤"}),e.jsx("p",{className:"text-xs",children:"ìƒˆ ìˆ˜ì‹ì„ ì¶”ê°€í•˜ê³  í™œì„±í™”í•˜ë©´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤"})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h5",{className:"font-medium text-sm text-blue-700 mb-1",children:"ğŸ’¡ ì‚¬ìš©ë²•"}),e.jsxs("ul",{className:"text-xs text-blue-600 space-y-1",children:[e.jsx("li",{children:"â€¢ ê¸°ë³¸ PEG: í´ë¦­í•˜ë©´ ìˆ˜ì‹ì— ë°”ë¡œ ì‚½ì…ë©ë‹ˆë‹¤"}),e.jsx("li",{children:"â€¢ Derived PEG: ë‹¤ë¥¸ ìˆ˜ì‹ì—ì„œ ì°¸ì¡°í•  ìˆ˜ ìˆëŠ” ê³„ì‚°ëœ ê°’ì…ë‹ˆë‹¤"}),e.jsx("li",{children:"â€¢ ë¹„í™œì„±í™”ëœ Derived PEGëŠ” ëª©ë¡ì— í‘œì‹œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤"}),e.jsx("li",{children:"â€¢ Derived PEGë¼ë¦¬ ìˆœí™˜ ì°¸ì¡°í•˜ì§€ ì•Šë„ë¡ ì£¼ì˜í•˜ì„¸ìš”"})]})]})]})})]})]})};function jn(s=[]){return s.map(t=>({value:t.value,label:t.label,type:t.type,color:t.type==="derived"?"#3b82f6":"#6b7280",isDerived:t.type==="derived",description:t.description,formula:t.formula}))}const qt=()=>{var se,ie,O,R,U,B,S,M,C,K,H,V,Y,de,me,ke,ae,fe,be,ce,ye;const{settings:s,isLoading:t,isSaving:a,error:n,lastSaved:i,updateSettings:g,saveSettings:h,resetSettings:o}=Ye(),[u,d]=r.useState([]),[f,P]=r.useState(!1),[l,p]=r.useState(null),y=r.useCallback(async()=>{var z,I;try{P(!0),console.info("[PreferenceManager] Fetching DB PEGs");const L=(s==null?void 0:s.databaseSettings)||{};if(!L.host){console.warn("[PreferenceManager] No DB config found");return}const ue=await ge.post("/api/master/pegs",{host:String(L.host).trim(),port:Number(L.port)||5432,user:String(L.user||"").trim(),password:String(L.password||"").trim(),dbname:String(L.dbname||"").trim(),table:String(L.table||"summary").trim(),limit:500}),X=((z=ue==null?void 0:ue.data)==null?void 0:z.pegs)||(Array.isArray((I=ue==null?void 0:ue.data)==null?void 0:I.items)?ue.data.items.map(pe=>({id:pe,name:pe})):Array.isArray(ue==null?void 0:ue.data)?ue.data.map(pe=>({id:pe,name:pe})):[]);console.info("[PreferenceManager] DB PEGs loaded:",X.length);const Ne=X.map(pe=>({value:pe.id||pe.name||pe.peg_name,label:String(pe.name||pe.id||pe.peg_name)}));d(Ne),p(new Date)}catch(L){console.error("[PreferenceManager] Error fetching DB PEGs:",L)}finally{P(!1)}},[s==null?void 0:s.databaseSettings]),v=r.useCallback(()=>{const z=jn(u);return console.log("âœ… ìµœì¢… PEG ì˜µì…˜:",z),z},[u]),k=JSON.stringify({host:(se=s==null?void 0:s.databaseSettings)==null?void 0:se.host,port:(ie=s==null?void 0:s.databaseSettings)==null?void 0:ie.port,user:(O=s==null?void 0:s.databaseSettings)==null?void 0:O.user,dbname:(R=s==null?void 0:s.databaseSettings)==null?void 0:R.dbname,table:(U=s==null?void 0:s.databaseSettings)==null?void 0:U.table});r.useEffect(()=>{y()},[y,k]);const _=[{key:"selectedPegs",label:"Dashboardì— í‘œì‹œí•  PEG ëª©ë¡",type:"multiselect",required:!1,options:v(),placeholder:"Database PEGì—ì„œ ì„ íƒí•˜ì„¸ìš”"},{key:"chartLayout",label:"ê·¸ë˜í”„ ì •ë ¬ ë°©ì‹",type:"select",options:[{value:"byPeg",label:"PEGë³„ (PEGë§ˆë‹¤ Cell/NE ì‹œë¦¬ì¦ˆ)"},{value:"byEntity",label:"Cell/NEë³„ (ì—”í„°í‹°ë§ˆë‹¤ PEG ì‹œë¦¬ì¦ˆ)"}]}],[c,D]=r.useState([]),[A,j]=r.useState([]),[$,G]=r.useState([]),[w,E]=r.useState([]),[m,x]=r.useState([]),[b,F]=r.useState([]);r.useEffect(()=>{const z=(s==null?void 0:s.statisticsSettings)||{};j(Array.isArray(z.selectedHosts)?z.selectedHosts:[]),E(Array.isArray(z.selectedNEs)?z.selectedNEs:[]),F(Array.isArray(z.selectedCellIds)?z.selectedCellIds:[])},[s==null?void 0:s.statisticsSettings]),r.useEffect(()=>{(async()=>{var I;try{const L=(s==null?void 0:s.databaseSettings)||{};if(!L.host)return;const ue={host:String(L.host||"").trim(),port:Number(L.port)||5432,user:String(L.user||"").trim(),password:String(L.password||"").trim(),dbname:String(L.dbname||"").trim(),table:String(L.table||"summary").trim()},X=await ge.post("/api/master/hosts",ue);D(Array.isArray((I=X==null?void 0:X.data)==null?void 0:I.hosts)?X.data.hosts:[])}catch(L){console.error("[PreferenceManager] HOST ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨",L)}})()},[(B=s==null?void 0:s.databaseSettings)==null?void 0:B.host,(S=s==null?void 0:s.databaseSettings)==null?void 0:S.port,(M=s==null?void 0:s.databaseSettings)==null?void 0:M.user,(C=s==null?void 0:s.databaseSettings)==null?void 0:C.password,(K=s==null?void 0:s.databaseSettings)==null?void 0:K.dbname,(H=s==null?void 0:s.databaseSettings)==null?void 0:H.table]),r.useEffect(()=>{(async()=>{var I;try{const L=(s==null?void 0:s.databaseSettings)||{};if(!L.host||A.length===0){G([]);return}const ue={host:String(L.host||"").trim(),port:Number(L.port)||5432,user:String(L.user||"").trim(),password:String(L.password||"").trim(),dbname:String(L.dbname||"").trim(),table:String(L.table||"summary").trim(),hosts:A},X=await ge.post("/api/master/nes-by-host",ue);G(Array.isArray((I=X==null?void 0:X.data)==null?void 0:I.nes)?X.data.nes:[])}catch(L){console.error("[PreferenceManager] NE ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨",L)}})()},[A,s==null?void 0:s.databaseSettings]),r.useEffect(()=>{(async()=>{var I;try{const L=(s==null?void 0:s.databaseSettings)||{};if(!L.host||A.length===0||w.length===0){x([]);return}const ue={host:String(L.host||"").trim(),port:Number(L.port)||5432,user:String(L.user||"").trim(),password:String(L.password||"").trim(),dbname:String(L.dbname||"").trim(),table:String(L.table||"summary").trim(),hosts:A,nes:w},X=await ge.post("/api/master/cells-by-host-ne",ue);x(Array.isArray((I=X==null?void 0:X.data)==null?void 0:I.cellids)?X.data.cellids:[])}catch(L){console.error("[PreferenceManager] CellID ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨",L)}})()},[w,A,s==null?void 0:s.databaseSettings]);const T=[{key:"host",label:"Host",type:"text",placeholder:"ì˜ˆ: 127.0.0.1"},{key:"port",label:"Port",type:"number",min:1,max:65535,placeholder:"5432"},{key:"user",label:"User",type:"text",placeholder:"postgres"},{key:"password",label:"Password",type:"text",placeholder:"ë¹„ë°€ë²ˆí˜¸"},{key:"dbname",label:"DB Name",type:"text",placeholder:"postgres"},{key:"table",label:"ê¸°ë³¸ í…Œì´ë¸”ëª…",type:"text",placeholder:"summary"}],q=[{key:"enableNotifications",label:"ì•Œë¦¼ í™œì„±í™”",type:"switch"},{key:"emailNotifications",label:"ì´ë©”ì¼ ì•Œë¦¼",type:"switch"},{key:"soundEnabled",label:"ì†Œë¦¬ ì•Œë¦¼",type:"switch"},{key:"notificationFrequency",label:"ì•Œë¦¼ ë¹ˆë„",type:"select",options:[{value:"immediate",label:"ì¦‰ì‹œ"},{value:"hourly",label:"ë§¤ì‹œê°„"},{value:"daily",label:"ë§¤ì¼"},{value:"weekly",label:"ë§¤ì£¼"}]}];return t?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-3xl font-bold",children:"í™˜ê²½ì„¤ì •"}),e.jsxs(Z,{variant:"secondary",className:"text-xs",children:[e.jsx(Be,{className:"h-3 w-3 mr-1"}),"ë¡œë”© ì¤‘..."]})]}),e.jsx(re,{children:e.jsx(ne,{className:"pt-6",children:e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"ì„¤ì •ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤..."})})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold",children:"í™˜ê²½ì„¤ì •"}),e.jsx("p",{className:"text-muted-foreground",children:"Dashboardì™€ Statisticsì˜ ë™ì‘ì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a&&e.jsxs(Z,{variant:"secondary",className:"text-xs",children:[e.jsx(Be,{className:"h-3 w-3 mr-1"}),"ì €ì¥ ì¤‘..."]}),n&&e.jsx(Z,{variant:"destructive",className:"text-xs",children:"ì˜¤ë¥˜ ë°œìƒ"}),i&&e.jsxs(Z,{variant:"outline",className:"text-xs",children:["ë§ˆì§€ë§‰ ì €ì¥: ",new Date(i).toLocaleTimeString()]})]})]}),e.jsxs(ws,{defaultValue:"dashboard",className:"w-full",children:[e.jsxs(Ss,{className:"grid w-full grid-cols-6",children:[e.jsxs(De,{value:"dashboard",className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"h-4 w-4"}),"Dashboard"]}),e.jsxs(De,{value:"statistics",className:"flex items-center gap-2",children:[e.jsx(We,{className:"h-4 w-4"}),"Statistics"]}),e.jsxs(De,{value:"database",className:"flex items-center gap-2",children:[e.jsx(We,{className:"h-4 w-4"}),"Database"]}),e.jsxs(De,{value:"derived-peg",className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"h-4 w-4"}),"Derived PEG"]}),e.jsxs(De,{value:"notifications",className:"flex items-center gap-2",children:[e.jsx(hr,{className:"h-4 w-4"}),"ì•Œë¦¼"]}),e.jsxs(De,{value:"backup",className:"flex items-center gap-2",children:[e.jsx(ls,{className:"h-4 w-4"}),"ë°±ì—…/ë³µì›"]})]}),e.jsxs(_e,{value:"dashboard",className:"space-y-6",children:[e.jsxs(re,{children:[e.jsx(he,{children:e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(We,{className:"h-5 w-5"}),"PEG ë°ì´í„° ì†ŒìŠ¤"]})}),e.jsx(ne,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"PEG ë°ì´í„° ì†ŒìŠ¤"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Database Settingsì—ì„œ ì—°ê²°ëœ ì‹¤ì œ PEG ëª©ë¡ì„ ì‚¬ìš©í•©ë‹ˆë‹¤"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(J,{variant:"outline",size:"sm",onClick:y,disabled:f,children:[e.jsx(os,{className:`h-3 w-3 ${f?"animate-spin":""}`}),"ìƒˆë¡œê³ ì¹¨"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-3 border rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium",children:"ì‚¬ìš© ê°€ëŠ¥í•œ PEG"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[u.length,"ê°œ"]})]}),e.jsxs("div",{className:"text-center p-3 border rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium",children:"ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:l?l.toLocaleTimeString():"ì—†ìŒ"})]})]}),u.length===0&&!f&&e.jsx("div",{className:"p-3 border rounded-lg bg-amber-50 border-amber-200",children:e.jsx("p",{className:"text-sm text-amber-700",children:"âš ï¸ DB PEGë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. Database Settingsì—ì„œ DB ì—°ê²°ì„ í™•ì¸í•˜ì„¸ìš”."})}),u.length>0&&e.jsx("div",{className:"p-3 border rounded-lg bg-green-50 border-green-200",children:e.jsxs("p",{className:"text-sm text-green-700",children:["âœ… ",u.length,"ê°œì˜ ì‹¤ì œ DB PEGë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"]})})]})})]}),e.jsx(As,{title:"Dashboard ì„¤ì •",description:"DBì—ì„œ ì—°ë™ëœ PEGë§Œ ì„ íƒí•˜ì—¬ í‘œì‹œí•©ë‹ˆë‹¤",settingKey:"dashboardSettings",fields:_,defaultOpen:!0,showResetButton:!0,showSaveButton:!1},`dashboard-settings-${u.length}-${l?l.getTime():0}`),e.jsx("div",{className:"flex items-center justify-end gap-2",children:e.jsx(J,{size:"sm",onClick:async()=>{try{await h(),alert("Dashboard ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤")}catch(z){alert("ì €ì¥ ì‹¤íŒ¨: "+((z==null?void 0:z.message)||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"))}},disabled:a,children:a?"ì €ì¥ ì¤‘...":"ì €ì¥"})})]}),e.jsx(_e,{value:"statistics",className:"space-y-6",children:e.jsxs(re,{children:[e.jsx(he,{children:e.jsx(xe,{children:"ë°ì´í„° ì„ íƒ (HOST â†’ NE â†’ CellID)"})}),e.jsxs(ne,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(W,{className:"block mb-2",children:"HOST (ë‹¤ì¤‘ ì„ íƒ)"}),e.jsx("select",{multiple:!0,className:"w-full border rounded p-2 h-48",value:A,onChange:z=>{const I=Array.from(z.target.selectedOptions).map(L=>L.value);j(I)},children:c.map(z=>e.jsx("option",{value:z,children:z},z))})]}),e.jsxs("div",{children:[e.jsx(W,{className:"block mb-2",children:"NE (ë‹¤ì¤‘ ì„ íƒ)"}),e.jsx("select",{multiple:!0,className:"w-full border rounded p-2 h-48",value:w,onChange:z=>{const I=Array.from(z.target.selectedOptions).map(L=>L.value);E(I)},children:$.map(z=>e.jsx("option",{value:z,children:z},z))})]}),e.jsxs("div",{children:[e.jsx(W,{className:"block mb-2",children:"CellID (ë‹¤ì¤‘ ì„ íƒ)"}),e.jsx("select",{multiple:!0,className:"w-full border rounded p-2 h-48",value:b,onChange:z=>{const I=Array.from(z.target.selectedOptions).map(L=>L.value);F(I)},children:m.map(z=>e.jsx("option",{value:z,children:z},z))})]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.jsxs("div",{className:"mb-1",children:["HOST: ",A.length,"ê°œ"]}),e.jsxs("div",{className:"mb-1",children:["NE: ",w.length,"ê°œ"]}),e.jsxs("div",{children:["CellID: ",b.length,"ê°œ"]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(J,{size:"sm",onClick:async()=>{try{g({statisticsSettings:{...(s==null?void 0:s.statisticsSettings)||{},selectedHosts:A,selectedNEs:w,selectedCellIds:b}}),await h(),alert("Statistics ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤")}catch(z){alert("ì €ì¥ ì‹¤íŒ¨: "+((z==null?void 0:z.message)||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"))}},disabled:a,children:a?"ì €ì¥ ì¤‘...":"ì €ì¥"})})]})]})]})}),e.jsxs(_e,{value:"database",className:"space-y-6",children:[e.jsx(As,{title:"Database ì„¤ì •",description:"LLM ë¶„ì„ê³¼ Statisticsì—ì„œ ê³µí†µìœ¼ë¡œ ì‚¬ìš©í•  PostgreSQL DB ì„¤ì •ì…ë‹ˆë‹¤ (í…Œì´ë¸”ëª… í¬í•¨).",settingKey:"databaseSettings",fields:T,defaultOpen:!0,showResetButton:!0,showSaveButton:!1}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(J,{size:"sm",onClick:async()=>{try{await h(),alert("Database ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤")}catch(z){alert("ì €ì¥ ì‹¤íŒ¨: "+((z==null?void 0:z.message)||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"))}},disabled:a,children:a?"ì €ì¥ ì¤‘...":"ì €ì¥"}),e.jsx(J,{size:"sm",onClick:async()=>{var z,I,L,ue;try{const X=(s==null?void 0:s.databaseSettings)||{},Ne=await ge.post("/api/master/test-connection",{host:(X.host||"").trim(),port:Number(X.port)||5432,user:(X.user||"").trim(),password:(X.password||"").trim(),dbname:(X.dbname||"").trim(),table:(X.table||"summary").trim()}),pe=(z=Ne==null?void 0:Ne.data)==null?void 0:z.success;alert(pe?"DB ì—°ê²° ì„±ê³µ. table_exists="+((I=Ne==null?void 0:Ne.data)==null?void 0:I.table_exists):"DB ì—°ê²° ì‹¤íŒ¨: ì‘ë‹µ í˜•ì‹ í™•ì¸ í•„ìš”")}catch(X){alert("DB ì—°ê²° ì‹¤íŒ¨: "+(((ue=(L=X==null?void 0:X.response)==null?void 0:L.data)==null?void 0:ue.detail)||(X==null?void 0:X.message)))}},children:"Test Connection"})]})]}),e.jsx(_e,{value:"derived-peg",className:"space-y-6",children:e.jsx(pn,{derivedPegSettings:(s==null?void 0:s.derivedPegSettings)||{formulas:[],settings:{}},updateDerivedPegSettings:z=>{g({derivedPegSettings:z})},availablePegs:v(),saving:a})}),e.jsx(_e,{value:"notifications",className:"space-y-6",children:e.jsx(As,{title:"ì•Œë¦¼ ì„¤ì •",description:"ì´ë©”ì¼, ì†Œë¦¬ ì•Œë¦¼ ë“± ì•Œë¦¼ ê´€ë ¨ ì„¤ì •ì„ ê´€ë¦¬í•©ë‹ˆë‹¤",settingKey:"notificationSettings",fields:q,defaultOpen:!0,showResetButton:!0,showSaveButton:!1})}),e.jsxs(_e,{value:"backup",className:"space-y-6",children:[e.jsx(gn,{title:"ì„¤ì • ë°±ì—… ë° ë³µì›",description:"ëª¨ë“  í™˜ê²½ì„¤ì •ì„ JSON íŒŒì¼ë¡œ ë‚´ë³´ë‚´ê±°ë‚˜ ë°±ì—… íŒŒì¼ì—ì„œ ë³µì›í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤",defaultOpen:!0}),e.jsxs(re,{children:[e.jsxs(he,{children:[e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(Ls,{className:"h-5 w-5 text-orange-500"}),"ì„¤ì • ì´ˆê¸°í™”"]}),e.jsx(Ns,{children:"Dashboard, Statistics, Database ì„¤ì •ì„ ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”í•©ë‹ˆë‹¤. ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."})]}),e.jsxs(ne,{className:"space-y-4",children:[e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-md p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Is,{className:"h-5 w-5 text-orange-500 mt-0.5"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-orange-800",children:"ì£¼ì˜ì‚¬í•­"}),e.jsxs("ul",{className:"text-sm text-orange-700 space-y-1",children:[e.jsx("li",{children:"â€¢ Dashboardì˜ ì„ íƒëœ PEG ëª©ë¡ì´ ì´ˆê¸°í™”ë©ë‹ˆë‹¤"}),e.jsx("li",{children:"â€¢ Statisticsì˜ ê¸°ë³¸ ì„¤ì •ì´ ì´ˆê¸°í™”ë©ë‹ˆë‹¤"}),e.jsx("li",{children:"â€¢ Database ì—°ê²° ì„¤ì •ì´ ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”ë©ë‹ˆë‹¤"}),e.jsx("li",{children:"â€¢ ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"})]})]})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"ì´ˆê¸°í™”í•  ì„¤ì •"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Dashboard, Statistics, Database ì„¤ì •ì„ ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”"})]}),e.jsx(J,{variant:"destructive",size:"sm",onClick:async()=>{if(window.confirm(`ì •ë§ë¡œ Dashboard, Statistics, Database ì„¤ì •ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?

ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`))try{const I=await o(["dashboardSettings","statisticsSettings","databaseSettings"]);I.success?alert("âœ… ì„¤ì •ì´ ì„±ê³µì ìœ¼ë¡œ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤!"):alert("âŒ ì„¤ì • ì´ˆê¸°í™” ì‹¤íŒ¨: "+(I.error||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"))}catch(I){alert("âŒ ì„¤ì • ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ ë°œìƒ: "+I.message)}},disabled:t,children:t?e.jsxs(e.Fragment,{children:[e.jsx(ms,{className:"h-4 w-4 mr-2 animate-spin"}),"ì´ˆê¸°í™” ì¤‘..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ls,{className:"h-4 w-4 mr-2"}),"ì„¤ì • ì´ˆê¸°í™”"]})})]})]})]})]})]}),e.jsxs(re,{children:[e.jsx(he,{children:e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(ls,{className:"h-5 w-5"}),"í˜„ì¬ ì„¤ì • ìš”ì•½"]})}),e.jsx(ne,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Dashboard"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs text-muted-foreground",children:["ì„ íƒëœ PEG: ",((Y=(V=s==null?void 0:s.dashboardSettings)==null?void 0:V.selectedPegs)==null?void 0:Y.length)||0,"ê°œ"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["PEG ì†ŒìŠ¤: ",`DB (${u.length}ê°œ)`]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["ì°¨íŠ¸ ìŠ¤íƒ€ì¼: ",((de=s==null?void 0:s.dashboardSettings)==null?void 0:de.chartStyle)||"line"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["ìë™ ìƒˆë¡œê³ ì¹¨: ",((me=s==null?void 0:s.dashboardSettings)==null?void 0:me.autoRefreshInterval)||0,"ì´ˆ"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Statistics"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs text-muted-foreground",children:["ê¸°ë³¸ ê¸°ê°„: ",((ke=s==null?void 0:s.statisticsSettings)==null?void 0:ke.defaultDateRange)||7,"ì¼"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["ì†Œìˆ˜ì : ",((ae=s==null?void 0:s.statisticsSettings)==null?void 0:ae.decimalPlaces)||2,"ìë¦¬"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["ë¹„êµ ì˜µì…˜: ",(fe=s==null?void 0:s.statisticsSettings)!=null&&fe.showComparisonOptions?"í™œì„±":"ë¹„í™œì„±"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:"ì•Œë¦¼"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs text-muted-foreground",children:["ì•Œë¦¼: ",(be=s==null?void 0:s.notificationSettings)!=null&&be.enableNotifications?"í™œì„±":"ë¹„í™œì„±"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["ì´ë©”ì¼: ",(ce=s==null?void 0:s.notificationSettings)!=null&&ce.emailNotifications?"í™œì„±":"ë¹„í™œì„±"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["ì†Œë¦¬: ",(ye=s==null?void 0:s.notificationSettings)!=null&&ye.soundEnabled?"í™œì„±":"ë¹„í™œì„±"]})]})]})]})})]})]})},Wt=Object.freeze(Object.defineProperty({__proto__:null,default:qt},Symbol.toStringTag,{value:"Module"}));function vn({className:s,...t}){return e.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:e.jsx("table",{"data-slot":"table",className:te("w-full caption-bottom text-sm",s),...t})})}function bn({className:s,...t}){return e.jsx("thead",{"data-slot":"table-header",className:te("[&_tr]:border-b",s),...t})}function yn({className:s,...t}){return e.jsx("tbody",{"data-slot":"table-body",className:te("[&_tr:last-child]:border-0",s),...t})}function tt({className:s,...t}){return e.jsx("tr",{"data-slot":"table-row",className:te("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",s),...t})}function Ue({className:s,...t}){return e.jsx("th",{"data-slot":"table-head",className:te("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...t})}function Ke({className:s,...t}){return e.jsx("td",{"data-slot":"table-cell",className:te("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...t})}function at({...s}){return e.jsx(Ha,{"data-slot":"alert-dialog",...s})}function rt({...s}){return e.jsx(qa,{"data-slot":"alert-dialog-trigger",...s})}function Nn({...s}){return e.jsx(Xa,{"data-slot":"alert-dialog-portal",...s})}function wn({className:s,...t}){return e.jsx(er,{"data-slot":"alert-dialog-overlay",className:te("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...t})}function nt({className:s,...t}){return e.jsxs(Nn,{children:[e.jsx(wn,{}),e.jsx(Wa,{"data-slot":"alert-dialog-content",className:te("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...t})]})}function lt({className:s,...t}){return e.jsx("div",{"data-slot":"alert-dialog-header",className:te("flex flex-col gap-2 text-center sm:text-left",s),...t})}function it({className:s,...t}){return e.jsx("div",{"data-slot":"alert-dialog-footer",className:te("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",s),...t})}function ct({className:s,...t}){return e.jsx(Ya,{"data-slot":"alert-dialog-title",className:te("text-lg font-semibold",s),...t})}function ot({className:s,...t}){return e.jsx(Ja,{"data-slot":"alert-dialog-description",className:te("text-muted-foreground text-sm",s),...t})}function dt({className:s,...t}){return e.jsx(Qa,{className:te(Bs(),s),...t})}function mt({className:s,...t}){return e.jsx(Za,{className:te(Bs({variant:"outline"}),s),...t})}const Sn=({initialLimit:s=20,autoFetch:t=!0,initialFilters:a={}}={})=>{const[n,i]=r.useState([]),[g,h]=r.useState(!1),[o,u]=r.useState(null),[d,f]=r.useState(!0),[P,l]=r.useState({limit:s,skip:0,total:0}),[p,y]=r.useState({neId:"ALL",cellId:"ALL",startDate:null,endDate:null,status:"",...a}),v=r.useCallback((x,b={})=>{console.log(`[useAnalysisResults] ${x}`,b)},[]),k=r.useCallback((x,b)=>{console.error(`[useAnalysisResults] ${x}`,b)},[]),_=r.useCallback(async({limit:x=P.limit,skip:b=0,append:F=!1,showToast:T=!0}={})=>{var q,se,ie,O,R,U,B,S,M,C,K;try{h(!0),u(null),v("ë¶„ì„ ê²°ê³¼ ì¡°íšŒ ì‹œì‘",{limit:x,skip:b,filters:p});const H={limit:x,skip:b};(q=p.neId)!=null&&q.trim()&&(H.ne_id=p.neId.trim()),(se=p.cellId)!=null&&se.trim()&&(H.cell_id=p.cellId.trim()),p.startDate&&(H.date_from=p.startDate),p.endDate&&(H.date_to=p.endDate),(ie=p.status)!=null&&ie.trim()&&(H.status=p.status.trim());const V=await ge.get("/api/analysis/results",{params:H});v("ë¶„ì„ ê²°ê³¼ ì¡°íšŒ ì„±ê³µ",{resultCount:((R=(O=V.data)==null?void 0:O.items)==null?void 0:R.length)||0,total:((U=V.data)==null?void 0:U.total)||0,totalRequested:x});const de=(((B=V.data)==null?void 0:B.items)||[]).filter(me=>((me==null?void 0:me.analysis_type)||(me==null?void 0:me.analysisType))==="llm_analysis");return i(F?me=>[...me,...de]:de),l(me=>{var ke;return{...me,skip:F?me.skip+de.length:b+de.length,total:((ke=V.data)==null?void 0:ke.total)||0}}),f(((S=V.data)==null?void 0:S.has_next)||!1),T&&!F&&Q.success(`${de.length}ê°œì˜ ë¶„ì„ ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.`),de}catch(H){const V=((K=(C=(M=H==null?void 0:H.response)==null?void 0:M.data)==null?void 0:C.error)==null?void 0:K.message)||(H==null?void 0:H.message)||"ë¶„ì„ ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";return k("ë¶„ì„ ê²°ê³¼ ì¡°íšŒ ì‹¤íŒ¨",H),u(V),T&&Q.error(`ë°ì´í„° ì¡°íšŒ ì‹¤íŒ¨: ${V}`),[]}finally{h(!1)}},[P.limit,p,v,k]),c=r.useCallback(x=>{v("í•„í„° ì—…ë°ì´íŠ¸",{ì´ì „:p,ìƒˆë¡œìš´:x}),y(b=>({...b,...x})),l(b=>({...b,skip:0}))},[p,v]),D=r.useCallback(()=>{v("í•„í„° ì´ˆê¸°í™”"),y({neId:"",cellId:"",startDate:null,endDate:null,status:""}),l(x=>({...x,skip:0}))},[v]),A=r.useCallback(async()=>{if(g||!d){v("ì¶”ê°€ ë¡œë”© ê±´ë„ˆëœ€",{loading:g,hasMore:d});return}v("ì¶”ê°€ ê²°ê³¼ ë¡œë”© ì‹œì‘"),await _({skip:P.skip,append:!0,showToast:!1})},[g,d,_,P.skip,v]),j=r.useCallback(async()=>{v("ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì‹œì‘"),l(x=>({...x,skip:0})),await _({skip:0,append:!1})},[_,v]),$=r.useCallback(async x=>{var b,F,T;try{v("ë¶„ì„ ê²°ê³¼ ì‚­ì œ ì‹œì‘",{resultId:x}),await ge.delete(`/api/analysis/results/${x}`),i(q=>q.filter(se=>se.id!==x)),v("ë¶„ì„ ê²°ê³¼ ì‚­ì œ ì„±ê³µ",{resultId:x}),Q.success("ë¶„ì„ ê²°ê³¼ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(q){const se=((T=(F=(b=q==null?void 0:q.response)==null?void 0:b.data)==null?void 0:F.error)==null?void 0:T.message)||(q==null?void 0:q.message)||"ë¶„ì„ ê²°ê³¼ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";k("ë¶„ì„ ê²°ê³¼ ì‚­ì œ ì‹¤íŒ¨",q),Q.error(`ì‚­ì œ ì‹¤íŒ¨: ${se}`)}},[v,k]);r.useEffect(()=>{t&&(v("ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸ - ìë™ ë°ì´í„° ì¡°íšŒ ì‹œì‘"),_({skip:0,append:!1,showToast:!1}))},[t]),r.useEffect(()=>{t&&(v("í•„í„° ë³€ê²½ ê°ì§€ - ë°ì´í„° ì¬ì¡°íšŒ"),_({skip:0,append:!1,showToast:!1}))},[t,p,_,v]);const G=r.useMemo(()=>!g&&n.length===0,[g,n.length]),w=r.useMemo(()=>Object.values(p).some(x=>x!=null&&x!==""),[p]),E=r.useMemo(()=>n.length,[n.length]),m=r.useMemo(()=>({resultCount:E,loading:g,hasMore:d,isEmpty:G,isFiltered:w,pagination:P,filters:p,error:o}),[E,g,d,G,w,P,p,o]);return r.useEffect(()=>{},[m]),{results:n,loading:g,error:o,isEmpty:G,hasMore:d,isFiltered:w,resultCount:E,pagination:P,filters:p,updateFilters:c,clearFilters:D,fetchResults:_,refresh:j,loadMore:A,deleteResult:$,debugInfo:m}},Cn=({filters:s={},onFilterChange:t,onClearFilters:a,isCollapsed:n=!1,onToggleCollapse:i,showActiveCount:g=!0})=>{const h=r.useCallback((j,$={})=>{console.log(`[ResultFilter] ${j}`,$)},[]),{neId:o="",cellId:u="",startDate:d=null,endDate:f=null,status:P=""}=s,l={...o&&{"NE ID":o},...u&&{"Cell ID":u},...d&&{ì‹œì‘ì¼:new Date(d).toLocaleDateString("ko-KR")},...f&&{ì¢…ë£Œì¼:new Date(f).toLocaleDateString("ko-KR")},...P&&{ìƒíƒœ:P}},p=Object.keys(l).length,y=p>0,v=r.useCallback((j,$)=>{h("í•„í„° ë³€ê²½",{key:j,value:$}),t&&t(j,$)},[t,h]),k=r.useCallback(j=>{h("ê°œë³„ í•„í„° ì´ˆê¸°í™”",{key:j}),v(j,j==="startDate"||j==="endDate"?null:"")},[v,h]),_=r.useCallback(()=>{h("ì „ì²´ í•„í„° ì´ˆê¸°í™”"),a&&a()},[a,h]),c=r.useCallback(j=>{if(!j)return"";try{return new Date(j).toISOString().split("T")[0]}catch{return""}},[]),D=r.useCallback(j=>{if(!j)return null;try{return new Date(j).toISOString()}catch{return null}},[]),A=r.useCallback(()=>{h("í•„í„° íŒ¨ë„ í† ê¸€",{isCollapsed:!n}),i&&i()},[n,i,h]);return e.jsxs(re,{className:"w-full",children:[e.jsxs(he,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(xe,{className:"text-lg flex items-center gap-2",children:[e.jsx(Fs,{className:"h-5 w-5"}),"í•„í„°"]}),g&&y&&e.jsxs(Z,{variant:"secondary",className:"text-xs",children:[p,"ê°œ í™œì„±"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[y&&e.jsxs(J,{variant:"ghost",size:"sm",onClick:_,className:"text-destructive hover:text-destructive",children:[e.jsx(Le,{className:"h-4 w-4 mr-1"}),"ì „ì²´ ì´ˆê¸°í™”"]}),e.jsx(J,{variant:"ghost",size:"sm",onClick:A,children:n?e.jsx(Xe,{className:"h-4 w-4"}):e.jsx(ys,{className:"h-4 w-4"})})]})]}),y&&!n&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:Object.entries(l).map(([j,$])=>e.jsxs(Z,{variant:"outline",className:"flex items-center gap-1 pr-1",children:[e.jsxs("span",{className:"text-xs",children:[j,": ",$]}),e.jsx(J,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-destructive hover:text-destructive-foreground",onClick:()=>{const w={"NE ID":"neId","Cell ID":"cellId",ì‹œì‘ì¼:"startDate",ì¢…ë£Œì¼:"endDate",ìƒíƒœ:"status"}[j];w&&k(w)},children:e.jsx(Le,{className:"h-3 w-3"})})]},j))})]}),!n&&e.jsxs(ne,{className:"pt-0",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(W,{htmlFor:"filter-ne",className:"flex items-center gap-2",children:[e.jsx(xr,{className:"h-4 w-4"}),"NE ID"]}),e.jsxs("div",{className:"relative",children:[e.jsx(ve,{id:"filter-ne",placeholder:"NE ID ê²€ìƒ‰...",value:o,onChange:j=>v("neId",j.target.value),className:"pr-8"}),o&&e.jsx(J,{variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 -translate-y-1/2 h-6 w-6 p-0",onClick:()=>k("neId"),children:e.jsx(Le,{className:"h-3 w-3"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(W,{htmlFor:"filter-cell",className:"flex items-center gap-2",children:[e.jsx(gr,{className:"h-4 w-4"}),"Cell ID"]}),e.jsxs("div",{className:"relative",children:[e.jsx(ve,{id:"filter-cell",placeholder:"Cell ID ê²€ìƒ‰...",value:u,onChange:j=>v("cellId",j.target.value),className:"pr-8"}),u&&e.jsx(J,{variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 -translate-y-1/2 h-6 w-6 p-0",onClick:()=>k("cellId"),children:e.jsx(Le,{className:"h-3 w-3"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(W,{htmlFor:"filter-start",className:"flex items-center gap-2",children:[e.jsx(ds,{className:"h-4 w-4"}),"ì‹œì‘ ë‚ ì§œ"]}),e.jsxs("div",{className:"relative",children:[e.jsx(ve,{id:"filter-start",type:"date",value:c(d),onChange:j=>v("startDate",D(j.target.value)),className:"pr-8"}),d&&e.jsx(J,{variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 -translate-y-1/2 h-6 w-6 p-0",onClick:()=>k("startDate"),children:e.jsx(Le,{className:"h-3 w-3"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(W,{htmlFor:"filter-end",className:"flex items-center gap-2",children:[e.jsx(ds,{className:"h-4 w-4"}),"ì¢…ë£Œ ë‚ ì§œ"]}),e.jsxs("div",{className:"relative",children:[e.jsx(ve,{id:"filter-end",type:"date",value:c(f),onChange:j=>v("endDate",D(j.target.value)),className:"pr-8"}),f&&e.jsx(J,{variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 -translate-y-1/2 h-6 w-6 p-0",onClick:()=>k("endDate"),children:e.jsx(Le,{className:"h-3 w-3"})})]})]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t",children:[e.jsx(W,{className:"text-sm font-medium mb-3 block",children:"ë¹ ë¥¸ ë‚ ì§œ ì„ íƒ"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{label:"ì˜¤ëŠ˜",days:0},{label:"ì–´ì œ",days:1},{label:"ìµœê·¼ 7ì¼",days:7},{label:"ìµœê·¼ 30ì¼",days:30},{label:"ìµœê·¼ 90ì¼",days:90}].map(({label:j,days:$})=>e.jsx(J,{variant:"outline",size:"sm",onClick:()=>{const G=new Date,w=new Date;$===0?(w.setHours(0,0,0,0),G.setHours(23,59,59,999)):$===1?(w.setDate(w.getDate()-1),w.setHours(0,0,0,0),G.setDate(G.getDate()-1),G.setHours(23,59,59,999)):(w.setDate(w.getDate()-$),w.setHours(0,0,0,0),G.setHours(23,59,59,999)),v("startDate",w.toISOString()),v("endDate",G.toISOString()),h("ë¹ ë¥¸ ë‚ ì§œ ì„ íƒ",{label:j,startDate:w,endDate:G})},children:j},j))})]})]})]})},Yt=({isOpen:s,onClose:t,resultIds:a=[],mode:n="single"})=>{const[i,g]=r.useState([]),[h,o]=r.useState(!1),[u,d]=r.useState(null),[f,P]=r.useState("overview"),[l,p]=r.useState(!1);r.useEffect(()=>{const R=U=>{U.key==="F11"?(U.preventDefault(),p(B=>!B)):U.key==="Escape"&&l&&p(!1)};if(s)return window.addEventListener("keydown",R),()=>window.removeEventListener("keydown",R)},[s,l]);const[y,v]=r.useState(0),[k,_]=r.useState(10),[c,D]=r.useState(""),[A,j]=r.useState("all"),[$,G]=r.useState("all"),w=n==="compare"&&a.length>1;n==="single"&&a.length;const E=async R=>{o(!0),d(null);try{console.log("ğŸ“Š ë¶„ì„ ê²°ê³¼ ìƒì„¸ ì •ë³´ ìš”ì²­:",R);const U=R.map(async S=>{try{return{...(await ge.get(`/api/analysis/results/${S}`)).data,id:S}}catch(M){return console.error(`âŒ ê²°ê³¼ ${S} ë¡œë”© ì‹¤íŒ¨:`,M),{id:S,error:M.message||"ë¡œë”© ì‹¤íŒ¨",analysisDate:new Date().toISOString(),neId:"-",cellId:"-",status:"error"}}}),B=await Promise.all(U);g(B),console.log("âœ… ë¶„ì„ ê²°ê³¼ ìƒì„¸ ì •ë³´ ë¡œë”© ì™„ë£Œ:",B)}catch(U){console.error("âŒ ë¶„ì„ ê²°ê³¼ ìƒì„¸ ì •ë³´ ë¡œë”© ì‹¤íŒ¨:",U),d(U.message||"ë°ì´í„° ë¡œë”©ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"),Q.error("ë¶„ì„ ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤")}finally{o(!1)}};r.useEffect(()=>{s&&a.length>0&&E(a)},[s,a]);const m=R=>{switch(R==null?void 0:R.toLowerCase()){case"success":return"default";case"error":case"failed":return"destructive";case"warning":return"secondary";case"pending":case"processing":return"outline";default:return"secondary"}},x=R=>{try{return new Date(R).toLocaleString("ko-KR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",weekday:"short"})}catch{return R||"-"}},b=r.useMemo(()=>i.filter(R=>!R.error),[i]),F=r.useMemo(()=>{var U,B;return w?(((B=(U=b[0])==null?void 0:U.kpiResults)==null?void 0:B.map(S=>S.name))||[]).map(S=>{const M={name:S};return b.forEach((C,K)=>{var V;const H=(V=C.kpiResults)==null?void 0:V.find(Y=>Y.name===S);M[`ê²°ê³¼${K+1}`]=parseFloat((H==null?void 0:H.value)||0)}),M}):null},[b,w]),T=r.useMemo(()=>{var z;if(w||!b.length||!b[0].stats)return{kpiResults:[],sortedKpiResults:[],filteredResults:[],dataWithTrends:[],trendFilteredResults:[],totalPages:0,paginatedResults:[],data:[],summaryStats:{improved:0,declined:0,stable:0,avgChange:0,weightedAvgChange:0}};const R=b[0],U=R.stats||[],B={};U.forEach(I=>{const L=I.kpi_name;B[L]||(B[L]={peg_name:L,weight:5}),I.period==="N-1"?B[L]["N-1"]=I.avg:I.period==="N"&&(B[L].N=I.avg)});const S=((z=R.request_params)==null?void 0:z.peg_definitions)||{};Object.keys(B).forEach(I=>{var L;(L=S[I])!=null&&L.weight&&(B[I].weight=S[I].weight)});const M=Object.values(B).filter(I=>I["N-1"]!==void 0&&I.N!==void 0),C=[...M].sort((I,L)=>(L.weight||0)-(I.weight||0)),K=C.filter(I=>{const L=!c||I.peg_name.toLowerCase().includes(c.toLowerCase()),ue=I.weight||0;let X=!0;return A==="high"?X=ue>=8:A==="medium"?X=ue>=6&&ue<8:A==="low"&&(X=ue<6),L&&X}),H=K.map(I=>{const L=I["N-1"]||0,X=(I.N||0)-L,Ne=L!==0?X/L*100:0,pe=X>0?"up":X<0?"down":"stable";return{...I,change:X,changePercent:Ne,trend:pe}}),V=H.filter(I=>$==="all"?!0:I.trend===$),Y=Math.ceil(V.length/k),de=V.slice(y*k,(y+1)*k),me=de.map(I=>({name:I.peg_name,"N-1":I["N-1"]||0,N:I.N||0,change:I.change,changePercent:I.changePercent,trend:I.trend,weight:I.weight,unit:"%",peg:I.weight||0})),ke=me.filter(I=>I.trend==="up").length,ae=me.filter(I=>I.trend==="down").length,fe=me.filter(I=>I.trend==="stable").length,be=me.length>0?me.reduce((I,L)=>I+L.change,0)/me.length:0,ce=me.length>0?me.reduce((I,L)=>I+L.change*L.weight,0)/me.reduce((I,L)=>I+L.weight,0):0;return{kpiResults:M,sortedKpiResults:C,filteredResults:K,dataWithTrends:H,trendFilteredResults:V,totalPages:Y,paginatedResults:de,data:me,summaryStats:{improved:ke,declined:ae,stable:fe,avgChange:be,weightedAvgChange:ce}}},[w,b,c,A,$,y,k]),q=()=>{const{kpiResults:R,trendFilteredResults:U,totalPages:B,data:S,summaryStats:M}=T;return w?e.jsx(Ie,{width:"100%",height:400,children:e.jsxs(vs,{data:F,children:[e.jsx(He,{strokeDasharray:"3 3"}),e.jsx(qe,{dataKey:"name"}),e.jsx(ze,{}),e.jsx(Re,{}),e.jsx(Me,{}),b.map((C,K)=>e.jsx(Te,{dataKey:`ê²°ê³¼${K+1}`,fill:`hsl(${K*60}, 70%, 50%)`},`result${K+1}`))]})}):R.length?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 p-4 bg-muted/30 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:M.improved}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"ê°œì„  ğŸ“ˆ"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-red-600",children:M.declined}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"í•˜ë½ ğŸ“‰"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-gray-600",children:M.stable}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"ì•ˆì • â¡ï¸"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-lg font-bold ${M.avgChange>=0?"text-green-600":"text-red-600"}`,children:[M.avgChange>0?"+":"",M.avgChange.toFixed(2),"%"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"í‰ê·  ë³€í™”"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-lg font-bold ${M.weightedAvgChange>=0?"text-green-600":"text-red-600"}`,children:[M.weightedAvgChange>0?"+":"",M.weightedAvgChange.toFixed(2),"%"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"ê°€ì¤‘ í‰ê·  ë³€í™”"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[e.jsx("span",{children:"ğŸ“Š PEGë³„ N-1/N ì„±ëŠ¥ ë¹„êµ (ê°€ì¤‘ì¹˜ ë†’ì€ ìˆœ)"}),e.jsxs(Z,{variant:"outline",children:["ì „ì²´ ",R.length,"ê°œ ì¤‘ ",U.length,"ê°œ í‘œì‹œ"]})]}),e.jsxs("div",{className:`grid gap-3 transition-all duration-300 ${l?"grid-cols-1 md:grid-cols-6 lg:grid-cols-8":"grid-cols-1 md:grid-cols-5"}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx(js,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ve,{placeholder:"PEG ì´ë¦„ ê²€ìƒ‰...",value:c,onChange:C=>{D(C.target.value),v(0)},className:"pl-8"})]}),e.jsxs(Ee,{value:A,onValueChange:C=>{j(C),v(0)},children:[e.jsxs($e,{children:[e.jsx(Fs,{className:"h-4 w-4 mr-2"}),e.jsx(Pe,{placeholder:"ê°€ì¤‘ì¹˜ í•„í„°"})]}),e.jsxs(Ae,{children:[e.jsx(le,{value:"all",children:"ì „ì²´"}),e.jsx(le,{value:"high",children:"ë†’ìŒ (â‰¥8)"}),e.jsx(le,{value:"medium",children:"ì¤‘ê°„ (6-7.9)"}),e.jsx(le,{value:"low",children:"ë‚®ìŒ (<6)"})]})]}),e.jsxs(Ee,{value:$,onValueChange:C=>{G(C),v(0)},children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:"íŠ¸ë Œë“œ í•„í„°"})}),e.jsxs(Ae,{children:[e.jsx(le,{value:"all",children:"ì „ì²´ íŠ¸ë Œë“œ"}),e.jsx(le,{value:"up",children:"ê°œì„  ğŸ“ˆ"}),e.jsx(le,{value:"down",children:"í•˜ë½ ğŸ“‰"}),e.jsx(le,{value:"stable",children:"ì•ˆì • â¡ï¸"})]})]}),e.jsxs(Ee,{value:k.toString(),onValueChange:C=>{_(parseInt(C)),v(0)},children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:"í‘œì‹œ ê°œìˆ˜"})}),e.jsxs(Ae,{children:[e.jsx(le,{value:"5",children:"5ê°œì”©"}),e.jsx(le,{value:"10",children:"10ê°œì”©"}),e.jsx(le,{value:"20",children:"20ê°œì”©"}),e.jsx(le,{value:"50",children:"50ê°œì”©"})]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(J,{variant:"outline",size:"sm",onClick:()=>v(Math.max(0,y-1)),disabled:y===0,children:e.jsx(fr,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm",children:[y+1," / ",B||1]}),e.jsx(J,{variant:"outline",size:"sm",onClick:()=>v(Math.min(B-1,y+1)),disabled:y>=B-1,children:e.jsx(pr,{className:"h-4 w-4"})})]})]})]}),e.jsx(Ie,{width:"100%",height:l?Math.min(window.innerHeight*.55,900):Math.min(window.innerHeight*.4,500),className:"transition-all duration-300",children:e.jsxs(vs,{data:S,margin:{top:20,right:30,left:20,bottom:60},children:[e.jsx(He,{strokeDasharray:"3 3"}),e.jsx(qe,{dataKey:"name",angle:-45,textAnchor:"end",height:100,interval:0,fontSize:10}),e.jsx(ze,{}),e.jsx(Re,{formatter:(C,K,H)=>[`${C==null?void 0:C.toFixed(2)} ${H.payload.unit}`,K],labelFormatter:C=>{const K=S.find(H=>H.name===C);return`${C} (ê°€ì¤‘ì¹˜: ${(K==null?void 0:K.weight)||0})`},content:({active:C,payload:K,label:H})=>{var me,ke,ae,fe,be;if(!C||!(K!=null&&K.length))return null;const V=(me=K[0])==null?void 0:me.payload;if(!V)return null;const Y=ce=>{switch(ce){case"up":return"ğŸ“ˆ";case"down":return"ğŸ“‰";default:return"â¡ï¸"}},de=ce=>{switch(ce){case"up":return"text-green-600";case"down":return"text-red-600";default:return"text-gray-600"}};return e.jsxs("div",{className:"bg-white border rounded-lg shadow-lg p-3 min-w-[200px]",children:[e.jsx("div",{className:"font-semibold mb-2",children:H}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-orange-600",children:"N-1 ê¸°ê°„:"}),e.jsxs("span",{className:"font-medium",children:[(ke=V["N-1"])==null?void 0:ke.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-600",children:"N ê¸°ê°„:"}),e.jsxs("span",{className:"font-medium",children:[(ae=V.N)==null?void 0:ae.toFixed(2),"%"]})]}),e.jsxs("div",{className:"border-t pt-1 mt-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"ì„±ëŠ¥ ë³€í™”:"}),e.jsxs("div",{className:`flex items-center gap-1 font-medium ${de(V.trend)}`,children:[e.jsx("span",{children:Y(V.trend)}),e.jsxs("span",{children:[V.change>0?"+":"",(fe=V.change)==null?void 0:fe.toFixed(2),"%"]}),e.jsxs("span",{className:"text-xs",children:["(",V.changePercent>0?"+":"",(be=V.changePercent)==null?void 0:be.toFixed(1),"%)"]})]})]}),e.jsxs("div",{className:"flex justify-between mt-1",children:[e.jsx("span",{className:"text-gray-600",children:"ê°€ì¤‘ì¹˜:"}),e.jsxs("span",{className:"font-medium",children:[V.weight,"/10"]})]})]})]})]})}}),e.jsx(Me,{}),e.jsx(Te,{dataKey:"N-1",fill:"#ff7300",name:"N-1 ê¸°ê°„"}),e.jsx(Te,{dataKey:"N",fill:"#8884d8",name:"N ê¸°ê°„"})]})})]}):e.jsx("div",{className:"text-center text-muted-foreground",children:"PEG ë¹„êµ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤."})},se=R=>{var V;const U=(R==null?void 0:R[0])||{},B=((V=U==null?void 0:U.data)==null?void 0:V.data)||(U==null?void 0:U.data)||U,S=(B==null?void 0:B.analysis)||{},M=S.executive_summary||S.overall_summary||S.comprehensive_summary||"ìš”ì•½ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.",C=Array.isArray(S.diagnostic_findings)&&S.diagnostic_findings.length?S.diagnostic_findings:Array.isArray(S.key_findings)?S.key_findings.map(Y=>({primary_hypothesis:String(Y)})):[],H=(Array.isArray(S.recommended_actions)?S.recommended_actions:[]).map(Y=>Y&&typeof Y=="object"?Y:{priority:"",action:String(Y||""),details:""});return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(re,{children:[e.jsx(he,{children:e.jsx(xe,{children:"ì¢…í•© ë¶„ì„ ìš”ì•½"})}),e.jsx(ne,{children:e.jsx("div",{className:"text-sm text-muted-foreground whitespace-pre-line",children:M})})]}),C.length>0&&e.jsxs(re,{children:[e.jsx(he,{children:e.jsx(xe,{children:"í•µì‹¬ ê´€ì°° ì‚¬í•­"})}),e.jsx(ne,{children:e.jsx("div",{className:"space-y-3",children:C.map((Y,de)=>e.jsxs("div",{className:"space-y-1",children:[Y.primary_hypothesis&&e.jsxs("div",{className:"text-sm",children:[e.jsxs("span",{className:"font-semibold",children:["ê°€ì„¤ ",de+1,":"]})," ",Y.primary_hypothesis]}),Y.supporting_evidence&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["ì¦ê±°: ",Y.supporting_evidence]}),Y.confounding_factors_assessment&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["êµë€ ë³€ìˆ˜ í‰ê°€: ",Y.confounding_factors_assessment]})]},de))})})]}),H.length>0&&e.jsxs(re,{children:[e.jsx(he,{children:e.jsx(xe,{children:"ê¶Œì¥ ì¡°ì¹˜"})}),e.jsx(ne,{children:e.jsx("div",{className:"space-y-3",children:H.map((Y,de)=>e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5",children:e.jsx(Ms,{className:"h-5 w-5 text-green-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[Y.priority&&e.jsx(Z,{variant:"outline",children:Y.priority}),e.jsx("div",{className:"text-sm font-medium",children:Y.action||"-"})]}),Y.details&&e.jsx("div",{className:"text-xs text-muted-foreground mt-1 whitespace-pre-line",children:Y.details})]})]},de))})})]})]})},ie=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:[b.length,"ê°œ ê²°ê³¼ ë¹„êµ"]}),e.jsx("div",{className:"flex gap-2",children:b.map((R,U)=>e.jsxs(Z,{variant:"outline",className:"gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:`hsl(${U*60}, 70%, 50%)`}}),"ê²°ê³¼ ",U+1]},R.id))})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:b.map((R,U)=>e.jsx(re,{className:"border-l-4",style:{borderLeftColor:`hsl(${U*60}, 70%, 50%)`},children:e.jsx(ne,{className:"pt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-medium",children:["ê²°ê³¼ ",U+1]}),e.jsx(Z,{variant:m(R.status),children:R.status})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:x(R.analysisDate)}),e.jsxs("div",{className:"text-sm",children:["NE: ",R.neId," | Cell: ",R.cellId]})]})})},R.id))})]}),O=()=>h?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ms,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"ë¶„ì„ ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})]})}):u?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ce,{className:"h-12 w-12 text-destructive mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"ë°ì´í„° ë¡œë”© ì˜¤ë¥˜"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:u}),e.jsxs(J,{onClick:()=>E(a),variant:"outline",children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"ë‹¤ì‹œ ì‹œë„"]})]})}):b.length===0?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ce,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"ë¶„ì„ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."})]})}):e.jsxs(ws,{value:f,onValueChange:P,className:"w-full",children:[e.jsxs(Ss,{className:"grid w-full grid-cols-3",children:[e.jsx(De,{value:"overview",children:"ê°œìš”"}),e.jsx(De,{value:"kpi",children:"PEG ë¹„êµ ê²°ê³¼"}),e.jsx(De,{value:"recommendations",children:"LLM ë¶„ì„ ë¦¬í¬íŠ¸"})]}),e.jsx(_e,{value:"overview",className:"space-y-4 mt-6",children:w?ie():renderSingleOverview(b[0])}),e.jsx(_e,{value:"kpi",className:"space-y-4 mt-6",children:e.jsxs(re,{children:[e.jsx(he,{children:e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"h-5 w-5"}),w?"PEG ì„±ëŠ¥ ë¹„êµ ì°¨íŠ¸":"PEG ë¹„êµ ê²°ê³¼ (N-1 vs N)"]})}),e.jsx(ne,{children:q()})]})}),e.jsx(_e,{value:"recommendations",className:"space-y-4 mt-6",children:se(b)})]});return e.jsx(St,{open:s,onOpenChange:t,children:e.jsxs(Ct,{className:`transition-all duration-500 ease-in-out transform ${l?"max-w-[99vw] h-[98vh] w-[99vw] scale-100":"max-w-6xl max-h-[85vh] w-[90vw] scale-100"}`,children:[e.jsx(kt,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Dt,{className:"flex items-center gap-2",children:[e.jsx(vt,{className:"h-5 w-5"}),w?"ë¶„ì„ ê²°ê³¼ ë¹„êµ":"ë¶„ì„ ê²°ê³¼ ìƒì„¸"]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(J,{variant:"ghost",size:"sm",onClick:()=>p(!l),className:"transition-all duration-200 hover:scale-110 hover:bg-accent",title:l?"ì›ë˜ í¬ê¸°ë¡œ (ESC)":"ìµœëŒ€í™” (F11)",children:l?e.jsx(pt,{className:"h-4 w-4"}):e.jsx(jt,{className:"h-4 w-4"})})})]})}),e.jsx(bs,{className:`transition-all duration-300 ${l?"h-[85vh]":"max-h-[70vh]"}`,children:e.jsx("div",{className:"px-1",children:O()})})]})})},kn=Object.freeze(Object.defineProperty({__proto__:null,default:Yt},Symbol.toStringTag,{value:"Module"})),Jt=()=>{const{results:s,loading:t,error:a,isEmpty:n,hasMore:i,isFiltered:g,resultCount:h,filters:o,updateFilters:u,clearFilters:d,refresh:f,loadMore:P,deleteResult:l}=Sn({initialLimit:20,autoFetch:!0}),[p,y]=r.useState(!1),[v,k]=r.useState(new Set),[_,c]=r.useState({key:"analysisDate",direction:"desc"}),[D,A]=r.useState({isOpen:!1,resultIds:[],mode:"single"}),j=r.useCallback((O,R={})=>{console.log(`[ResultsList] ${O}`,R)},[]),$=r.useMemo(()=>s!=null&&s.length?[...s].sort((R,U)=>{const B=R[_.key],S=U[_.key];if(B==null)return 1;if(S==null)return-1;if(_.key==="analysisDate"){const M=new Date(B),C=new Date(S);return _.direction==="asc"?M-C:C-M}if(typeof B=="string"&&typeof S=="string"){const M=B.localeCompare(S);return _.direction==="asc"?M:-M}return typeof B=="number"&&typeof S=="number"?_.direction==="asc"?B-S:S-B:0}):[],[s,_]),G=r.useCallback(O=>{c(R=>{const U=R.key===O&&R.direction==="asc"?"desc":"asc";return j("ì •ë ¬ ë³€ê²½",{key:O,direction:U}),{key:O,direction:U}})},[j]),w=r.useCallback(O=>{k(R=>{const U=new Set(R);return U.has(O)?U.delete(O):U.add(O),U})},[]),E=r.useCallback(()=>{v.size===$.length?k(new Set):k(new Set($.map(O=>O.id)))},[v.size,$]),m=r.useCallback(async O=>{try{j("ë¶„ì„ ê²°ê³¼ ì‚­ì œ ì‹œì‘",{resultId:O}),await l(O),k(R=>{const U=new Set(R);return U.delete(O),U})}catch(R){j("ë¶„ì„ ê²°ê³¼ ì‚­ì œ ì‹¤íŒ¨",{resultId:O,error:R})}},[l,j]),x=r.useCallback(async()=>{if(v.size!==0)try{j("ë²Œí¬ ì‚­ì œ ì‹œì‘",{count:v.size});const O=Array.from(v).map(R=>l(R));await Promise.all(O),k(new Set),Q.success(`${v.size}ê°œì˜ ê²°ê³¼ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`)}catch(O){j("ë²Œí¬ ì‚­ì œ ì‹¤íŒ¨",{error:O}),Q.error("ì¼ë¶€ ê²°ê³¼ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}},[v,l,j]),b=r.useCallback(O=>{j("ìƒì„¸ ë³´ê¸° ìš”ì²­",{resultId:O}),A({isOpen:!0,resultIds:[O],mode:"single"})},[j]),F=r.useCallback(()=>{if(v.size<2){Q.error("ë¹„êµí•  ê²°ê³¼ë¥¼ 2ê°œ ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”");return}if(v.size>5){Q.error("ìµœëŒ€ 5ê°œê¹Œì§€ë§Œ ë¹„êµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤");return}const O=Array.from(v);j("ë¹„êµ ë³´ê¸° ìš”ì²­",{resultIds:O,count:O.length}),A({isOpen:!0,resultIds:O,mode:"compare"})},[v,j]),T=r.useCallback(()=>{A({isOpen:!1,resultIds:[],mode:"single"})},[]),q=r.useCallback(()=>{if(!($!=null&&$.length)){Q.error("ë‚´ë³´ë‚¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");return}try{j("ë°ì´í„° ë‚´ë³´ë‚´ê¸° ì‹œì‘",{count:$.length});const O=$.map(S=>{var M,C;return{"ë¶„ì„ ë‚ ì§œ":new Date(S.analysisDate).toLocaleString("ko-KR"),"NE ID":S.neId,"Cell ID":S.cellId,ìƒíƒœ:S.status,"ê²°ê³¼ ìˆ˜":((M=S.results)==null?void 0:M.length)||0,"í†µê³„ ìˆ˜":((C=S.stats)==null?void 0:C.length)||0}}),R=[Object.keys(O[0]).join(","),...O.map(S=>Object.values(S).join(","))].join(`
`),U=new Blob([R],{type:"text/csv;charset=utf-8;"}),B=document.createElement("a");B.href=URL.createObjectURL(U),B.download=`analysis_results_${new Date().toISOString().split("T")[0]}.csv`,B.click(),Q.success("ë°ì´í„°ê°€ ë‚´ë³´ë‚´ê¸° ë˜ì—ˆìŠµë‹ˆë‹¤."),j("ë°ì´í„° ë‚´ë³´ë‚´ê¸° ì™„ë£Œ")}catch(O){j("ë°ì´í„° ë‚´ë³´ë‚´ê¸° ì‹¤íŒ¨",{error:O}),Q.error("ë°ì´í„° ë‚´ë³´ë‚´ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}},[$,j]),se=r.useCallback(O=>{switch(O==null?void 0:O.toLowerCase()){case"success":return"default";case"error":case"failed":return"destructive";case"warning":return"secondary";case"pending":case"processing":return"outline";default:return"secondary"}},[]),ie=r.useCallback(O=>{try{return new Date(O).toLocaleString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch{return O||"-"}},[]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold",children:"LLM ë¶„ì„ ê²°ê³¼"}),e.jsxs("p",{className:"text-muted-foreground",children:["ì´ ",h,"ê°œì˜ ë¶„ì„ ê²°ê³¼",g&&" (í•„í„° ì ìš©ë¨)"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[v.size>0&&e.jsxs(e.Fragment,{children:[v.size>=2&&e.jsxs(J,{variant:"default",size:"sm",onClick:F,children:[e.jsx(BarChart3,{className:"h-4 w-4 mr-2"}),"ë¹„êµí•˜ê¸° (",v.size,")"]}),e.jsxs(at,{children:[e.jsx(rt,{asChild:!0,children:e.jsxs(J,{variant:"destructive",size:"sm",children:[e.jsx(Ts,{className:"h-4 w-4 mr-2"}),"ì„ íƒ ì‚­ì œ (",v.size,")"]})}),e.jsxs(nt,{children:[e.jsxs(lt,{children:[e.jsx(ct,{children:"ì„ íƒëœ ê²°ê³¼ ì‚­ì œ"}),e.jsxs(ot,{children:["ì„ íƒëœ ",v.size,"ê°œì˜ ë¶„ì„ ê²°ê³¼ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."]})]}),e.jsxs(it,{children:[e.jsx(mt,{children:"ì·¨ì†Œ"}),e.jsx(dt,{onClick:x,children:"ì‚­ì œ"})]})]})]})]}),e.jsxs(J,{variant:"outline",size:"sm",onClick:q,disabled:!($!=null&&$.length),children:[e.jsx(cs,{className:"h-4 w-4 mr-2"}),"ë‚´ë³´ë‚´ê¸°"]}),e.jsxs(J,{variant:"outline",size:"sm",onClick:()=>y(!p),children:[e.jsx(Fs,{className:"h-4 w-4 mr-2"}),"í•„í„°",e.jsx(Xe,{className:`h-4 w-4 ml-2 transition-transform ${p?"rotate-180":""}`})]}),e.jsxs(J,{variant:"outline",size:"sm",onClick:f,disabled:t,children:[e.jsx(Hs,{className:`h-4 w-4 mr-2 ${t?"animate-spin":""}`}),"ìƒˆë¡œê³ ì¹¨"]})]})]}),p&&e.jsx(Cn,{filters:o,onFilterChange:(O,R)=>u({[O]:R}),onClearFilters:d,isCollapsed:!1,onToggleCollapse:()=>y(!1),showActiveCount:!0}),e.jsx(re,{children:e.jsxs(ne,{className:"p-0",children:[a&&e.jsxs("div",{className:"p-6 text-center",children:[e.jsx(Ce,{className:"h-12 w-12 text-destructive mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"ë°ì´í„° ë¡œë”© ì˜¤ë¥˜"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:a}),e.jsxs(J,{onClick:f,variant:"outline",children:[e.jsx(Hs,{className:"h-4 w-4 mr-2"}),"ë‹¤ì‹œ ì‹œë„"]})]}),t&&n&&e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(ms,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"ë¶„ì„ ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})]}),!t&&n&&!a&&e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(js,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:g?"ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤":"ë¶„ì„ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:g?"ë‹¤ë¥¸ ì¡°ê±´ìœ¼ë¡œ ê²€ìƒ‰í•´ë³´ì„¸ìš”.":"ì•„ì§ ìƒì„±ëœ ë¶„ì„ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤."}),g&&e.jsxs(J,{onClick:d,variant:"outline",children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"í•„í„° ì´ˆê¸°í™”"]})]}),!n&&!a&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(vn,{children:[e.jsx(bn,{children:e.jsxs(tt,{children:[e.jsx(Ue,{className:"w-12",children:e.jsx("input",{type:"checkbox",checked:v.size===$.length&&$.length>0,onChange:E,className:"rounded border-gray-300"})}),e.jsxs(Ue,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>G("analysisDate"),children:["ë¶„ì„ ë‚ ì§œ",_.key==="analysisDate"&&e.jsx("span",{className:"ml-2",children:_.direction==="asc"?"â†‘":"â†“"})]}),e.jsxs(Ue,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>G("neId"),children:["NE ID",_.key==="neId"&&e.jsx("span",{className:"ml-2",children:_.direction==="asc"?"â†‘":"â†“"})]}),e.jsxs(Ue,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>G("cellId"),children:["Cell ID",_.key==="cellId"&&e.jsx("span",{className:"ml-2",children:_.direction==="asc"?"â†‘":"â†“"})]}),e.jsx(Ue,{children:"ìƒíƒœ"}),e.jsx(Ue,{className:"text-center",children:"ê²°ê³¼ ìˆ˜"}),e.jsx(Ue,{className:"text-center",children:"í†µê³„ ìˆ˜"}),e.jsx(Ue,{className:"w-20",children:"ì‘ì—…"})]})}),e.jsx(yn,{children:$.map(O=>{var R,U;return e.jsxs(tt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>b(O.id),children:[e.jsx(Ke,{onClick:B=>B.stopPropagation(),children:e.jsx("input",{type:"checkbox",checked:v.has(O.id),onChange:()=>w(O.id),className:"rounded border-gray-300"})}),e.jsx(Ke,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"h-4 w-4 text-muted-foreground"}),ie(O.analysisDate)]})}),e.jsx(Ke,{className:"font-medium",children:O.neId||"-"}),e.jsx(Ke,{className:"font-medium",children:O.cellId||"-"}),e.jsx(Ke,{children:e.jsx(Z,{variant:se(O.status),children:O.status||"unknown"})}),e.jsx(Ke,{className:"text-center",children:((R=O.results)==null?void 0:R.length)||0}),e.jsx(Ke,{className:"text-center",children:((U=O.stats)==null?void 0:U.length)||0}),e.jsx(Ke,{onClick:B=>B.stopPropagation(),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(J,{variant:"ghost",size:"sm",onClick:()=>b(O.id),title:"ìƒì„¸ ë³´ê¸°",children:e.jsx(js,{className:"h-4 w-4"})}),e.jsxs(at,{children:[e.jsx(rt,{asChild:!0,children:e.jsx(J,{variant:"ghost",size:"sm",title:"ì‚­ì œ",children:e.jsx(Ts,{className:"h-4 w-4 text-destructive"})})}),e.jsxs(nt,{children:[e.jsxs(lt,{children:[e.jsx(ct,{children:"ë¶„ì„ ê²°ê³¼ ì‚­ì œ"}),e.jsx(ot,{children:"ì´ ë¶„ì„ ê²°ê³¼ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."})]}),e.jsxs(it,{children:[e.jsx(mt,{children:"ì·¨ì†Œ"}),e.jsx(dt,{onClick:()=>m(O.id),children:"ì‚­ì œ"})]})]})]})]})})]},O.id)})})]})}),i&&!t&&!a&&e.jsx("div",{className:"p-6 text-center border-t",children:e.jsxs(J,{variant:"outline",onClick:P,disabled:t,children:[t?e.jsx(ms,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Xe,{className:"h-4 w-4 mr-2"}),"ë” ë³´ê¸°"]})})]})}),e.jsx(Yt,{isOpen:D.isOpen,onClose:T,resultIds:D.resultIds,mode:D.mode})]})},Zt=Object.freeze(Object.defineProperty({__proto__:null,default:Jt},Symbol.toStringTag,{value:"Module"})),Qt=()=>{var v;const{settings:s}=Ye(),t=(s==null?void 0:s.databaseSettings)||{host:"",port:5432,user:"postgres",password:"",dbname:"postgres",table:"summary"},[a,n]=r.useState({n_minus_1:"",n:"",table:"summary",ne:"",cellid:"",preference:"",columns:{time:"datetime",peg_name:"peg_name",value:"value",ne:"ne",cellid:"cellid"}}),[i,g]=r.useState(null),[h,o]=r.useState(!1),[u,d]=r.useState(null),[f,P]=r.useState([]),l=async()=>{if(!a.n_minus_1||!a.n){Q.error("ë¶„ì„ ê¸°ê°„(N-1, N)ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}if((i==null?void 0:i.type)!=="success"){Q.error("ë¨¼ì € Database ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”.");return}o(!0);try{console.log("ğŸš€ LLM ë¶„ì„ ì‹œì‘:",{dbConfig:t,analysisParams:a});const k=await zr(t,a,"default");console.log("âœ… LLM ë¶„ì„ íŠ¸ë¦¬ê±° ì„±ê³µ:",k),d({id:k.analysis_id,status:"processing",message:k.message,startTime:new Date}),Q.success("LLM ë¶„ì„ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."),p(k.analysis_id)}catch(k){console.error("âŒ LLM ë¶„ì„ ìš”ì²­ ì‹¤íŒ¨:",k),Q.error(`ë¶„ì„ ìš”ì²­ ì‹¤íŒ¨: ${k.message}`),o(!1)}},p=k=>{const _=setInterval(async()=>{try{const c=await Fr(k);console.log("ğŸ“Š í´ë§ ê²°ê³¼:",c),(c.status==="completed"||c.status==="error")&&(clearInterval(_),o(!1),d(D=>({...D,status:c.status,result:c,endTime:new Date})),P(D=>[{id:k,status:c.status,startTime:new Date,params:a,result:c},...D]),c.status==="completed"?Q.success("LLM ë¶„ì„ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!"):Q.error("LLM ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."))}catch(c){console.error("í´ë§ ì˜¤ë¥˜:",c),clearInterval(_),o(!1)}},5e3);setTimeout(()=>{clearInterval(_),h&&(o(!1),Q.error("ë¶„ì„ ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”."))},6e5)},y=(k,_)=>{n(c=>({...c,[k]:_}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(re,{children:[e.jsx(he,{children:e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(ft,{className:"h-5 w-5"}),"LLM ë¶„ì„ ê´€ë¦¬ì"]})}),e.jsx(ne,{children:e.jsx("p",{className:"text-muted-foreground",children:"PostgreSQL Databaseì—ì„œ ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ì—¬ LLM ê¸°ë°˜ ì„±ëŠ¥ ë¶„ì„ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤."})})]}),e.jsxs(re,{children:[e.jsx(he,{children:e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(We,{className:"h-5 w-5"}),"Database ì„¤ì •"]})}),e.jsxs(ne,{children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Database ì„¤ì •ì€ ì´ì œ ",e.jsx("strong",{children:"í™˜ê²½ì„¤ì • > Database"})," íƒ­ì—ì„œ í†µí•© ê´€ë¦¬ë©ë‹ˆë‹¤. ì´ í™”ë©´ì—ì„œëŠ” Preferenceì— ì €ì¥ëœ ì„¤ì •ì„ ì‚¬ìš©í•©ë‹ˆë‹¤."]}),e.jsxs("div",{className:"mt-3 text-sm",children:[e.jsxs("div",{children:["Host: ",e.jsx("span",{className:"font-mono",children:t.host||"-"})]}),e.jsxs("div",{children:["Port: ",e.jsx("span",{className:"font-mono",children:t.port||"-"})]}),e.jsxs("div",{children:["User: ",e.jsx("span",{className:"font-mono",children:t.user||"-"})]}),e.jsxs("div",{children:["DB: ",e.jsx("span",{className:"font-mono",children:t.dbname||"-"})]}),e.jsxs("div",{children:["Table: ",e.jsx("span",{className:"font-mono",children:t.table||"-"})]})]})]})]}),e.jsxs(re,{children:[e.jsx(he,{children:e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(ls,{className:"h-5 w-5"}),"ë¶„ì„ íŒŒë¼ë¯¸í„°"]})}),e.jsxs(ne,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(W,{htmlFor:"n_minus_1",children:"N-1 ê¸°ê°„"}),e.jsx(ve,{id:"n_minus_1",value:a.n_minus_1,onChange:k=>y("n_minus_1",k.target.value),placeholder:"YYYY-MM-DD_HH:mm~YYYY-MM-DD_HH:mm"})]}),e.jsxs("div",{children:[e.jsx(W,{htmlFor:"n",children:"N ê¸°ê°„"}),e.jsx(ve,{id:"n",value:a.n,onChange:k=>y("n",k.target.value),placeholder:"YYYY-MM-DD_HH:mm~YYYY-MM-DD_HH:mm"})]}),e.jsxs("div",{children:[e.jsx(W,{htmlFor:"table",children:"í…Œì´ë¸”ëª…"}),e.jsx(ve,{id:"table",value:a.table,onChange:k=>y("table",k.target.value),placeholder:"summary"})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(J,{onClick:l,disabled:h,children:h?e.jsxs(e.Fragment,{children:[e.jsx(ms,{className:"h-4 w-4 animate-spin mr-2"})," ë¶„ì„ ì¤‘..."]}):e.jsxs(e.Fragment,{children:[e.jsx(zs,{className:"h-4 w-4 mr-2"})," ë¶„ì„ ì‹œì‘"]})})})]})]}),u&&e.jsxs(re,{children:[e.jsx(he,{children:e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(Be,{className:"h-5 w-5"}),"í˜„ì¬ ë¶„ì„ ìƒíƒœ"]})}),e.jsxs(ne,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["ë¶„ì„ ID: ",u.id]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:u.message})]}),e.jsx(Z,{variant:u.status==="processing"?"default":u.status==="completed"?"success":"destructive",children:u.status==="processing"?"ì²˜ë¦¬ ì¤‘":u.status==="completed"?"ì™„ë£Œ":"ì˜¤ë¥˜"})]}),u.result&&u.status==="completed"&&e.jsxs("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:[e.jsx("p",{className:"font-medium mb-2",children:"ë¶„ì„ ê²°ê³¼"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[u.result.report_path&&e.jsxs("p",{children:["ğŸ“„ ë¦¬í¬íŠ¸: ",u.result.report_path]}),((v=u.result.results)==null?void 0:v.analysis)&&e.jsx("p",{children:"ğŸ§  LLM ë¶„ì„: ì™„ë£Œ"})]})]})]})]}),f.length>0&&e.jsxs(re,{children:[e.jsx(he,{children:e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(jr,{className:"h-5 w-5"}),"ë¶„ì„ íˆìŠ¤í† ë¦¬"]})}),e.jsx(ne,{children:e.jsx("div",{className:"space-y-3",children:f.map((k,_)=>e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("p",{className:"font-medium text-sm",children:["ë¶„ì„ #",_+1]}),e.jsx(Z,{variant:k.status==="completed"?"success":"destructive",children:k.status==="completed"?"ì™„ë£Œ":"ì˜¤ë¥˜"})]}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("p",{children:["ê¸°ê°„: ",k.params.n_minus_1," vs ",k.params.n]}),e.jsxs("p",{children:["ì‹œê°„: ",k.startTime.toLocaleString()]}),e.jsxs("p",{children:["ID: ",k.id]})]})]},k.id))})})]})]})},Xt=Object.freeze(Object.defineProperty({__proto__:null,default:Qt},Symbol.toStringTag,{value:"Module"}));class Dn extends na.Component{constructor(a){super(a);Cs(this,"handleRetry",()=>{console.log("ğŸ”„ ì•± ì¬ì‹œë„ ì¤‘..."),this.setState(a=>({hasError:!1,error:null,errorInfo:null,retryCount:a.retryCount+1}))});Cs(this,"handleReload",()=>{console.log("ğŸ”„ í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ì¤‘..."),window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null,retryCount:0}}static getDerivedStateFromError(a){return{hasError:!0}}componentDidCatch(a,n){var h,o,u,d;console.error("ğŸš¨ ErrorBoundaryì—ì„œ ì—ëŸ¬ ë°œìƒ:",a),console.error("ğŸš¨ ì—ëŸ¬ ë©”ì‹œì§€:",a.message),console.error("ğŸš¨ ì—ëŸ¬ ìŠ¤íƒ:",a.stack),console.error("ğŸš¨ ì—ëŸ¬ ì •ë³´:",n),console.error("ğŸš¨ ì»´í¬ë„ŒíŠ¸ ìŠ¤íƒ:",n.componentStack),console.error("ğŸš¨ğŸš¨ğŸš¨ === ERROR SUMMARY === ğŸš¨ğŸš¨ğŸš¨"),console.error(`ğŸ“ Error Type: ${a.name}`),console.error(`ğŸ“ Error Message: ${a.message}`),console.error(`ğŸ“ First Stack Line: ${((o=(h=a.stack)==null?void 0:h.split(`
`))==null?void 0:o[1])||"N/A"}`),console.error("ğŸš¨ğŸš¨ğŸš¨ =================== ğŸš¨ğŸš¨ğŸš¨"),console.error("ğŸš¨ ì—ëŸ¬ ê°ì²´ ì „ì²´:",{name:a.name,message:a.message,stack:a.stack,cause:a.cause,fileName:a.fileName,lineNumber:a.lineNumber,columnNumber:a.columnNumber}),console.error("ğŸš¨ ì—ëŸ¬ ê°ì²´ ëª¨ë“  ì†ì„±:");for(const f in a)try{console.error(`  ${f}:`,a[f])}catch{console.error(`  ${f}: [ì ‘ê·¼ ë¶ˆê°€]`)}console.error("ğŸš¨ ì—ëŸ¬ ê°ì²´ í”„ë¡œí† íƒ€ì… ì²´ì¸:");let i=a,g=0;for(;i&&g<5;)console.error(`  Level ${g}:`,((d=(u=Object.getPrototypeOf(i))==null?void 0:u.constructor)==null?void 0:d.name)||"Unknown"),i=Object.getPrototypeOf(i),g++;a.name==="ReferenceError"&&(console.error("ğŸ” ReferenceError ìƒì„¸ ë¶„ì„:"),console.error("  - ë³€ìˆ˜/í•¨ìˆ˜ê°€ ì •ì˜ë˜ì§€ ì•Šì•˜ê±°ë‚˜ ì ‘ê·¼í•  ìˆ˜ ì—†ìŒ"),console.error("  - ëª¨ë“ˆ import ìˆœì„œ ë¬¸ì œ ê°€ëŠ¥ì„±"),console.error("  - í˜¸ì´ìŠ¤íŒ… ë¬¸ì œ ê°€ëŠ¥ì„±")),a.name==="TypeError"&&(console.error("ğŸ” TypeError ìƒì„¸ ë¶„ì„:"),console.error("  - ê°ì²´ê°€ null/undefinedì¸ë° ì†ì„±ì— ì ‘ê·¼ ì‹œë„"),console.error("  - í•¨ìˆ˜ê°€ ì•„ë‹Œ ê²ƒì„ í•¨ìˆ˜ë¡œ í˜¸ì¶œ"),console.error("  - ì˜ëª»ëœ íƒ€ì…ì˜ ê°’ ì‚¬ìš©")),a.message.includes("Cannot access")&&(console.error("ğŸ” ìˆœí™˜ì°¸ì¡° ë˜ëŠ” ì´ˆê¸°í™” ìˆœì„œ ë¬¸ì œë¡œ ì¶”ì •ë©ë‹ˆë‹¤."),console.error("ğŸ” í•´ê²° ë°©ì•ˆ: ëª¨ë“ˆ import ìˆœì„œ í™•ì¸, ì§€ì—° ì´ˆê¸°í™” ì ìš©")),a.message.includes("before initialization")&&(console.error("ğŸ” ë³€ìˆ˜/í•¨ìˆ˜ ì´ˆê¸°í™” ìˆœì„œ ë¬¸ì œë¡œ ì¶”ì •ë©ë‹ˆë‹¤."),console.error("ğŸ” í•´ê²° ë°©ì•ˆ: í•¨ìˆ˜ ì„ ì–¸ì„ ìƒë‹¨ìœ¼ë¡œ ì´ë™, í˜¸ì´ìŠ¤íŒ… í™•ì¸")),a.message.includes("is not a function")&&(console.error("ğŸ” í•¨ìˆ˜ í˜¸ì¶œ ë¬¸ì œë¡œ ì¶”ì •ë©ë‹ˆë‹¤."),console.error("ğŸ” í•´ê²° ë°©ì•ˆ: í•¨ìˆ˜ ì¡´ì¬ ì—¬ë¶€ í™•ì¸, import í™•ì¸")),console.error("ğŸ” í˜„ì¬ URL:",window.location.href),console.error("ğŸ” User Agent:",navigator.userAgent),console.error("ğŸ” í˜„ì¬ ì‹œê°„:",new Date().toISOString()),typeof window<"u"&&console.error("ğŸ” window ê°ì²´ ìƒíƒœ:",{hasReact:!!window.React,hasReactDOM:!!window.ReactDOM,hasPreferenceContext:!!window.__PREFERENCE_CONTEXT_DEBUG__,runtimeConfig:window.__RUNTIME_CONFIG__}),this.setState({error:a,errorInfo:n})}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:e.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"ì•± ì´ˆê¸°í™” ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"ìˆœí™˜ì°¸ì¡°ë‚˜ ì´ˆê¸°í™” ì˜¤ë¥˜ë¡œ ì¸í•´ ì•±ì„ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì•„ë˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”."}),!1,e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:this.handleRetry,className:"w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:["ë‹¤ì‹œ ì‹œë„ (",this.state.retryCount+1,"ë²ˆì§¸)"]}),e.jsx("button",{onClick:this.handleReload,className:"w-full bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700 transition-colors",children:"í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨"})]}),e.jsxs("div",{className:"mt-4 text-xs text-gray-500",children:[e.jsx("p",{children:"ë¬¸ì œê°€ ì§€ì†ë˜ë©´ ë¸Œë¼ìš°ì € ìºì‹œë¥¼ ì •ë¦¬í•´ë³´ì„¸ìš”."}),e.jsx("p",{children:"Chrome: Ctrl+Shift+R (Windows) / Cmd+Shift+R (Mac)"})]})]})})}):this.props.children}}const we=(s,t,a=null)=>{const i=`[App:${new Date().toISOString()}]`;switch(s){case"info":console.log(`${i} ${t}`,a);break;case"error":console.error(`${i} ${t}`,a);break;case"warn":console.warn(`${i} ${t}`,a);break;case"debug":console.debug(`${i} ${t}`,a);break;default:console.log(`${i} ${t}`,a)}},ss={DASHBOARD:"dashboard",STATISTICS:"statistics",PREFERENCE:"preference",RESULTS:"results",LLM_ANALYSIS:"llm-analysis"};function _n(){we("info","App ì»´í¬ë„ŒíŠ¸ ì´ˆê¸°í™”");const[s,t]=r.useState(ss.DASHBOARD),[a,n]=r.useState(!1);if(r.useEffect(()=>{we("debug","App ì´ˆê¸°í™” ì‹œì‘");const o=setTimeout(()=>{var u,d;try{if(we("info","App ì´ˆê¸°í™” ì™„ë£Œ"),typeof window<"u"){const f={hasReact:!!window.React,hasReactDOM:!!window.ReactDOM,hasStrictMode:!!((u=window.React)!=null&&u.StrictMode),hasCreateRoot:!!((d=window.ReactDOM)!=null&&d.createRoot),hasPreferenceContext:!!window.hasPreferenceContext};we("debug","React ìƒíƒœ í™•ì¸",f),(!f.hasReact||!f.hasReactDOM)&&we("warn","React ìƒíƒœê°€ ë¹„ì •ìƒì…ë‹ˆë‹¤",f)}n(!0),we("info","App ì¤€ë¹„ ìƒíƒœ ì„¤ì • ì™„ë£Œ")}catch(f){we("error","App ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ ë°œìƒ",f),n(!0)}},500);return()=>{we("debug","App ì´ˆê¸°í™” íƒ€ì´ë¨¸ ì •ë¦¬"),clearTimeout(o)}},[]),!a)return we("debug","ë¡œë”© í™”ë©´ ë Œë”ë§"),e.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"ì•± ì´ˆê¸°í™” ì¤‘..."})]});const i=()=>{we("debug","ì½˜í…ì¸  ë Œë”ë§",{activeMenu:s});try{switch(s){case ss.DASHBOARD:return we("debug","Dashboard ì»´í¬ë„ŒíŠ¸ ë Œë”ë§"),e.jsx(It,{});case ss.STATISTICS:return we("debug","Statistics ì»´í¬ë„ŒíŠ¸ ë Œë”ë§"),e.jsx(Ft,{});case ss.PREFERENCE:return we("debug","PreferenceManager ì»´í¬ë„ŒíŠ¸ ë Œë”ë§"),e.jsx(qt,{});case ss.RESULTS:return we("debug","ResultsList ì»´í¬ë„ŒíŠ¸ ë Œë”ë§"),e.jsx(Jt,{});case ss.LLM_ANALYSIS:return we("debug","LLMAnalysisManager ì»´í¬ë„ŒíŠ¸ ë Œë”ë§"),e.jsx(Qt,{});default:return we("warn","ì•Œ ìˆ˜ ì—†ëŠ” ë©”ë‰´ ì„ íƒ",{activeMenu:s}),g()}}catch(o){return we("error","ì½˜í…ì¸  ë Œë”ë§ ì¤‘ ì˜¤ë¥˜ ë°œìƒ",{activeMenu:s,error:o}),h(o)}},g=()=>(we("info","ê¸°ë³¸ ì½˜í…ì¸  ë Œë”ë§"),e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"ğŸ‰ KPI Dashboard - ë¦¬íŒ©í† ë§ ì™„ë£Œ!"}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"âœ… ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ ì•ˆì „í•˜ê²Œ ë¦¬íŒ©í† ë§ë˜ì—ˆìŠµë‹ˆë‹¤"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["í˜„ì¬ ì„ íƒëœ ë©”ë‰´: ",e.jsx("strong",{children:s})]}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:e.jsxs("p",{className:"text-green-800",children:[e.jsx("strong",{children:"ì•ˆì •ì„± í…ŒìŠ¤íŠ¸ ì™„ë£Œ!"})," ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ê³  ìˆìŠµë‹ˆë‹¤."]})}),e.jsx("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-md",children:e.jsx("p",{className:"text-blue-800 text-sm",children:"ë¦¬íŒ©í† ë§ì´ ì™„ë£Œë˜ì–´ ì½”ë“œê°€ ë” ì•ˆì „í•˜ê³  ìœ ì§€ë³´ìˆ˜í•˜ê¸° ì‰¬ì›Œì¡ŒìŠµë‹ˆë‹¤! ğŸš€"})}),e.jsx("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:e.jsxs("p",{className:"text-yellow-800 text-sm",children:[e.jsx("strong",{children:"ë¦¬íŒ©í† ë§ ë‚´ìš©:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2",children:[e.jsx("li",{children:"ëª¨ë“  íŒŒì¼ì— ìƒì„¸í•œ ì£¼ì„ê³¼ ë¡œê¹… ì¶”ê°€"}),e.jsx("li",{children:"ì—ëŸ¬ ì²˜ë¦¬ ê°•í™”"}),e.jsx("li",{children:"ì½”ë“œ ëª¨ë“ˆí™” ë° ë¶„ë¦¬"}),e.jsx("li",{children:"íƒ€ì… ì•ˆì „ì„± ê°œì„ "}),e.jsx("li",{children:"ì„±ëŠ¥ ìµœì í™”"})]})]})})]})]})})),h=o=>(we("error","ì˜¤ë¥˜ ì½˜í…ì¸  ë Œë”ë§",{error:o}),e.jsx("div",{className:"min-h-screen bg-red-50",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-red-900 mb-8",children:"âš ï¸ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤"}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-red-800 mb-4",children:"ì½˜í…ì¸  ë Œë”ë§ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["ë©”ë‰´: ",e.jsx("strong",{children:s})]}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:[e.jsx("p",{className:"text-red-800",children:e.jsx("strong",{children:"ì˜¤ë¥˜ ì •ë³´:"})}),e.jsx("pre",{className:"mt-2 text-sm text-red-700 bg-red-100 p-2 rounded",children:(o==null?void 0:o.message)||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"})]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded",children:"í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨"})})]})]})}));return we("debug","App ë©”ì¸ ë Œë”ë§",{activeMenu:s,isReady:a}),e.jsx(Dn,{children:e.jsx(Zr,{children:e.jsx(Ir,{activeMenu:s,setActiveMenu:t,children:i()})})})}const En=({...s})=>{const{theme:t="system"}=la();return e.jsx(ia,{theme:t,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...s})};if(typeof window<"u")try{window.React={StrictMode:r.StrictMode},window.ReactDOM={createRoot:xt.createRoot},window.hasReact=!0,window.hasReactDOM=!0,console.log("ğŸ”§ React ì „ì—­ ë“±ë¡ ì™„ë£Œ")}catch(s){console.error("âŒ React ì „ì—­ ë“±ë¡ ì‹¤íŒ¨:",s)}const Pn=async()=>{try{console.log("ğŸ” Web Vitals ì¸¡ì • ì‹œì‘..."),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",async()=>{await ut()}):await ut(),setTimeout(async()=>{try{const{generatePerformanceReport:s}=await Se(async()=>{const{generatePerformanceReport:t}=await import("./webVitals-CCkPJBQ5.js");return{generatePerformanceReport:t}},__vite__mapDeps([0,1,2,3,4,5]));s()}catch(s){console.warn("âš ï¸ ì„±ëŠ¥ ë¦¬í¬íŠ¸ ìƒì„± ì‹¤íŒ¨:",s)}},5e3)}catch(s){console.warn("âš ï¸ Web Vitals ì´ˆê¸°í™” ì‹¤íŒ¨:",s)}},ut=async()=>{try{const{measureWebVitals:s}=await Se(async()=>{const{measureWebVitals:t}=await import("./webVitals-CCkPJBQ5.js");return{measureWebVitals:t}},__vite__mapDeps([0,1,2,3,4,5]));await s()}catch(s){console.warn("âš ï¸ Web Vitals ì¸¡ì • ì‹¤íŒ¨:",s)}};typeof window<"u"&&setTimeout(Pn,100);const ht=()=>{try{console.log("ğŸ”„ React ì•± ë Œë”ë§ ì‹œì‘");const s=document.getElementById("root");if(!s){console.error("âŒ root ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤");return}console.log("âœ… root ì—˜ë¦¬ë¨¼íŠ¸ ë°œê²¬:",s);const t=xt.createRoot(s);console.log("âœ… React Root ìƒì„± ì™„ë£Œ"),t.render(e.jsxs(e.Fragment,{children:[e.jsx(_n,{}),e.jsx(En,{position:"top-right",richColors:!0})]})),console.log("âœ… React ì•± ë Œë”ë§ ì™„ë£Œ")}catch(s){console.error("âŒ React ì•± ë Œë”ë§ ì‹¤íŒ¨:",s);const t=document.getElementById("root");t&&(t.innerHTML=`
        <div style="display: flex; justify-content: center; align-items: center; height: 100vh; font-family: Arial, sans-serif;">
          <div style="text-align: center; padding: 20px;">
            <h2>ì•± ì´ˆê¸°í™” ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤</h2>
            <p>í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.</p>
            <button onclick="window.location.reload()" style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
              ìƒˆë¡œê³ ì¹¨
            </button>
          </div>
        </div>
      `)}},ea=()=>{try{console.log("âœ… ì•± ì´ˆê¸°í™” ì‹œì‘"),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{setTimeout(ht,100)}):setTimeout(ht,100)}catch(s){console.error("âŒ startApp ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜:",s),setTimeout(ea,500)}};ea();export{Se as _};
