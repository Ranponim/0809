import{r as n,M as e}from"./vendor-D_Wz334c.js";import{C as i,d as o,e as p,b as j,c as u,a as f}from"./index-BAtDSpDQ.js";import{a as b,F as v}from"./icon-vendor-DhUEaqm7.js";import"./utils-vendor-DrCDvq1f.js";import"./ui-vendor-D1gbbhYx.js";const _=()=>{const[g,m]=n.useState([]),[l,d]=n.useState(null),[N,x]=n.useState(!0);n.useEffect(()=>{(async()=>{var s,r;try{x(!0);try{const t=(await f.get("/api/analysis-result/latest")).data,h={id:t.id,title:`LLM 종합 분석 리포트 #${t.id}`,content:((s=t.analysis)==null?void 0:s.executive_summary)||((r=t.analysis)==null?void 0:r.overall_summary)||"요약 없음",generated_at:t.created_at,_raw:t};m([h]),d(h)}catch{const t=await f.get("/api/reports/summary");m(t.data.reports||[]),t.data.reports&&t.data.reports.length>0&&d(t.data.reports[0])}}catch(c){console.error("Error fetching reports:",c)}finally{x(!1)}})()},[]);const y=a=>a.split(`
`).map((s,r)=>s.startsWith("# ")?e.jsx("h1",{className:"text-2xl font-bold mb-4 mt-6",children:s.substring(2)},r):s.startsWith("## ")?e.jsx("h2",{className:"text-xl font-semibold mb-3 mt-5",children:s.substring(3)},r):s.startsWith("### ")?e.jsx("h3",{className:"text-lg font-medium mb-2 mt-4",children:s.substring(4)},r):s.startsWith("- ")?e.jsx("li",{className:"ml-4 mb-1",children:s.substring(2)},r):s.trim()===""?e.jsx("br",{},r):e.jsx("p",{className:"mb-2",children:s},r));return N?e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-3xl font-bold",children:"Summary Report"}),e.jsx(i,{children:e.jsx(o,{className:"p-6",children:e.jsx("div",{className:"text-center text-gray-500",children:"Loading reports..."})})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-3xl font-bold",children:"Summary Report"}),l&&e.jsxs(p,{variant:"outline",className:"flex items-center gap-2",onClick:()=>{try{const a=(l.title||"report").replace(/\s+/g,"_"),s=String(l.content||""),r=new Blob([s],{type:"text/markdown;charset=utf-8"}),c=URL.createObjectURL(r),t=document.createElement("a");t.href=c,t.download=`${a}.md`,document.body.appendChild(t),t.click(),t.remove(),URL.revokeObjectURL(c)}catch(a){console.error("Export failed",a)}},children:[e.jsx(b,{className:"h-4 w-4"}),"Export Report"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(i,{children:[e.jsx(j,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(v,{className:"h-5 w-5"}),"Available Reports"]})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-2",children:g.map(a=>e.jsx(p,{variant:(l==null?void 0:l.id)===a.id?"default":"ghost",className:"w-full justify-start text-left",onClick:()=>d(a),children:e.jsxs("div",{className:"truncate",children:[e.jsx("div",{className:"font-medium",children:a.title}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(a.generated_at).toLocaleDateString()})]})},a.id))})})]})}),e.jsx("div",{className:"lg:col-span-3",children:l?e.jsxs(i,{children:[e.jsxs(j,{children:[e.jsx(u,{children:l.title}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Generated on ",new Date(l.generated_at).toLocaleString()]})]}),e.jsx(o,{children:e.jsx("div",{className:"prose max-w-none",children:y(l.content)})})]}):e.jsx(i,{children:e.jsx(o,{className:"p-6",children:e.jsx("div",{className:"text-center text-gray-500",children:"Select a report to view its content"})})})})]})]})};export{_ as default};
